<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<Form Key="PM_MaintenanceOrder" Caption="维护订单" FormType="Entity" InitState="New" Version="564">
    <DataSource>
        <DataObject Key="PM_MaintenanceOrder" Caption="维护订单" PrimaryTableKey="EPM_MaintenanceOrderHead" PrimaryType="Entity" CheckAfterLoad="true" LoadRightsType="Deny" Version="1">
            <TableCollection>
                <Table Key="EPM_MaintenanceOrderHead" Caption="维护订单单据字典主表" IndexPrefix="EPM_MaintenanceOrderHead">
                    <Column Key="OID" Caption="对象标识" DataElementKey="OID"/>
                    <Column Key="SOID" Caption="主对象标识" DataElementKey="SOID"/>
                    <Column Key="POID" Caption="父对象标识" DataElementKey="POID"/>
                    <Column Key="VERID" Caption="对象版本" DataElementKey="VERID"/>
                    <Column Key="DVERID" Caption="对象明细版本" DataElementKey="DVERID"/>
                    <Column Key="Creator" Caption="制单人" DataElementKey="Creator"/>
                    <Column Key="CreateTime" Caption="制单时间" DataElementKey="CreateTime"/>
                    <Column Key="Modifier" Caption="修改人" DataElementKey="Modifier"/>
                    <Column Key="ModifyTime" Caption="修改时间" DataElementKey="ModifyTime"/>
                    <Column Key="ClientID" Caption="集团" DataElementKey="ClientID"/>
                    <Column Key="Status" Caption="状态" DefaultValue="-1" DataElementKey="Status"/>
                    <Column Key="SequenceValue" Caption="流水号" DataElementKey="SequenceValue"/>
                    <Column Key="ResetPattern" Caption="流水号模式" DataElementKey="ResetPattern"/>
                    <Column Key="DocumentNumber" Caption="单据编号" DefaultValue="" DataElementKey="DocumentNumber" PrimaryKey="true"/>
                    <Column Key="InstanceID" Caption="流程标识" DataElementKey="InstanceID"/>
                    <Column Key="SystemVestKey" Caption="单据Key" DataElementKey="SystemVestKey"/>
                    <Column Key="DocumentDate" Caption="单据日期" DataElementKey="DocumentDate"/>
                    <Column Key="OrderTypeID" Caption="订单类型" CodeColumnKey="OrderTypeCode" DataElementKey="PM_OrderTypeID"/>
                    <Column Key="OrderText" Caption="订单描述" DefaultValue="" DataElementKey="OrderText_2000"/>
                    <Column Key="SystemStatusText" Caption="系统状态" DefaultValue="" DataElementKey="SystemStatusText"/>
                    <Column Key="UserStatusText" Caption="用户状态" DefaultValue="" DataElementKey="UserStatusText"/>
                    <Column Key="SystemStatusTECODate" Caption="技术性完成日期" DataElementKey="SystemStatusTECODate"/>
                    <Column Key="FunctionalLocationSOID" Caption="功能位置" CodeColumnKey="FunctionalLocationDocNo" DataElementKey="FunctionalLocationSOID"/>
                    <Column Key="FunctionalLocationDocNo" Caption="功能位置" DataElementKey="Code_100"/>
                    <Column Key="EquipmentSOID" Caption="设备" CodeColumnKey="EquipmentDocNo" DataElementKey="EquipmentSOID"/>
                    <Column Key="EquipmentDocNo" Caption="设备" DataElementKey="EquipmentDocNo"/>
                    <Column Key="UII" Caption="唯一项目标识" DefaultValue="" Description="用于标识单一项目的全球性唯一标识，目前暂未有项目使用过，短期内无需考虑该字段；英文全称：Unique Item Identification" DataElementKey="UII"/>
                    <Column Key="PlanningPlantID" Caption="计划工厂" CodeColumnKey="PlanningPlantCode" Description="计划工厂即负责维护任务的工厂，一般由功能位置/设备中的计划工厂带入，或由创建界面的计划工厂带入。注：维护计划工厂==计划工厂，为了避免与维护工厂产生混乱，统称为计划工厂" DataElementKey="PlanningPlantID"/>
                    <Column Key="PlannerGroupID" Caption="计划员组" CodeColumnKey="PlannerGroupCode" DataElementKey="PMPlannerGroupID"/>
                    <Column Key="MainWorkCenterID" Caption="主工作中心" CodeColumnKey="MainWorkCenterCode" Description="负责维护任务的工作中心" DataElementKey="MainWorkCenterID"/>
                    <Column Key="MainWorkCenterPlantID" Caption="主工作中心工厂" CodeColumnKey="MainWorkCenterPlantCode" Description="负责维护工作的工厂，一般由主工作中心直接带出" DataElementKey="MainWorkCenterPlantID"/>
                    <Column Key="ResponsibleOperatorID" Caption="负责人" CodeColumnKey="ResponsibleOperatorCode" Description="维护订单的负责人" DataElementKey="ResponsibleOperatorID"/>
                    <Column Key="BasicStartDate" Caption="基本开始日期" DataElementKey="BasicStartDate"/>
                    <Column Key="BasicEndDate" Caption="基本完成日期" DataElementKey="BasicEndDate"/>
                    <Column Key="MaintenanceActivityTypeID" Caption="PM作业类型" CodeColumnKey="MaintenanceActivityTypeCode" Description="标识维护订单的作业类型，作业常分为：维修、停工、定期活动和检查。与常规认知的工序中的作业类型不是相同意义。" DataElementKey="MaintenanceActivityTypeID"/>
                    <Column Key="OrgControllingAreaID" Caption="组织控制范围" CodeColumnKey="OrgControllingAreaCode" Description="计划工厂对应的公司代码的控制范围，一般FICO使用都是取这个" DataElementKey="ControllingAreaID"/>
                    <Column Key="OrgCompanyCodeID" Caption="公司代码" CodeColumnKey="OrgCompanyCodeCode" DataElementKey="CompanyCodeID"/>
                    <Column Key="OrgBusinessAreaID" Caption="业务范围" CodeColumnKey="OrgBusinessAreaCode" DataElementKey="BusinessAreaID"/>
                    <Column Key="OrgWBSElementID" Caption="WBS元素" CodeColumnKey="OrgWBSElementCode" Description="用于对维护订单进行预算控制的WBS元素" DataElementKey="Ord_WBSElementID"/>
                    <Column Key="OrgSaleOrderDtlOID" Caption="销售订单-行号" CodeColumnKey="OrgSaleOrderDtlCode" DataElementKey="Org_SaleOrderDtlOID"/>
                    <Column Key="OrgSaleOrderDtlCode" Caption="销售订单-行号" DataElementKey="Code_50"/>
                    <Column Key="ResponsibleCostCenterID" Caption="负责的成本中心" CodeColumnKey="ResponsibleCostCenterCode" DataElementKey="ResponsibleCostCenterID"/>
                    <Column Key="ProfitCenterID" Caption="利润中心" CodeColumnKey="ProfitCenterCode" DataElementKey="ProfitCenterID"/>
                    <Column Key="FunctionalAreaID" Caption="功能范围" CodeColumnKey="FunctionalAreaCode" DataElementKey="FunctionalAreaID"/>
                    <Column Key="MaintPlantID" Caption="维护工厂" CodeColumnKey="MaintPlantCode" DataElementKey="MaintPlantID"/>
                    <Column Key="LocationID" Caption="位置" CodeColumnKey="LocationCode" DataElementKey="LocationID"/>
                    <Column Key="Room" Caption="房间" DefaultValue="" DataElementKey="Room"/>
                    <Column Key="PlantSectionID" Caption="工厂区域" CodeColumnKey="PlantSectionCode" DataElementKey="PlantSectionID"/>
                    <Column Key="WorkCenterID" Caption="工作中心" CodeColumnKey="WorkCenterCode" DataElementKey="TecoObjectWorkCenterID"/>
                    <Column Key="ABCIndicatorID" Caption="ABC标识" CodeColumnKey="ABCIndicatorCode" DataElementKey="ABCIndicatorID"/>
                    <Column Key="ControllingAreaID" Caption="控制范围" CodeColumnKey="ControllingAreaCode" Description="维护工厂对应的公司代码的控制范围，和成本中心相绑定，这个控制范围允许为空，有值时只能等于OrgControllingAreaID，一般仅用于成本中心的过滤" DataElementKey="ControllingAreaID"/>
                    <Column Key="CompanyCodeID" Caption="公司代码" CodeColumnKey="CompanyCodeCode" DataElementKey="CompanyCodeID"/>
                    <Column Key="BusinessAreaID" Caption="业务范围" CodeColumnKey="BusinessAreaCode" DataElementKey="BusinessAreaID"/>
                    <Column Key="WBSElementID" Caption="WBS元素" CodeColumnKey="WBSElementCode" Description="用于关联结算规则使用的WBS元素" DataElementKey="WBSElementID"/>
                    <Column Key="AssetCardSOID" Caption="资产" CodeColumnKey="AssetCardDocNo" DataElementKey="AssetCardSOID"/>
                    <Column Key="CostCenterID" Caption="成本中心" CodeColumnKey="CostCenterCode" DataElementKey="CostCenterID"/>
                    <Column Key="FirstOperation" Caption="工序" DefaultValue="" DataElementKey="FirstOperation"/>
                    <Column Key="FirstWorkCenterID" Caption="工作中心" CodeColumnKey="FirstWorkCenterCode" DataElementKey="FirstWorkCenterID"/>
                    <Column Key="FirstWorkCenterPlantID" Caption="工作中心工厂" CodeColumnKey="FirstWorkCenterPlantCode" DataElementKey="FirstWorkCenterPlantID"/>
                    <Column Key="FirstCalculationKey" Caption="计算规则" DataElementKey="FirstCalculationKey"/>
                    <Column Key="FirstActivityTypeID" Caption="作业类型" CodeColumnKey="FirstActivityTypeCode" DataElementKey="FirstActivityTypeID"/>
                    <Column Key="FirstControlCodeID" Caption="控制码" CodeColumnKey="FirstControlCodeCode" DataElementKey="FirstControlCodeID"/>
                    <Column Key="IsFirstComponent" Caption="组件" DataElementKey="IsFirstComponent"/>
                    <Column Key="FirstProcessWorkTime" Caption="工作量" DataElementKey="FirstProcessWorkTime" RefCol="FirstProcessWorkTimeUnitID"/>
                    <Column Key="FirstProcessWorkTimeUnitID" Caption="单位" CodeColumnKey="FirstProcessWorkTimeUnitCode" DataElementKey="FirstProcessWorkTimeUnitID"/>
                    <Column Key="EnteredByOperatorID" Caption="输入者" CodeColumnKey="EnteredByOperatorCode" DataElementKey="EnteredByOperatorID"/>
                    <Column Key="CreatedOnDate" Caption="创建日期" DataElementKey="CreatedOnDate"/>
                    <Column Key="ChangedByOperatorID" Caption="修改者" CodeColumnKey="ChangedByOperatorCode" DataElementKey="ChangedByOperatorID"/>
                    <Column Key="ChangedOnDate" Caption="修改日期" DataElementKey="ChangedOnDate"/>
                    <Column Key="IsPlannedOrder" Caption="计划订单" DataElementKey="IsPlannedOrder"/>
                    <Column Key="IsImmediateOrder" Caption="即时订单" DataElementKey="IsImmediateOrder"/>
                    <Column Key="IsUnplannedOrder" Caption="未计划订单" DataElementKey="IsUnplannedOrder"/>
                    <Column Key="CostingSheetID" Caption="成本核算表" CodeColumnKey="CostingSheetCode" DataElementKey="CostingSheetID"/>
                    <Column Key="PlanCostingVariantID" Caption="计划成本变式" CodeColumnKey="PlanCostingVariantCode" DataElementKey="PlanCostingVariantID"/>
                    <Column Key="ActualCostingVariantID" Caption="实际成本变式" CodeColumnKey="ActualCostingVariantCode" DataElementKey="ActualCostingVariantID"/>
                    <Column Key="RequisitionCreationControl" Caption="预留/采购申请创建控制" Description="控制预留/采购申请单创建的时机，比如下达后创建" DataElementKey="RequisitionCreationControl"/>
                    <Column Key="PriorityID" Caption="优先级" CodeColumnKey="PriorityCode" DataElementKey="PriorityID"/>
                    <Column Key="ReservationSOID" Caption="预留" CodeColumnKey="ReservationDocNo" DataElementKey="ReservationSOID"/>
                    <Column Key="NotificationSOID" Caption="通知" CodeColumnKey="NotificationDocNo" DataElementKey="NotificationSOID"/>
                    <Column Key="ReservationDocNo" Caption="预留代号" DefaultValue="" DataElementKey="DocumentNumber"/>
                    <Column Key="NotificationDocNo" Caption="通知单" DefaultValue="" DataElementKey="Code_100"/>
                    <Column Key="MaterialID" Caption="物料" CodeColumnKey="MaterialCode" Description="用于刷新（翻新）订单，例如修复损坏的物料" DataElementKey="MaterialID"/>
                    <Column Key="TotalQuantity" Caption="翻新总数量" Description="在订单中将生产的总计数量（包括废品）" DataElementKey="TotalQuantity" RefCol="UnitID"/>
                    <Column Key="UnitID" Caption="翻新单位" CodeColumnKey="UnitCode" DataElementKey="UnitID"/>
                    <Column Key="ReceiptQuantity" Caption="已交货" Description="交付到库存的数量" DataElementKey="ReceiptQuantity" RefCol="UnitID"/>
                    <Column Key="BaseUnitID" Caption="翻新基本单位" CodeColumnKey="BaseUnitCode" DataElementKey="BaseUnitID"/>
                    <Column Key="BaseUnitDenominator" Caption="翻新基本单位-分母" DataElementKey="BaseUnitDenominator"/>
                    <Column Key="BaseUnitNumerator" Caption="翻新基本单位-分子" DataElementKey="BaseUnitNumerator"/>
                    <Column Key="FromPlantID" Caption="从      工厂" CodeColumnKey="FromPlantCode" DataElementKey="PlantID"/>
                    <Column Key="ToPlantID" Caption="至      工厂" CodeColumnKey="ToPlantCode" DataElementKey="OrderPlanningPlantID"/>
                    <Column Key="FromStorageLocationID" Caption="库存地点" CodeColumnKey="FromStorageLocationCode" DataElementKey="StorageLocationID"/>
                    <Column Key="ToStorageLocationID" Caption="库存地点" CodeColumnKey="ToStorageLocationCode" DataElementKey="StorageLocationID"/>
                    <Column Key="IsRefurbishment" Caption="刷新订单" DataElementKey="IsRefurbishment"/>
                    <Column Key="IsCompleteReceipt" Caption="已全部交货" DataElementKey="IsDeliveryCompleted"/>
                    <Column Key="IsWithoutLimit" Caption="未限制过量交货" DataElementKey="IsWithoutLimit"/>
                    <Column Key="RoutingID" Caption="工艺路线ID" CodeColumnKey="RoutingCode" DataElementKey="RoutingID"/>
                    <Column Key="RoutingCode" Caption="工艺路线ID" DataElementKey="Code"/>
                    <Column Key="MaintenancePlanSOID" Caption="维护计划" CodeColumnKey="MaintenancePlanCode" DataElementKey="MaintenancePlanSOID"/>
                    <Column Key="MaintenanceItemSOID" Caption="维护项目" CodeColumnKey="MaintenanceItemDocNo" DataElementKey="MaintenanceItemSOID"/>
                    <Column Key="MaintenancePlanCallNo" Caption="维护计划调用号" DataElementKey="MaintenancePlanCallNo"/>
                    <Column Key="CompletionDate" Caption="完成日期" DataElementKey="CompletionDate"/>
                    <Column Key="CompletionTime" Caption="完成时间" DataElementKey="CompletionTime"/>
                    <Column Key="MaintenanceOrderSOID" Caption="上一订单" CodeColumnKey="MaintenanceOrderDocNo" DataElementKey="PrevMaintenanceOrderSOID"/>
                    <Column Key="InspectionLotSOID" Caption="检验批" CodeColumnKey="InspectionLotDocNo" DataElementKey="InspectionLotSOID"/>
                    <Column Key="TCodeID" CodeColumnKey="TCodeCode" DataElementKey="TCodeID"/>
                    <Column Key="ATPStatus" DataElementKey="ATPStatus"/>
                    <Column Key="SpecialIdentity" Caption="特殊库存" DefaultValue="" DataElementKey="SpecialIdentity"/>
                    <Column Key="AccountAssignmentCategoryID" Caption="科目分配类别" CodeColumnKey="AccountAssignmentCategoryCode" DataElementKey="AccountAssignmentCategoryID"/>
                    <Column Key="SerialNumber" Caption="序列号" DefaultValue="" DataElementKey="SerialNumber"/>
                    <Column Key="SaleOrderDtlOID" Caption="销售订单-行号" CodeColumnKey="SaleOrderItemCode" DataElementKey="SaleOrderDtlOID"/>
                    <Column Key="NotificationTypeID" Caption="通知类型" CodeColumnKey="NotificationTypeCode" DataElementKey="NotificationTypeID"/>
                    <Column Key="PriorityTypeID" Caption="优先级类型" CodeColumnKey="PriorityTypeCode" DataElementKey="PriorityTypeID"/>
                    <Column Key="DivisionID" Caption="产品部门" CodeColumnKey="DivisionCode" DataElementKey="DivisionID"/>
                    <Column Key="UnitCode" Caption="单位代号" DefaultValue="" DataElementKey="Code_6"/>
                    <Column Key="FromPlantCode" Caption="从      工厂代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="ToPlantCode" Caption="至      工厂代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="FromStorageLocationCode" Caption="库存地点代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="ToStorageLocationCode" Caption="库存地点代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="BaseUnitCode" Caption="物料基本单位代号" DefaultValue="" DataElementKey="Code_6"/>
                    <Column Key="InspectionLotDocNo" Caption="检验批代号" DefaultValue="" DataElementKey="DocumentNumber"/>
                    <Column Key="TCodeCode" Caption="TCodeID代号" DefaultValue="" DataElementKey="Code_50"/>
                    <Column Key="NotificationTypeCode" Caption="通知类型代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="PriorityTypeCode" Caption="优先级类型代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="EnteredByOperatorCode" Caption="输入者代号" DefaultValue="" DataElementKey="Code_50"/>
                    <Column Key="ChangedByOperatorCode" Caption="修改者代号" DefaultValue="" DataElementKey="Code_50"/>
                    <Column Key="CostingSheetCode" Caption="成本核算表代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="PlanCostingVariantCode" Caption="计划成本变式代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="ActualCostingVariantCode" Caption="实际成本变式代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="MaintenancePlanCode" Caption="维护计划代号" DefaultValue="" DataElementKey="Code_100"/>
                    <Column Key="MaintenanceItemDocNo" Caption="维护项目代号" DefaultValue="" DataElementKey="Code_100"/>
                    <Column Key="MaintenanceOrderDocNo" Caption="上一订单代号" DefaultValue="" DataElementKey="Code_100"/>
                    <Column Key="ControllingAreaCode" Caption="控制范围代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="ProfitCenterCode" Caption="利润中心代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="FunctionalAreaCode" Caption="功能范围代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="ResponsibleCostCenterCode" Caption="负责的成本中心代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="OrgCompanyCodeCode" Caption="公司代码代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="OrgWBSElementCode" Caption="WBS元素代号" DefaultValue="" DataElementKey="Code_50"/>
                    <Column Key="OrgBusinessAreaCode" Caption="业务范围代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="BusinessAreaCode" Caption="业务范围代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="WBSElementCode" Caption="WBS元素代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="MaintPlantCode" Caption="维护工厂代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="LocationCode" Caption="位置代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="PlantSectionCode" Caption="工厂区域代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="WorkCenterCode" Caption="工作中心代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="ABCIndicatorCode" Caption="ABC标识代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="AssetCardDocNo" Caption="资产代号" DefaultValue="" DataElementKey="DocumentNumber"/>
                    <Column Key="CostCenterCode" Caption="成本中心代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="CompanyCodeCode" Caption="公司代码代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="PlannerGroupCode" Caption="计划员组代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="MainWorkCenterPlantCode" Caption="主工作中心工厂代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="PlanningPlantCode" Caption="计划员组工厂代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="MainWorkCenterCode" Caption="主工作中心代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="ResponsibleOperatorCode" Caption="负责人代号" DefaultValue="" DataElementKey="Code_50"/>
                    <Column Key="MaintenanceActivityTypeCode" Caption="PM作业类型代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="FirstWorkCenterCode" Caption="工作中心代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="FirstWorkCenterPlantCode" Caption="工作中心工厂代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="FirstActivityTypeCode" Caption="作业类型代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="FirstControlCodeCode" Caption="控制码代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="FirstProcessWorkTimeUnitCode" Caption="单位代号" DefaultValue="" DataElementKey="Code_6"/>
                    <Column Key="MaterialCode" Caption="物料代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="DivisionCode" Caption="产品部门代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="OrderTypeCode" Caption="订单类型代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="IsReleased" Caption="已下达" DataElementKey="PM_IsReleased"/>
                    <Column Key="BasicStartTime" Caption="基本开始时间" DataElementKey="BasicStartTime"/>
                    <Column Key="BasicEndTime" Caption="基本完成时间" DataElementKey="BasicEndTime"/>
                    <Column Key="SequenceIncrement" Caption="工序增量" DefaultValue="" Description="对于工序中的增量值，没有配置的情况下，默认为0010，否则取配置“定义更改凭证、批量采购申请、物料需求计划相关性”中的增量配置值" DataElementKey="SequenceIncrement"/>
                    <Column Key="IsCollectionRequest" Caption="汇总采购申请" Description="对于工序中生成采购申请的控制，没有配置的情况下，默认为汇总，否则取配置“定义更改凭证、批量采购申请、物料需求计划相关性”中的汇总请求配置值" DataElementKey="IsCollectionRequest"/>
                    <Column Key="InspectionTypeCode" Caption="检验类型" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="InspectionTypeID" Caption="检验类型" CodeColumnKey="InspectionTypeCode" DataElementKey="InspectionTypeID"/>
                    <Column Key="OperatingConditionCode" Caption="系统条件" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="OperatingConditionID" Caption="系统条件" CodeColumnKey="OperatingConditionCode" DataElementKey="OperatingConditionID"/>
                    <Column Key="RevisionCode" Caption="修正" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="RevisionID" Caption="修正" CodeColumnKey="RevisionCode" DataElementKey="RevisionID"/>
                    <Column Key="SortField" Caption="分类字段" Description="单纯给公司内部使用的分类文本，不影响系统" DataElementKey="SortField"/>
                    <Column Key="LastTaskListType" Caption="任务清单类型" DataElementKey="RoutingListType"/>
                    <Column Key="LastRoutingGroup" Caption="任务清单组" DataElementKey="TaskListGroup"/>
                    <Column Key="LastGroupCounter" Caption="组计数器" DataElementKey="GroupCounter"/>
                    <Column Key="LastRoutingCode" Caption="任务清单" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="LastRoutingID" Caption="任务清单" CodeColumnKey="LastRoutingCode" DataElementKey="LastRoutingID"/>
                    <Column Key="Notes" Caption="备注" DataElementKey="Notes_2000"/>
                    <Column Key="ReleasedDate" Caption="下达日期" DataElementKey="ReleasedDate"/>
                    <Column Key="TotalEstimatedCost" Caption="估算成本" DataElementKey="OrderTotalEstimatedCost"/>
                    <Column Key="ReferenceDate" Caption="参考日期" DataElementKey="PMReferenceDate"/>
                    <Column Key="ReferenceTime" Caption="参考时间" DataElementKey="ReferenceTime"/>
                    <Column Key="MaintProcessingPhase" Caption="维修处理阶段" DataElementKey="MaintProcessingPhase"/>
                    <Column Key="SrcSOID" Caption="源单SOID" DataElementKey="SrcSOID"/>
                    <Column Key="SrcOID" Caption="源单OID" DataElementKey="SrcOID"/>
                    <Column Key="SrcFormKey" DataElementKey="SrcFormKey"/>
                    <Column Key="MapKey" DataElementKey="MapKey"/>
                    <Column Key="SchedulingTypeCode" Caption="计划类型" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="SchedulingTypeID" Caption="计划类型" CodeColumnKey="SchedulingTypeCode" DataElementKey="SchedulingTypeID"/>
                    <Column Key="IsAutoSchedule" Caption="自动计划" DataElementKey="IsAutoSchedule"/>
                    <Column Key="StartInPastDay" Caption="过去开始天数" DataElementKey="StartInPastDay"/>
                    <Column Key="ScheduleStartDate" Caption="排产/计划开始日期" DataElementKey="ScheduleStartDate"/>
                    <Column Key="ScheduleStartTime" Caption="排产/计划开始时间" DataElementKey="ScheduleStartTime"/>
                    <Column Key="ActualStartDate" Caption="实际开始日期" DataElementKey="ActualStartDate"/>
                    <Column Key="ActualStartTime" Caption="实际开始时间" DataElementKey="PMActualStartTime"/>
                    <Column Key="ScheduleEndDate" Caption="排产/计划结束日期" DataElementKey="ScheduleEndDate"/>
                    <Column Key="ScheduleEndTime" Caption="排产/计划结束时间" DataElementKey="ScheduleEndTime"/>
                    <Column Key="ActualEndDate" Caption="实际结束日期" DataElementKey="ActualEndDate"/>
                    <Column Key="ActualEndTime" Caption="实际结束时间" DataElementKey="ActualEndTime"/>
                    <Column Key="IsClassesOrder" Caption="班次订单" DataElementKey="IsClassesOrder"/>
                    <Column Key="IsRelationshipData" Caption="关系数据" DataElementKey="IsRelationshipData"/>
                    <Column Key="IsExactInterrupt" Caption="精确的中断" DataElementKey="IsExactInterrupt"/>
                    <Column Key="IsCapacityRequire" Caption="能力需求" DataElementKey="IsCapacityRequire"/>
                    <Column Key="FirstProcessDurationUnitID" Caption="单位" CodeColumnKey="FirstProcessDurationUnitCode" DataElementKey="FirstProcessDurationUnitID"/>
                    <Column Key="FirstProcessDuration" Caption="工序持续时间" DataElementKey="FirstProcessDuration" RefCol="FirstProcessDurationUnitID"/>
                    <Column Key="AdjustDate" Caption="调整日期" DataElementKey="AdjustDate"/>
                    <Column Key="EstimInputControl" Caption="估算输入控制" DataElementKey="EstimInputControl"/>
                    <Column Key="OrgControllingAreaCode" Caption="组织控制范围" DataElementKey="Code"/>
                    <Column Key="PriorityCode" Caption="优先级" DataElementKey="Code"/>
                    <Column Key="AccountAssignmentCategoryCode" Caption="科目分配类别" DataElementKey="Code"/>
                    <Column Key="SaleOrderItemCode" Caption="销售订单-行号" DataElementKey="Code_50"/>
                    <Column Key="FirstProcessDurationUnitCode" Caption="单位" DataElementKey="Code"/>
                    <Column Key="CurrencyID" Caption="币种" CodeColumnKey="CurrencyCode" DataElementKey="OrderCurrencyID"/>
                    <Column Key="CurrencyCode" Caption="币种" DataElementKey="Code"/>
                    <Column Key="IsActiveBudget" Caption="激活预算" Cache="true" DataElementKey="IsActiveBudget"/>
                    <Column Key="ParentOrderSOID" Caption="上级订单SOID" CodeColumnKey="ParentOrderDocNo" DataElementKey="ParentOrderSOID"/>
                    <Column Key="ParentOrderDocNo" Caption="上级订DocumentNumber" DataElementKey="Code_100"/>
                    <Column Key="LeadingOrderSOID" Caption="主订单SOID" CodeColumnKey="LeadingOrderDocNo" DataElementKey="LeadingOrderSOID"/>
                    <Column Key="LeadingOrderDocNo" Caption="主订单DocumentNumber" DataElementKey="Code_100"/>
                    <Column Key="ExternalSystemID" Caption="外部系统标识" DataElementKey="ExternalSystemID"/>
                    <Column Key="ExternalSystemPrimaryKey" Caption="外部系统关键字" DataElementKey="ExternalSystemPrimaryKey"/>
                    <Column Key="CustomerCode" Caption="客户" DataElementKey="Code"/>
                    <Column Key="CustomerID" Caption="客户" CodeColumnKey="CustomerCode" DataElementKey="CustomerID"/>
                    <Column Key="ATPMsg" Persist="false" DataElementKey="TextEditor_255" IgnoreQuery="true"/>
                    <Column Key="TreeID" Persist="false" DataElementKey="TreeID_Varchar_100" IgnoreQuery="true"/>
                    <Column Key="IsMissingPartsOnly" Caption="仅遗失部分" Persist="false" DataElementKey="IsMissingPartsOnly" IgnoreQuery="true"/>
                    <Column Key="IsStatusInit" Caption="状态已初始化" Persist="false" DataElementKey="IsStatusInit" IgnoreQuery="true"/>
                    <Column Key="LastTaskListDescription" Caption="任务清单描述" Persist="false" DataElementKey="LastTaskListDescription" IgnoreQuery="true"/>
                    <Column Key="IsAllComponents" Caption="全部组件" Persist="false" DataElementKey="IsAllComponents" IgnoreQuery="true"/>
                </Table>
                <Table Key="EPM_MaintOrder_NotificationData" Caption="维护订单通知单数据" SourceType="Custom" Persist="false" Formula="Macro_FillNotificationData()">
                    <Column Key="OID" Caption="对象标识" DataElementKey="OID"/>
                    <Column Key="SOID" Caption="主对象标识" DataElementKey="SOID"/>
                    <Column Key="POID" Caption="父对象标识" DataElementKey="POID"/>
                    <Column Key="VERID" Caption="对象版本" DataElementKey="VERID"/>
                    <Column Key="DVERID" Caption="对象明细版本" DataElementKey="DVERID"/>
                    <Column Key="MalfunctionStartDate" Caption="故障开始" DataElementKey="MalfunctionStartDate"/>
                    <Column Key="MalfunctionStartTime" Caption="故障开始时间" DataElementKey="MalfunctionStartTime"/>
                    <Column Key="MalfunctionEndDate" Caption="故障结束" DataElementKey="MalfunctionEndDate"/>
                    <Column Key="MalfunctionEndTime" Caption="故障开始时间" DataElementKey="MalfunctionEndTime"/>
                    <Column Key="BreakdownDuration" Caption="停机持续时长" DataElementKey="BreakdownDuration" RefCol="BreakdownDurationUnitID"/>
                    <Column Key="BreakdownDurationUnitID" Caption="停机持续时长单位" DataElementKey="BreakdownDurationUnitID"/>
                    <Column Key="CodeGroupProblem" Caption="故障" DefaultValue="" DataElementKey="CodeGroupProblem"/>
                    <Column Key="CodeProblem" Caption="缺陷类型" DefaultValue="" DataElementKey="CodeProblem"/>
                    <Column Key="CodeProblem_Text" Caption="故障短文本" DefaultValue="" DataElementKey="ShortText"/>
                    <Column Key="CauseCodeNotes" Caption="原因代码文本" DefaultValue="" DataElementKey="CauseCodeNotes"/>
                    <Column Key="ICCodeGroupCauses" Caption="原因" DefaultValue="" DataElementKey="ICCodeGroupCauses"/>
                    <Column Key="ICCodeCauses" Caption="原因代码" DefaultValue="" DataElementKey="ICCodeCauses"/>
                    <Column Key="ICCodeCauses_Text" Caption="原因短文本" DefaultValue="" DataElementKey="ShortText"/>
                    <Column Key="ICCauseText" Caption="原因正文" DefaultValue="" DataElementKey="ICCauseText"/>
                    <Column Key="RequireStartDate" Caption="请求启动" DataElementKey="RequireStartDate"/>
                    <Column Key="RequireStartTime" Caption="要求的起始时间" DataElementKey="RequireStartTime"/>
                    <Column Key="ReporterOperatorID" Caption="报告者" DataElementKey="ReporterOperatorID_EditValue"/>
                    <Column Key="RequireEndDate" Caption="要求结束" DataElementKey="RequireEndDate"/>
                    <Column Key="RequireEndTime" Caption="要求的结束时间" DataElementKey="RequireEndTime"/>
                    <Column Key="NotificationDate" Caption="通知日期" DataElementKey="NotificationDate"/>
                    <Column Key="NotificationTime" Caption="通知时间" DataElementKey="NotificationTime"/>
                    <Column Key="IsBreakDown" Caption="停机" DataElementKey="IsBreakDown"/>
                    <Column Key="CatalogProfileID" Caption="类别参数文件" DataElementKey="CatalogProfileID"/>
                </Table>
                <Table Key="EPM_MaintOrder_Routing" Caption="维护订单到工单确认主表" TableMode="Detail" IndexPrefix="EPM_MaintenanceOrdeuting" PrimaryKey="EPM_MaintenanceOrdeuting">
                    <Column Key="OID" Caption="对象标识" DataElementKey="OID"/>
                    <Column Key="SOID" Caption="主对象标识" DataElementKey="SOID"/>
                    <Column Key="POID" Caption="父对象标识" DataElementKey="POID"/>
                    <Column Key="VERID" Caption="对象版本" DataElementKey="VERID"/>
                    <Column Key="DVERID" Caption="对象明细版本" DataElementKey="DVERID"/>
                    <Column Key="Sequence" Caption="序号" SortType="Asc" DataElementKey="Sequence"/>
                    <Column Key="ProcessNo" Caption="项目" SortType="Asc" DefaultValue="" DataElementKey="OperationNumber"/>
                    <Column Key="WorkCenterID" Caption="工作中心" CodeColumnKey="WorkCenterCode" DataElementKey="OrderWorkCenterID"/>
                    <Column Key="PlantID" Caption="工厂" CodeColumnKey="PlantCode" DataElementKey="PlantID"/>
                    <Column Key="OperationShortText" Caption="工序短文本" DefaultValue="" DataElementKey="OperationShortText"/>
                    <Column Key="ControlCodeID" Caption="控制码" CodeColumnKey="ControlCodeCode" DataElementKey="ControlCodeID"/>
                    <Column Key="RoutingNotes" Caption="描述" DefaultValue="" DataElementKey="RoutingNotes"/>
                    <Column Key="ProcessWorkTime" Caption="工序工作时长" DataElementKey="ProcessWorkTime" RefCol="ProcessWorkTimeUnitID"/>
                    <Column Key="ProcessWorkTimeUnitID" Caption="工序工作时长单位" CodeColumnKey="ProcessWorkTimeUnitCode" DataElementKey="WorkUnitID"/>
                    <Column Key="NumberofCapacity" Caption="能力数" DataElementKey="NumberofCapacity"/>
                    <Column Key="ProcessDuration" Caption="工序持续时长" DataElementKey="ProcessDuration" RefCol="ProcessDurationUnitID"/>
                    <Column Key="ProcessDurationUnitID" Caption="工序持续时长单位" CodeColumnKey="ProcessDurationUnitCode" DataElementKey="DurationUnitID"/>
                    <Column Key="EarliestStartDate" Caption="最早开始日期" DataElementKey="EarliestStartDate"/>
                    <Column Key="EarliestStartTime" Caption="最早开始时间" DataElementKey="EarliestStartTime"/>
                    <Column Key="EarliestEndDate" Caption="最早完工日期" DataElementKey="EarliestEndDate"/>
                    <Column Key="EarliestEndTime" Caption="最早完工时间" DataElementKey="EarliestEndTime"/>
                    <Column Key="LatestStartDate" Caption="最迟开始日期" DataElementKey="LatestStartDate"/>
                    <Column Key="LatestStartTime" Caption="最迟开始时间" DataElementKey="LatestStartTime"/>
                    <Column Key="LatestEndDate" Caption="最迟完工日期" DataElementKey="LatestEndDate"/>
                    <Column Key="LatestEndTime" Caption="最迟完工时间" DataElementKey="LatestEndTime"/>
                    <Column Key="ActualStartDate" Caption="实际开始日期" DataElementKey="ActualStartExecutionDate"/>
                    <Column Key="ActualStartTime" Caption="实际开始时间" DataElementKey="ActualStartExecutionTime"/>
                    <Column Key="ActualEndDate" Caption="实际完工日期" DataElementKey="ActualEndExecutionDate"/>
                    <Column Key="ActualEndTime" Caption="实际完工时间" DataElementKey="ActualEndExecutionTime"/>
                    <Column Key="ForecastEndDate" Caption="预测完成日期" DataElementKey="ForecastEndDate"/>
                    <Column Key="ForecastEndTime" Caption="预测完工时间" DataElementKey="ForecastEndTime"/>
                    <Column Key="ConfirmationDocNo" Caption="确认单编号" DefaultValue="" Description="确认单的单据编号" DataElementKey="DocumentNumber"/>
                    <Column Key="ActualWorkTime" Caption="实际工作时长" DataElementKey="ActualWorkTime"/>
                    <Column Key="ForecastWorkTime" Caption="预测工作时长" DataElementKey="ForecastWorkTime"/>
                    <Column Key="IsNoRemainingWork" Caption="没有剩余工作" DataElementKey="IsNoRemainingWork"/>
                    <Column Key="PurchaseReqSOID" Caption="采购申请" CodeColumnKey="PurchaseReqDocNo" DataElementKey="PurchaseReq4ExtProcessSOID"/>
                    <Column Key="PurchaseRequisitioItem" Caption="采购申请项目" DefaultValue="" Description="记录采购申请明细中的项目号，例如10、20、30" DataElementKey="PurchaseRequisitioItem"/>
                    <Column Key="GRQuantity" Caption="GR数量" Description="收货数量" DataElementKey="GRQuantity" RefCol="GRUnitID"/>
                    <Column Key="GRUnitID" Caption="GR单位" CodeColumnKey="GRUnitCode" Description="收货数量单位" DataElementKey="GRUnitID"/>
                    <Column Key="ActivityTypeID" Caption="活动类型" CodeColumnKey="ActivityTypeCode" DataElementKey="ActivityTypeID"/>
                    <Column Key="CalculationKey" Caption="计算规则" DataElementKey="CalculationKey"/>
                    <Column Key="ExecutionFactor" Caption="执行因子" DataElementKey="ExecutionFactor"/>
                    <Column Key="IsComponentAllocation" Caption="是否组件分配" Description="指定组件分配到该工序的标识" DataElementKey="IsComponentAllocation"/>
                    <Column Key="FunctionalLocationSOID" Caption="功能位置" CodeColumnKey="FunctionalLocationDocNo" DataElementKey="FunctionalLocationSOID"/>
                    <Column Key="EquipmentSOID" Caption="设备" CodeColumnKey="EquipmentDocNo" DataElementKey="EquipmentSOID"/>
                    <Column Key="IsOutsourcing" Caption="外协工序" DataElementKey="IsOutsourcing"/>
                    <Column Key="PurchasingOrganizationID" Caption="采购组织" CodeColumnKey="PurchasingOrganizationCode" DataElementKey="PurchasingOrganizationID"/>
                    <Column Key="PurchaseInfoRecordID" Caption="采购信息记录" CodeColumnKey="PurchaseInfoRecordCode" DataElementKey="PurchaseInfoRecordID"/>
                    <Column Key="PurchasingGroupID" Caption="采购组" CodeColumnKey="PurchasingGroupCode" DataElementKey="PurchasingGroup4ExtProcessingID"/>
                    <Column Key="CostElementID" Caption="成本要素" CodeColumnKey="CostElementCode" DataElementKey="CostElementID"/>
                    <Column Key="SortTerm" Caption="排序字符串" DefaultValue="" DataElementKey="SortTerm4NonStockInfoRecord"/>
                    <Column Key="MaterialGroupID" Caption="物料组" CodeColumnKey="MaterialGroupCode" DataElementKey="MaterialGroupID"/>
                    <Column Key="VendorID" Caption="供应商" CodeColumnKey="VendorCode" DataElementKey="VendorOrCreditorID"/>
                    <Column Key="OperationQuantity" Caption="工序数量" DataElementKey="OperationQuantity" RefCol="OperationBaseUnitID"/>
                    <Column Key="OperationBaseUnitID" Caption="工序基本单位" CodeColumnKey="OperationBaseUnitCode" DataElementKey="OperationBaseUnitID"/>
                    <Column Key="PlannedDeliveryDay" Caption="计划交货时间(天)" DataElementKey="PlannedDeliveryDay"/>
                    <Column Key="NetPriceQuantity" Caption="价格数量" DataElementKey="PriceQuantity"/>
                    <Column Key="NetPrice" Caption="净价" DataElementKey="Price4ExternalProcessing" RefCol="NetPriceCurrencyID"/>
                    <Column Key="NetPriceCurrencyID" Caption="币种" CodeColumnKey="NetPriceCurrencyCode" DataElementKey="CurrencyID"/>
                    <Column Key="IsSubcontract" Caption="转包" DataElementKey="IsSubcontract"/>
                    <Column Key="ConfirmQuantity" Caption="确认/反填工作量" DataElementKey="ConfirmQuantity"/>
                    <Column Key="RoutingStatusText" Caption="系统状态" DefaultValue="" DataElementKey="RoutingStatusText"/>
                    <Column Key="RoutingUserStatus" Caption="用户状态" DefaultValue="" DataElementKey="RoutingUserStatus"/>
                    <Column Key="NotificationSOID" Caption="通知单" CodeColumnKey="NotificationDocNo" DataElementKey="NotificationSOID"/>
                    <Column Key="SourseRoutingDtlOID" Caption="来源工序明细ID" DataElementKey="SourseRoutingDtlOID"/>
                    <Column Key="RoutingID" CodeColumnKey="RoutingCode" DataElementKey="RoutingID"/>
                    <Column Key="RoutingCode" DataElementKey="Code"/>
                    <Column Key="RequisitionCreationControl" Caption="预留/采购申请创建控制" Description="控制预留/采购申请单创建的时机，比如下达后创建" DataElementKey="RequisitionCreationControl"/>
                    <Column Key="WorkCenterCode" Caption="工作中心代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="PlantCode" Caption="工厂代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="ControlCodeCode" Caption="控制码代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="ProcessWorkTimeUnitCode" Caption="工作量单位代号" DefaultValue="" DataElementKey="Code_6"/>
                    <Column Key="ProcessDurationUnitCode" Caption="工序持续单位代号" DefaultValue="" DataElementKey="Code_6"/>
                    <Column Key="PurchaseReqDocNo" Caption="采购申请代号" DefaultValue="" DataElementKey="DocumentNumber"/>
                    <Column Key="GRUnitCode" Caption="GR单位代号" DefaultValue="" DataElementKey="Code_6"/>
                    <Column Key="ActivityTypeCode" Caption="活动类型代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="NotificationDocNo" Caption="通知单代号" DefaultValue="" DataElementKey="Code_100"/>
                    <Column Key="FunctionalLocationDocNo" Caption="功能位置代号" DefaultValue="" DataElementKey="Code_100"/>
                    <Column Key="EquipmentDocNo" Caption="设备代号" DefaultValue="" DataElementKey="Code_100"/>
                    <Column Key="PurchasingOrganizationCode" Caption="采购组织代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="PurchaseInfoRecordCode" Caption="采购信息记录代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="PurchasingGroupCode" Caption="采购组代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="CostElementCode" Caption="成本要素代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="MaterialGroupCode" Caption="物料组代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="OperationBaseUnitCode" Caption="工序基本单位代号" DefaultValue="" DataElementKey="Code_6"/>
                    <Column Key="OperatingConditionID" Caption="系统条件" CodeColumnKey="OperatingConditionCode" DataElementKey="OperatingConditionID"/>
                    <Column Key="Receive" Caption="接收方" DataElementKey="PM_Receive"/>
                    <Column Key="UnloadingPoint" Caption="卸货点" DataElementKey="UnloadingPoint"/>
                    <Column Key="Requester" Caption="申请者" DataElementKey="Requester"/>
                    <Column Key="TrackingNumber" Caption="跟踪号" DataElementKey="TrackingNumber"/>
                    <Column Key="StartPoint" Caption="起点" DataElementKey="StartPoint"/>
                    <Column Key="StartLimitDate" Caption="开始限制日期" DataElementKey="StartLimitDate"/>
                    <Column Key="StartLimitTime" Caption="开始限制时间" DataElementKey="StartLimitTime"/>
                    <Column Key="Ended" Caption="结束" DataElementKey="Ended"/>
                    <Column Key="EndLimitDate" Caption="完成限制时期" DataElementKey="EndLimitDate"/>
                    <Column Key="EndLimitTime" Caption="完成限制时间" DataElementKey="EndLimitTime"/>
                    <Column Key="Percentage" Caption="工作百分比" DataElementKey="Percentage_Integer"/>
                    <Column Key="SubProcessNo" Caption="子工序" SortType="Asc" DataElementKey="SubProcessNo"/>
                    <Column Key="Money" Caption="金额" DataElementKey="Money" RefCol="NetPriceCurrencyID"/>
                    <Column Key="SrcSOID" Caption="源单SOID" DataElementKey="SrcSOID"/>
                    <Column Key="SrcOID" Caption="源单OID" DataElementKey="SrcOID"/>
                    <Column Key="MapKey" DataElementKey="MapKey"/>
                    <Column Key="SrcFormKey" DataElementKey="SrcFormKey"/>
                    <Column Key="ValueTypeCode" Caption="数值种类" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="ValueTypeID" Caption="数值种类" CodeColumnKey="ValueTypeCode" DataElementKey="ValueTypeID"/>
                    <Column Key="PurchaseRequisitionDtlOID" Caption="采购申请明细ID" DataElementKey="PurchaseRequisitionDtlOID"/>
                    <Column Key="UserFieldText1" Caption="Text1" DataElementKey="UserFieldText20"/>
                    <Column Key="UserFieldText2" Caption="Text2" DataElementKey="UserFieldText20"/>
                    <Column Key="UserFieldText3" Caption="Text3" DataElementKey="UserFieldText"/>
                    <Column Key="UserFieldText4" Caption="Text4" DataElementKey="UserFieldText"/>
                    <Column Key="UserFieldDate1Time" Caption="Date1" DataElementKey="UserFieldDate1Time"/>
                    <Column Key="UserFieldDate2Time" Caption="Date2" DataElementKey="UserFieldDate1Time"/>
                    <Column Key="UserFieldNumber1" Caption="Number1" DataElementKey="UserFieldNumber"/>
                    <Column Key="UserFieldNumber2" Caption="Number2" DataElementKey="UserFieldNumber"/>
                    <Column Key="UserFieldValue1" Caption="Value1" DataElementKey="UserFieldValue" RefCol="UserFieldValue1CurrencyID"/>
                    <Column Key="UserFieldValue2" Caption="Value2" DataElementKey="UserFieldValue" RefCol="UserFieldValue2CurrencyID"/>
                    <Column Key="IsUserFieldCheckBox1" Caption="CheckBox1" DataElementKey="IsUserFieldCheckBox"/>
                    <Column Key="IsUserFieldCheckBox2" Caption="CheckBox2" DataElementKey="IsUserFieldCheckBox"/>
                    <Column Key="UserFieldNumber1UnitCode" Caption="Number1UnitID" DataElementKey="Code"/>
                    <Column Key="UserFieldNumber1UnitID" Caption="Number1UnitID" CodeColumnKey="UserFieldNumber1UnitCode" DataElementKey="UserFieldNumber1UnitID"/>
                    <Column Key="UserFieldNumber2UnitCode" Caption="Number1UnitID" DataElementKey="Code"/>
                    <Column Key="UserFieldNumber2UnitID" Caption="Number1UnitID" CodeColumnKey="UserFieldNumber2UnitCode" DataElementKey="UserFieldNumber1UnitID"/>
                    <Column Key="UserFieldValue1CurrencyCode" Caption="Value1CurrencyID" DataElementKey="Code"/>
                    <Column Key="UserFieldValue1CurrencyID" Caption="Value1CurrencyID" CodeColumnKey="UserFieldValue1CurrencyCode" DataElementKey="UserFieldValue1CurrencyID"/>
                    <Column Key="UserFieldValue2CurrencyCode" Caption="Value2CurrencyID" DataElementKey="Code"/>
                    <Column Key="UserFieldValue2CurrencyID" Caption="Value2CurrencyID" CodeColumnKey="UserFieldValue2CurrencyCode" DataElementKey="UserFieldValue1CurrencyID"/>
                    <Column Key="DefineUserFieldCode" Caption="字段码" DataElementKey="Code"/>
                    <Column Key="DefineUserFieldID" Caption="字段码" CodeColumnKey="DefineUserFieldCode" DataElementKey="DefineUserFieldID"/>
                    <Column Key="ServiceConfirmQuantity" Caption="服务确认数量" DataElementKey="ServiceConfirmQuantity"/>
                    <Column Key="ActivityTypePrice" Caption="作业类型价格" DataElementKey="ActivityTypePrice"/>
                    <Column Key="IsCompleted" Caption="完成" DataElementKey="IsCompleted"/>
                    <Column Key="StatusItem" Caption="工序状态" DefaultValue="0" DataElementKey="MaintenanceOrderStatusItem"/>
                    <Column Key="VendorCode" Caption="供应商" DataElementKey="Code"/>
                    <Column Key="NetPriceCurrencyCode" Caption="币种" DataElementKey="Code"/>
                    <Column Key="OperatingConditionCode" Caption="系统条件" DataElementKey="Code"/>
                    <Column Key="ExternalSystemPrimaryKey" Caption="外部系统关键字" DataElementKey="ExternalSystemPrimaryKey"/>
                    <Column Key="RO_IsPurchaseOrdExists" Caption="采购订单存在" Persist="false" DataElementKey="IsPurchaseOrdExists_RO" IgnoreQuery="true"/>
                    <Column Key="StandardTextKeyCode" Caption="标准文本码" DataElementKey="Code"/>
                    <Column Key="StandardTextKeyID" Caption="标准文本码" CodeColumnKey="StandardTextKeyCode" DataElementKey="StandardTextKeyID"/>
                </Table>
                <Table Key="EPM_MaintenanceOrder_NoSave" Caption="工序中分配的组件" TableMode="Detail" SourceType="" Persist="false" ParentKey="EPM_MaintOrder_Routing">
                    <Column Key="OID" Caption="对象标识" DataElementKey="OID"/>
                    <Column Key="SOID" Caption="主对象标识" DataElementKey="SOID"/>
                    <Column Key="POID" Caption="父对象标识" DataElementKey="POID"/>
                    <Column Key="VERID" Caption="对象版本" DataElementKey="VERID"/>
                    <Column Key="DVERID" Caption="对象明细版本" DataElementKey="DVERID"/>
                    <Column Key="Sequence" Caption="序号" DataElementKey="Sequence"/>
                    <Column Key="ProcessNo" Caption="项目" DefaultValue="" DataElementKey="ProcessNo_4"/>
                    <Column Key="MaterialID" Caption="组件" DataElementKey="MaterialID"/>
                    <Column Key="ShortText" Caption="短文本" DefaultValue="" DataElementKey="ShortText"/>
                    <Column Key="RequirementQuantity" Caption="需求数量" DataElementKey="RequirementQuantity" RefCol="BaseUnitID"/>
                    <Column Key="RequirementDate" Caption="需求日期" DataElementKey="RequirementDate"/>
                    <Column Key="RequirementTime" Caption="需求时间" DataElementKey="RequirementTime"/>
                    <Column Key="OffsetPos" Caption="偏置" DataElementKey="OffsetPos"/>
                    <Column Key="OffsetUnitID" Caption="偏置单位" DataElementKey="OffsetUnitID"/>
                    <Column Key="IsManualReqDateIndicator" Caption="手工需求日期" DataElementKey="IsManualReqDateIndicator"/>
                    <Column Key="ReservationSOID" Caption="预留" DataElementKey="ReservationSOID"/>
                    <Column Key="ReservationItem" Caption="预留项目" DataElementKey="ReservationItem"/>
                    <Column Key="MoveTypeID" Caption="移动类型" DataElementKey="MoveTypeID"/>
                    <Column Key="CommittedQuantity" Caption="允许数量" DataElementKey="CommittedQuantity" RefCol="BaseUnitID"/>
                    <Column Key="RequisiteQuantity" Caption="领料数量" DataElementKey="RequisiteQuantity" RefCol="BaseUnitID"/>
                    <Column Key="BaseUnitID" Caption="基本单位" DataElementKey="BaseUnitID"/>
                    <Column Key="IsFixedQuantity" Caption="数量固定" DataElementKey="IsFixedQuantity"/>
                    <Column Key="IsFinalDelivery" Caption="最后的发货" DataElementKey="IsFinalDelivery"/>
                    <Column Key="ItemCategoryID" Caption="项目类别" DataElementKey="PP_ItemCategoryID"/>
                    <Column Key="PlantID" Caption="工厂" DataElementKey="PlantID"/>
                    <Column Key="StorageLocationID" Caption="库存地点" DataElementKey="StorageLocationID"/>
                    <Column Key="RefProcessNo" Caption="对应的工序" DefaultValue="" DataElementKey="RefProcessNo"/>
                    <Column Key="BatchCode" Caption="批次" DefaultValue="" DataElementKey="BatchCode"/>
                    <Column Key="BatchCodeSOID" Caption="批次" DataElementKey="BatchCodeSOID"/>
                    <Column Key="IsDelete" Caption="已删除" DataElementKey="IsDelete"/>
                    <Column Key="IsBulkMaterial" Caption="散装物料" DataElementKey="IsBulkMaterial"/>
                    <Column Key="IsBackFlush" Caption="反冲" DataElementKey="IsBackFlush"/>
                    <Column Key="IsAllowedMovment" Caption="允许的货物移动" DataElementKey="IsAllowedMovment"/>
                    <Column Key="ResPurReqRelevance" Caption="预留/采购申请" DataElementKey="ResPurReqRelevance"/>
                    <Column Key="RelevancyToCostingID" Caption="成本核算相关" DefaultValue="" DataElementKey="RelevancyToCosting"/>
                    <Column Key="ProvisionIndicator" Caption="物料供应标识" DefaultValue="" DataElementKey="ProvisionIndicator"/>
                    <Column Key="AccountAssignmentCategoryID" Caption="科目分配类别" DataElementKey="AccountAssignmentCategoryID"/>
                    <Column Key="SpecialIdentity" Caption="特殊库存标识" DefaultValue="" DataElementKey="SpecialIdentity"/>
                    <Column Key="ValuationSpecialStock" Caption="评估" DefaultValue="" DataElementKey="Assessment"/>
                    <Column Key="ConsumptionIndicator" Caption="消耗过账" DefaultValue="" DataElementKey="ConsumptionIndicator"/>
                    <Column Key="PlannedDeliveryDay" Caption="计划交货时间(天)" DataElementKey="PlannedDeliveryDay"/>
                    <Column Key="NetPriceQuantity" Caption="价格数量" DataElementKey="NetPriceQuantity"/>
                    <Column Key="NetPrice" Caption="净价" DataElementKey="NetPrice" RefCol="NetPriceCurrencyID"/>
                    <Column Key="NetPriceCurrencyID" Caption="币种" DataElementKey="NetPriceCurrencyID"/>
                    <Column Key="PurchasingOrganizationID" Caption="采购组织" DataElementKey="PurchasingOrganizationID"/>
                    <Column Key="PurchaseInfoRecordID" Caption="采购信息记录" DataElementKey="PurchaseInfoRecordID"/>
                    <Column Key="PurchasingGroupID" Caption="采购组" DataElementKey="PurchasingGroupID"/>
                    <Column Key="SortTerm" Caption="排序字符串" DefaultValue="" DataElementKey="SortTerm"/>
                    <Column Key="CostElementID" Caption="总账科目" DataElementKey="CostElementID"/>
                    <Column Key="MaterialGroupID" Caption="物料组" DataElementKey="MaterialGroupID"/>
                    <Column Key="VendorID" Caption="供应商" DataElementKey="VendorID"/>
                    <Column Key="ReceiptProcessDay" Caption="收货处理时间" DataElementKey="ReceiptProcessDay"/>
                    <Column Key="ReservationDtlOID" Caption="预留明细号" DataElementKey="ReservationDtlOID"/>
                    <Column Key="PurchaseReqSOID" Caption="采购申请" DataElementKey="PurchaseReqSOID"/>
                    <Column Key="PurchaseRequisitioItem" Caption="行号" DefaultValue="" DataElementKey="PurchaseRequisitioItem"/>
                    <Column Key="IsRefurbishment" Caption="刷新物料" DataElementKey="IsRefurbishment"/>
                    <Column Key="DynIdentityID" Caption="特殊库存" DataElementKey="DynIdentityID" RefItemKeyCol="DynIdentityIDDEKey"/>
                    <Column Key="DynIdentityIDDEKey" Caption="特殊库存字典标识" DataElementKey="DynIdentityIDDataElementKey"/>
                    <Column Key="WorkCenterID" Caption="工作中心" DataElementKey="WorkCenterID"/>
                    <Column Key="DivisionID" DataElementKey="DivisionID"/>
                    <Column Key="MaterialCode" Caption="组件代号" DataElementKey="Code"/>
                    <Column Key="OffsetUnitCode" Caption="偏置单位代号" DataElementKey="Code_6"/>
                    <Column Key="ReservationDocNo" Caption="预留代号" DataElementKey="DocumentNumber"/>
                    <Column Key="MoveTypeCode" Caption="移动类型代号" DataElementKey="Code"/>
                    <Column Key="BaseUnitCode" Caption="基本单位代号" DataElementKey="Code_6"/>
                    <Column Key="DivisionCode" Caption="产品部门代号" DataElementKey="Code"/>
                    <Column Key="AssemblyTypeCode" Caption="项目类别代号" DataElementKey="Code"/>
                    <Column Key="PlantCode" Caption="工厂代号" DataElementKey="Code"/>
                    <Column Key="StorageLocationCode" Caption="库存地点代号" DataElementKey="Code"/>
                    <Column Key="AccountAssignmentCategoryCode" Caption="科目分配类别代号" DataElementKey="Code"/>
                    <Column Key="PurchasingOrganizationCode" Caption="采购组织代号" DataElementKey="Code"/>
                    <Column Key="PurchaseInfoRecordCode" Caption="采购信息记录代号" DataElementKey="Code"/>
                    <Column Key="PurchasingGroupCode" Caption="采购组代号" DataElementKey="Code"/>
                    <Column Key="PurchaseReqDocNo" Caption="采购申请代号" DataElementKey="DocumentNumber"/>
                    <Column Key="CostElementCode" Caption="总账科目代号" DataElementKey="Code"/>
                    <Column Key="MaterialGroupCode" Caption="物料组代号" DataElementKey="Code"/>
                    <Column Key="VendorCode" Caption="供应商代号" DataElementKey="Code"/>
                </Table>
                <Table Key="EPM_MaintenanceOrderObjects" Caption="维护项目单据字典数据对象明细" TableMode="Detail" IndexPrefix="EPM_MaintenanceOrdejects" PrimaryKey="EPM_MaintenanceOrdejects">
                    <Column Key="OID" Caption="对象标识" DataElementKey="OID"/>
                    <Column Key="SOID" Caption="主对象标识" DataElementKey="SOID"/>
                    <Column Key="POID" Caption="父对象标识" DataElementKey="POID"/>
                    <Column Key="VERID" Caption="对象版本" DataElementKey="VERID"/>
                    <Column Key="DVERID" Caption="对象明细版本" DataElementKey="DVERID"/>
                    <Column Key="IsProcessingIndicator" Caption="处理标识" DataElementKey="IsProcessingIndicator"/>
                    <Column Key="UII" Caption="唯一项目标识" DefaultValue="" DataElementKey="UII"/>
                    <Column Key="SerialNumber" Caption="序列号" DefaultValue="" DataElementKey="SerialNumber"/>
                    <Column Key="MaterialID" Caption="物料" CodeColumnKey="MaterialCode" DataElementKey="MaterialID"/>
                    <Column Key="EquipmentSOID" Caption="设备" CodeColumnKey="EquipmentDocNo" DataElementKey="EquipmentSOID"/>
                    <Column Key="FunctionalLocationSOID" Caption="功能位置" CodeColumnKey="FunctionalLocationDocNo" DataElementKey="FunctionalLocationSOID"/>
                    <Column Key="NotificationSOID" Caption="通知单" CodeColumnKey="NotificationDocNo" DataElementKey="NotificationSOID"/>
                    <Column Key="MaterialCode" Caption="物料代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="EquipmentDocNo" Caption="设备代号" DefaultValue="" DataElementKey="Code_100"/>
                    <Column Key="FunctionalLocationDocNo" Caption="功能位置代号" DefaultValue="" DataElementKey="Code_100"/>
                    <Column Key="NotificationDocNo" Caption="通知单代号" DefaultValue="" DataElementKey="Code_100"/>
                    <Column Key="Sequence" Caption="序号" DataElementKey="Sequence"/>
                    <Column Key="OJ_MaterialText" Caption="物料描述" Persist="false" DataElementKey="OJ_MaterialText" IgnoreQuery="true"/>
                    <Column Key="OJ_EquipmentText" Caption="设备描述" Persist="false" DataElementKey="OJ_EquipmentText" IgnoreQuery="true"/>
                    <Column Key="OJ_FunctionalLocationText" Caption="功能位置描述" Persist="false" DataElementKey="OJ_FunctionalLocationText" IgnoreQuery="true"/>
                </Table>
                <Table Key="EPM_MaintOrderRelations" Caption="维护项目单据字典数据序关系明细" TableMode="Detail" IndexPrefix="EPM_MaintenanceOrdetions" PrimaryKey="EPM_MaintenanceOrdetions">
                    <Column Key="OID" Caption="对象标识" DataElementKey="OID"/>
                    <Column Key="SOID" Caption="主对象标识" DataElementKey="SOID"/>
                    <Column Key="POID" Caption="父对象标识" DataElementKey="POID"/>
                    <Column Key="VERID" Caption="对象版本" DataElementKey="VERID"/>
                    <Column Key="DVERID" Caption="对象明细版本" DataElementKey="DVERID"/>
                    <Column Key="OperationNumber" Caption="工序号" DefaultValue="" DataElementKey="OperationNumber"/>
                    <Column Key="OffsetPos" Caption="偏置量" DataElementKey="PS_TimeInterval"/>
                    <Column Key="OffsetUnitID" Caption="单位" CodeColumnKey="OffsetUnitCode" DataElementKey="TimeIntervalUnitID"/>
                    <Column Key="RelationType" Caption="关系类型" DefaultValue="" DataElementKey="RelationType"/>
                    <Column Key="IsSuccessorIndicator" Caption="后续标识" DataElementKey="IsSuccessorIndicator"/>
                    <Column Key="OperationShortText" Caption="工序短文本" DefaultValue="" DataElementKey="OperationShortText"/>
                    <Column Key="OffsetUnitCode" Caption="单位代号" DefaultValue="" DataElementKey="Code_6"/>
                    <Column Key="Sequence" Caption="序号" DataElementKey="Sequence"/>
                </Table>
                <Table Key="EPM_MaintenanceOrder_BOM" Caption="维护项目单据字典数据序BOM明细" TableMode="Detail" IndexPrefix="EPM_MaintenanceOrder_BOM">
                    <Column Key="OID" Caption="对象标识" DataElementKey="OID"/>
                    <Column Key="SOID" Caption="主对象标识" DataElementKey="SOID"/>
                    <Column Key="POID" Caption="父对象标识" DataElementKey="POID"/>
                    <Column Key="VERID" Caption="对象版本" DataElementKey="VERID"/>
                    <Column Key="DVERID" Caption="对象明细版本" DataElementKey="DVERID"/>
                    <Column Key="Sequence" Caption="序号" DataElementKey="Sequence"/>
                    <Column Key="MaterialID" Caption="组件" CodeColumnKey="MaterialCode" DataElementKey="MaterialID"/>
                    <Column Key="DivisionID" Caption="产品部门" CodeColumnKey="DivisionCode" DataElementKey="DivisionID"/>
                    <Column Key="ShortText" Caption="短文本" DefaultValue="" DataElementKey="ShortText"/>
                    <Column Key="BaseQuantity" Caption="基本数量" DataElementKey="DemandBaseQuantity" RefCol="BaseUnitID"/>
                    <Column Key="RequirementQuantity" Caption="需求数量" DataElementKey="Quantity" RefCol="UnitID"/>
                    <Column Key="BaseUnitID" Caption="基本单位" CodeColumnKey="BaseUnitCode" DataElementKey="BaseUnitID"/>
                    <Column Key="UnitID" Caption="单位" CodeColumnKey="UnitCode" DataElementKey="UnitOfEntryID"/>
                    <Column Key="Order2BaseNumerator" Caption="订单到基本单位-分子" DataElementKey="BaseUnitNumerator"/>
                    <Column Key="Order2BaseDenominator" Caption="订单到基本单位-分母" DataElementKey="BaseUnitDenominator"/>
                    <Column Key="ItemCategoryID" Caption="项目类别" CodeColumnKey="ItemCategoryCode" DataElementKey="PP_ItemCategoryID"/>
                    <Column Key="PlantID" Caption="工厂" CodeColumnKey="PlantCode" DataElementKey="PlantID"/>
                    <Column Key="StorageLocationID" Caption="库存地点" CodeColumnKey="StorageLocationCode" DataElementKey="StorageLocationID"/>
                    <Column Key="RefProcessNo" Caption="对应的工序" DefaultValue="" SortType="Asc" DataElementKey="OperationNumber"/>
                    <Column Key="ProcessNo" Caption="项目" DefaultValue="" SortType="Asc" DataElementKey="ProcessNo_4"/>
                    <Column Key="BatchCode" Caption="批次" DefaultValue="" DataElementKey="BatchCode"/>
                    <Column Key="BatchCodeSOID" Caption="批次" DataElementKey="BatchCodeSOID"/>
                    <Column Key="StatusItem" Caption="项目状态" DefaultValue="0" DataElementKey="MaintenanceOrderStatusItem"/>
                    <Column Key="IsBulkMaterial" Caption="散装物料" DataElementKey="IsBulkMaterial"/>
                    <Column Key="IsBackFlush" Caption="反冲" DataElementKey="IsBackFlush"/>
                    <Column Key="RequirementDate" Caption="需求日期" DataElementKey="RequirementDate"/>
                    <Column Key="RequirementTime" Caption="需求时间" DataElementKey="RequirementTime"/>
                    <Column Key="OffsetPos" Caption="偏置" DataElementKey="LeadtimeOffset4Operation"/>
                    <Column Key="OffsetUnitID" Caption="偏置单位" CodeColumnKey="OffsetUnitCode" DataElementKey="LeadtimeOffsetUnitID"/>
                    <Column Key="IsManualReqDateIndicator" Caption="手工需求日期" DataElementKey="IsManualReqDateIndicator"/>
                    <Column Key="ReservationSOID" Caption="预留" CodeColumnKey="ReservationDocNo" DataElementKey="ReservationSOID"/>
                    <Column Key="ReservationItem" Caption="预留项目" DataElementKey="ReservationItem"/>
                    <Column Key="MoveTypeID" Caption="移动类型" CodeColumnKey="MoveTypeCode" DataElementKey="MoveTypeID"/>
                    <Column Key="CommittedQuantity" Caption="允许数量" DataElementKey="AllowQuantity" RefCol="UnitID"/>
                    <Column Key="RequisiteQuantity" Caption="领料数量" DataElementKey="PickupBaseQuantity" RefCol="RequisiteUnitID"/>
                    <Column Key="RequisiteUnitID" Caption="领料单位" CodeColumnKey="RequisiteUnitCode" DataElementKey="RequisiteUnitID"/>
                    <Column Key="IsFixedQuantity" Caption="数量固定" DataElementKey="IsFixedQuantity"/>
                    <Column Key="IsFinalDelivery" Caption="最后的发货" DataElementKey="IsFinalIssue"/>
                    <Column Key="RequisitionCreationControl" Caption="预留/采购申请创建控制" DataElementKey="RequisitionCreationControl"/>
                    <Column Key="RelevancyToCostingID" Caption="成本相关性" CodeColumnKey="RelevancyToCostingCode" DataElementKey="RelevancyToCostingID"/>
                    <Column Key="PlannedDeliveryDay" Caption="计划交货时间(天)" DataElementKey="BOM_PlannedDeliveryDay"/>
                    <Column Key="NetPriceQuantity" Caption="价格数量" DataElementKey="PriceQuantity"/>
                    <Column Key="NetPrice" Caption="净价" DataElementKey="ComponentCryNetPrice" RefCol="NetPriceCurrencyID"/>
                    <Column Key="NetPriceCurrencyID" Caption="币种" CodeColumnKey="NetPriceCurrencyCode" DataElementKey="CurrencyID"/>
                    <Column Key="PurchasingOrganizationID" Caption="采购组织" CodeColumnKey="PurchasingOrganizationCode" DataElementKey="PurchasingOrganizationID"/>
                    <Column Key="PurchaseInfoRecordID" Caption="采购信息记录" CodeColumnKey="PurchaseInfoRecordCode" DataElementKey="PurchaseInfoRecordID"/>
                    <Column Key="PurchasingGroupID" Caption="采购组" CodeColumnKey="PurchasingGroupCode" DataElementKey="PurchasingGroupID"/>
                    <Column Key="SortTerm" Caption="排序字符串" DefaultValue="" DataElementKey="SortTerm"/>
                    <Column Key="MaterialGroupID" Caption="物料组" CodeColumnKey="MaterialGroupCode" DataElementKey="MaterialGroupID"/>
                    <Column Key="VendorID" Caption="供应商" CodeColumnKey="VendorCode" DataElementKey="VendorOrCreditorID"/>
                    <Column Key="CostElementID" Caption="成本要素" CodeColumnKey="CostElementCode" DataElementKey="CostElementID"/>
                    <Column Key="ReceiptProcessDay" Caption="收货处理时间（天）" DataElementKey="ReceiptProcessDays"/>
                    <Column Key="IsAllowedMovment" Caption="允许的货物移动" DataElementKey="IsAllowGoodsMove4Reservation"/>
                    <Column Key="AccountAssignmentCategoryID" Caption="科目分配类别" CodeColumnKey="AccountAssignmentCategoryCode" DataElementKey="AccountAssignmentCategoryID"/>
                    <Column Key="SpecialIdentity" Caption="特殊库存标识" DefaultValue="" DataElementKey="SpecialIdentity"/>
                    <Column Key="ProvisionIndicator" Caption="物料供应标识" DefaultValue="" DataElementKey="ProvisionIndicator"/>
                    <Column Key="ValuationSpecialStock" Caption="评估" DefaultValue="" DataElementKey="Assessment"/>
                    <Column Key="ConsumptionIndicator" Caption="消耗过账" DefaultValue="" DataElementKey="ConsumptionIndicator"/>
                    <Column Key="ParentMaintOrderRoutingOID" Caption="B_ParentBillDtlID" DataElementKey="ParentMaintOrderRoutingOID"/>
                    <Column Key="ReservationDtlOID" Caption="预留明细号" DataElementKey="ReservationDtlOID"/>
                    <Column Key="PurchaseReqSOID" Caption="采购申请" CodeColumnKey="PurchaseReqDocNo" DataElementKey="PurchaseRequisitionSOID"/>
                    <Column Key="PurchaseRequisitioItem" Caption="行号" DefaultValue="" DataElementKey="PurchaseRequisitioItem"/>
                    <Column Key="IsRefurbishment" Caption="刷新物料" DataElementKey="IsRefurbishment"/>
                    <Column Key="DynIdentityID" Caption="特殊库存" DataElementKey="DynIdentityID" RefItemKeyCol="DynIdentityIDDEKey"/>
                    <Column Key="DynIdentityIDDEKey" Caption="特殊库存字典标识" DataElementKey="DynIdentityIDDataElementKey"/>
                    <Column Key="WorkCenterID" Caption="工作中心" CodeColumnKey="WorkCenterCode" DataElementKey="WorkCenterID"/>
                    <Column Key="MaterialBOMDtlSOID" DataElementKey="MaterialBOMSOID"/>
                    <Column Key="MaterialBOMDtlOID" DataElementKey="MaterialBOMDtlOID"/>
                    <Column Key="MaterialCode" Caption="组件代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="OffsetUnitCode" Caption="偏置单位代号" DefaultValue="" DataElementKey="Code_6"/>
                    <Column Key="ReservationDocNo" Caption="预留代号" DefaultValue="" DataElementKey="DocumentNumber"/>
                    <Column Key="MoveTypeCode" Caption="移动类型代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="BaseUnitCode" Caption="基本单位代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="UnitCode" Caption="单位代号" DefaultValue="" DataElementKey="Code_6"/>
                    <Column Key="DivisionCode" Caption="产品部门代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="ItemCategoryCode" Caption="项目类别代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="PlantCode" Caption="工厂代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="StorageLocationCode" Caption="库存地点代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="AccountAssignmentCategoryCode" Caption="科目分配类别代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="PurchasingOrganizationCode" Caption="采购组织代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="PurchaseInfoRecordCode" Caption="采购信息记录代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="PurchasingGroupCode" Caption="采购组代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="PurchaseReqDocNo" Caption="采购申请代号" DefaultValue="" DataElementKey="DocumentNumber"/>
                    <Column Key="CostElementCode" Caption="总账科目代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="MaterialGroupCode" Caption="物料组代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="VendorCode" Caption="供应商代号" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="PurchaseRequisitionDtlOID" Caption="采购订单明细行OID" DataElementKey="PurchaseRequisitionDtlOID"/>
                    <Column Key="Money" Caption="金额" DataElementKey="Money" RefCol="NetPriceCurrencyID"/>
                    <Column Key="ValueTypeCode" Caption="数值种类" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="ValueTypeID" Caption="数值种类" CodeColumnKey="ValueTypeCode" DataElementKey="ValueTypeID"/>
                    <Column Key="RequisiteUnitCode" Caption="接收单位" DataElementKey="Code"/>
                    <Column Key="RelevancyToCostingCode" Caption="成本核算相关" DataElementKey="Code"/>
                    <Column Key="NetPriceCurrencyCode" Caption="币种" DataElementKey="Code"/>
                    <Column Key="WorkCenterCode" Caption="工作中心" DataElementKey="Code"/>
                    <Column Key="BO_IsChecked" Caption="是否检查了该组件" Persist="false" DataElementKey="IsChecked_BO" IgnoreQuery="true"/>
                    <Column Key="MapCount" Caption="MapCount" DataType="Integer"/>
                </Table>
                <Table Key="EPM_Cost" Caption="数值种类成本汇总表" TableMode="Detail" SourceType="Custom" Persist="false" Formula="Macro_Cost()">
                    <Column Key="OID" Caption="对象标识" DataElementKey="OID"/>
                    <Column Key="SOID" Caption="主对象标识" DataElementKey="SOID"/>
                    <Column Key="POID" Caption="父对象标识" DataElementKey="POID"/>
                    <Column Key="VERID" Caption="对象版本" DataElementKey="VERID"/>
                    <Column Key="DVERID" Caption="对象明细版本" DataElementKey="DVERID"/>
                    <Column Key="ValueTypeCode" Caption="数值种类" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="ValueTypeID" Caption="数值种类" CodeColumnKey="ValueTypeCode" DataElementKey="ValueTypeID"/>
                    <Column Key="EstimatedCost" Caption="已估计成本" DataElementKey="EstimatedCost"/>
                    <Column Key="PlannedCost" Caption="计划成本" DataElementKey="PlannedCost"/>
                    <Column Key="ActualCost" Caption="实际成本" DataElementKey="ActualCost"/>
                </Table>
                <Table Key="EPM_CostOverview" Caption="成本概览" TableMode="Detail" SourceType="Query" Persist="false" OrderBy="'Code'">
                    <Column Key="OID" Caption="对象标识" DataElementKey="OID"/>
                    <Column Key="SOID" Caption="主对象标识" DataElementKey="SOID"/>
                    <Column Key="POID" Caption="父对象标识" DataElementKey="POID"/>
                    <Column Key="VERID" Caption="对象版本" DataElementKey="VERID"/>
                    <Column Key="DVERID" Caption="对象明细版本" DataElementKey="DVERID"/>
                    <Column Key="ValueTypeCode" Caption="数值种类" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="ValueTypeID" Caption="数值种类" CodeColumnKey="ValueTypeCode" DataElementKey="ValueTypeID"/>
                    <Column Key="EstimatedCost" Caption="估算成本" DataElementKey="EstimatedCost"/>
                    <Column Key="PlannedCost" Caption="计划成本" DataElementKey="PlannedCost"/>
                    <Column Key="ActualCost" Caption="实际成本" DataElementKey="ActualCost"/>
                    <Statement Type="Formula">
                        <![CDATA[Macro_CostOverviewSql()]]>
                    </Statement>
                </Table>
                <Table Key="EPM_IncludedTaskLists" Caption="包含的任务清单" TableMode="Detail" IndexPrefix="EPM_IncludedTaskLists">
                    <Column Key="OID" Caption="对象标识" DataElementKey="OID"/>
                    <Column Key="SOID" Caption="主对象标识" DataElementKey="SOID"/>
                    <Column Key="POID" Caption="父对象标识" DataElementKey="POID"/>
                    <Column Key="VERID" Caption="对象版本" DataElementKey="VERID"/>
                    <Column Key="DVERID" Caption="对象明细版本" DataElementKey="DVERID"/>
                    <Column Key="Sequence" Caption="序号" DataElementKey="Sequence"/>
                    <Column Key="RoutingCode" Caption="任务清单ID" DefaultValue="" DataElementKey="Code"/>
                    <Column Key="RoutingID" Caption="任务清单ID" CodeColumnKey="RoutingCode" DataElementKey="RoutingID"/>
                    <Column Key="TaskListType" Caption="任务清单类型" DataElementKey="RoutingListType"/>
                    <Column Key="RoutingGroup" Caption="任务清单组" DataElementKey="RoutingGroup"/>
                    <Column Key="GroupCounter" Caption="组计数器" DataElementKey="GroupCounter"/>
                    <Column Key="EquipmentDocNo" Caption="设备" DefaultValue="" DataElementKey="Code_100"/>
                    <Column Key="EquipmentSOID" Caption="设备" CodeColumnKey="EquipmentDocNo" DataElementKey="EquipmentSOID"/>
                    <Column Key="FunctionalLocationDocNo" Caption="功能位置" DefaultValue="" DataElementKey="Code_100"/>
                    <Column Key="FunctionalLocationSOID" Caption="功能位置" CodeColumnKey="FunctionalLocationDocNo" DataElementKey="FunctionalLocationSOID"/>
                    <Column Key="TaskListDescription" Caption="任务清单描述" DataElementKey="TaskListDescription"/>
                </Table>
                <Table Key="EPM_MissingConponentsGrid" Caption="维护订单的表格MissingConponentsGrid的非持久化表" TableMode="Detail" SourceType="" Persist="false">
                    <Column Key="OID" Caption="对象标识" DataElementKey="OID"/>
                    <Column Key="SOID" Caption="主对象标识" DataElementKey="SOID"/>
                    <Column Key="POID" Caption="父对象标识" DataElementKey="POID"/>
                    <Column Key="SelectField" Caption="选择" DataElementKey="SelectField"/>
                    <Column Key="Sequence" Caption="系统序号标志" DataElementKey="Sequence"/>
                    <Column Key="RelationBillDtlID" Persist="false" DataElementKey="Numeric_Integer" IgnoreQuery="true"/>
                    <Column Key="ATPPlantID" Caption="工厂" Persist="false" DataElementKey="PlantID" IgnoreQuery="true"/>
                    <Column Key="ATPMaterialID" Caption="物料" Persist="false" DataElementKey="MaterialID" IgnoreQuery="true"/>
                    <Column Key="ATPRequirementDate" Caption="需求日期" Persist="false" DataElementKey="RequirementDate" IgnoreQuery="true"/>
                    <Column Key="ATPRequirementQuantity" Caption="需求数量" Persist="false" DataElementKey="ATPRequirementQuantity" IgnoreQuery="true"/>
                    <Column Key="ATPBaseUnitID" Caption="基本计量单位" Persist="false" DataElementKey="UnitID" IgnoreQuery="true"/>
                    <Column Key="ATPBatchCode" Caption="批次" Persist="false" DataElementKey="ATPBatchCode" IgnoreQuery="true"/>
                    <Column Key="ATPStorageLocationID" Caption="库存地点" Persist="false" DataElementKey="StorageLocationID" IgnoreQuery="true"/>
                    <Column Key="ATPCommittedQuantity" Caption="已确认数量" Persist="false" DataElementKey="ATPCommittedQuantity" IgnoreQuery="true"/>
                    <Column Key="ATPQuantity" Caption="ATP数量" Persist="false" DataElementKey="ATPQuantity" IgnoreQuery="true"/>
                    <Column Key="CheckingGroupID" Caption="检查组" Persist="false" DataElementKey="CheckingGroupID_Numeric" IgnoreQuery="true"/>
                    <Column Key="IsATPChecked" Caption="是否检查了该组件" Persist="false" DataElementKey="IsATPChecked" IgnoreQuery="true"/>
                </Table>
            </TableCollection>
        </DataObject>
    </DataSource>
    <OperationCollection>
        <Operation Key="BillEdit" Caption="修改" Enable="ReadOnly()&amp;&amp;MaintProcessingPhase&lt;=2" RefKey="BillEdit" TCode="'IW32'" Activity="02"/>
        <Operation Key="BillSave" Caption="保存" Enable="!ReadOnly()">
            <Action>
                <![CDATA[UICheck();Macro_SaveData()]]>
            </Action>
        </Operation>
        <Operation Key="BillCancel" Caption="取消" Visible="true" Enable="!ReadOnly()">
            <Action>
                <![CDATA[ConfirmMsg('PM_MAINTENANCEORDER001', '确认取消操作？', {}, 'YES_NO',{YES:{Macro_ClearDocCache();Cancel();},NO:{}})]]>
            </Action>
        </Operation>
        <Operation Key="Custom_Refresh" Caption="刷新" Enable="true">
            <Action>
                <![CDATA[Macro_LoadObject()]]>
            </Action>
        </Operation>
        <OperationCollection Key="TaskListDirectInput" Caption="任务清单选择" Enable="true" SelfDisable="true">
            <Operation Key="DirectInput" Caption="直接输入" Enable="!ReadOnly()">
                <Action>
                    <![CDATA[ERPShowModal('PM_TaskListDirectInput')]]>
                </Action>
            </Operation>
            <Operation Key="ToReferenceObject" Caption="到参考对象" Enable="!ReadOnly()">
                <Action>
                    <![CDATA[SetPara('_CaptionType', 1);IIF(FunctionalLocationSOID>0||EquipmentSOID>0,ERPShowModal('PM_TaskToReferenceObject','Macro_PM_ToReferenceObject_ShowEvent('&'"'&FunctionalLocationSOID&'","'&EquipmentSOID&'"'&',"'&PlanningPlantID&'"'&')'),RaiseErrMsg('I0036', '请选择功能位置或设备'))]]>
                </Action>
            </Operation>
            <Operation Key="GeneralTaskList" Caption="一般任务清单" Enable="!ReadOnly()">
                <Action>
                    <![CDATA[Macro_GenDisplayTaskListCondBillJSON();Macro_PushSelfPara('_JSONStrDocPara');ERPShowModal('PM_DisplayTaskListQuery');]]>
                </Action>
            </Operation>
            <Operation Key="DisplayTaskList" Caption="显示任务清单" Enable="true">
                <Action>
                    <![CDATA[SetActiveTab('PlanSplitPanel')]]>
                </Action>
            </Operation>
        </OperationCollection>
        <Operation Key="SelectStructureList" Caption="结构清单选择" Enable="!ReadOnly()">
            <Action>
                <![CDATA[
                UICheck();
                IIF(
                        EquipmentSOID <= 0 && FunctionalLocationSOID <= 0
                        , RaiseErrMsg('I0038', '输入结构显示的有效对象')
                );
                SetPara('_AllocationOperationDtlID', ToLong(GetCellValue('MaintenanceOrder_RoutingGrid', 0, 'RO_OID')));

                if(IsFocusTabByKey('RoutingSplitPanel')){
                    var ro_OIDs = GetSelDtlFldValue('RO_OID');
                    /**有且只有一个选中项*/
                    if(Length(ro_OIDs) > 0 && IndexOf(ro_OIDs,',')<0){
                        SetPara('_AllocationOperationDtlID', ToLong(ro_OIDs));
                        return Macro_OpenStructuralDisplay();
                    }
                }
                IIF(
                        GetRowCount('MaintenanceOrder_RoutingGrid') > 1
                        , ERPShowModal('PM_AllocationOperation')
                        , Macro_OpenStructuralDisplay()
                )]]>
            </Action>
        </Operation>
        <Operation Key="GoodsMovementList_Opt" Caption="货物移动列表" Enable="!IsNew()">
            <Action>
                <![CDATA[UICheck();ERPShowModal('PP_GoodsMovmentList')]]>
            </Action>
        </Operation>
        <Operation Key="PmDocFlow" Caption="显示凭证流" Enable="ReadOnly()">
            <Action>
                <![CDATA[SetPara('_FormKey',GetFormKey());SetPara('_BillSOID', SOID);ERPShowModal('V_DocumentVoucherFlow', GetCallFormula('Macro_CommonDef__ShowEvent_Formula',SOID), 'newtab')]]>
            </Action>
        </Operation>
        <Operation Key="Issued_Opt" Caption="下达" Enable="!ReadOnly() &amp;&amp; Macro_IsCRTD()" TCode="'IW32'" Activity="02">
            <Action>
                <![CDATA[UICheck();Macro_PmOrderIssued();]]>
            </Action>
        </Operation>
        <Operation Key="AvailabilityCheck" Caption="可用性检查" Enable="!ReadOnly()">
            <Action>
                <![CDATA[UICheck();
Macro_AvailabilityCheck();
if(GetValue('ATPMsg')=='') {true} 
else {ConfirmMsg('PM_MAINTENANCEORDER022', '{1}', {{GetValue('ATPMsg')}})}]]>
            </Action>
        </Operation>
        <Operation Key="OrderTeco_Opt" Caption="技术性完成" Enable="ReadOnly()&amp;&amp;!Macro_IsTECO()&amp;&amp;!Macro_IsCLSD()&amp;&amp;!Macro_IsDLFL()&amp;&amp;Macro_IsREL()" TCode="'IW32'" Activity="02" NeedAccessLog="true">
            <Action>
                <![CDATA[UICheck();SetPara('PMOrderOperation','TECO');Macro_MidComplete(false)]]>
            </Action>
        </Operation>
        <Operation Key="SettlementRule" Caption="结算规则">
            <Action>
                <![CDATA[UICheck();RefreshUIStatus();Macro_SettlementRule_RunAsExp();]]>
            </Action>
        </Operation>
        <Operation Key="PMOrderCancelTeco_Opt" Caption="撤销技术性完成" Enable="ReadOnly()&amp;&amp;Macro_IsTECO()&amp;&amp;!Macro_IsCLSD()&amp;&amp;!Macro_IsDLFL()" TCode="'IW32'" Activity="02" NeedAccessLog="true">
            <Action>
                <![CDATA[UICheck();Macro_PMOrderCancelTeco_Opt_RunAsExp();RefreshOperation()]]>
            </Action>
        </Operation>
        <Operation Key="CLSD_Opt" Caption="完成(业务)" Enable="ReadOnly()&amp;&amp;!Macro_IsCLSD()&amp;&amp;!Macro_IsDLFL()&amp;&amp;Macro_CLSD_Opt_RunAsExp2()" TCode="'IW32'" Activity="02" NeedAccessLog="true">
            <Action>
                <![CDATA[UICheck();SetPara('PMOrderOperation','CLOSE');Macro_MidComplete(false)]]>
            </Action>
        </Operation>
        <Operation Key="DoNotExecute_Opt" Caption="请勿执行" Enable="ReadOnly()&amp;&amp;Macro_IsCRTD()" TCode="'IW32'" Activity="02" NeedAccessLog="true">
            <Action>
                <![CDATA[UICheck();ConfirmMsg('PM_MAINTENANCEORDER040', '订单标记为‘未执行’？', {}, 'YES_NO', {
                NO: {
                    true
                },
                YES: {
                    Macro_DoNotExecute();
                }
            });]]>
            </Action>
        </Operation>
        <Operation Key="PMOrderCancelClose_Opt" Caption="撤销完成业务" Enable="ReadOnly()&amp;&amp;Macro_IsCLSD()&amp;&amp;!Macro_IsDLFL()" TCode="'IW32'" Activity="02" NeedAccessLog="true">
            <Action>
                <![CDATA[UICheck();Macro_PMOrderCancelClose_Opt_RunAsExp();RefreshOperation()]]>
            </Action>
        </Operation>
        <OperationCollection Key="DeleteOrderFlag" Caption="删除标识" SelfDisable="true">
            <Operation Key="OrderSet" Caption="设置" Enable="IIF(Macro_IsDLFL(),true,ReadOnly()&amp;&amp;!IsNew()&amp;&amp;Macro_IsCLSD())&amp;&amp;!Macro_IsDLFL()" TCode="'IW32'" Activity="02" NeedAccessLog="true">
                <Action>
                    <![CDATA[UICheck();Macro_OrderSet_RunAsExp();RefreshOperation()]]>
                </Action>
            </Operation>
            <Operation Key="OrderResett" Caption="重置" Enable="IIF(Macro_IsDLFL(),true,ReadOnly()&amp;&amp;!IsNew()&amp;&amp;Macro_IsCLSD())&amp;&amp;Macro_IsDLFL()" TCode="'IW32'" Activity="02" NeedAccessLog="true">
                <Action>
                    <![CDATA[UICheck();Macro_OrderResett_RunAsExp();RefreshOperation()]]>
                </Action>
            </Operation>
        </OperationCollection>
        <Operation Key="DisplayDeletions" Caption="显示/隐藏删除" Enable="true">
            <Action>
                <![CDATA[UICheck();SetPara('_IsDisplayDeletions',!GetPara('_IsDisplayDeletions'));RefreshControl('MaintenanceOrder_RoutingGrid');RefreshControl('ComponentGrid');RefreshOperation()]]>
            </Action>
        </Operation>
        <OperationCollection Key="SubOrder" Caption="子订单" SelfDisable="true">
            <Operation Key="SubView" Caption="概览">
                <Action>
                    <![CDATA[ERPShowModal("PM_MaintOrderTreeList_Rpt",GetCallFormula("Macro_QueryAllSub",GetOID(),GetValue("ParentOrderSOID")))]]>
                </Action>
            </Operation>
            <Operation Key="SubCostView" Caption="成本概览">
                <Action>
                    <![CDATA[ERPShowModal("CO_MaintOrderTreeCost_Rpt",GetCallFormula("Macro_getMaintOrderTreeCost",GetOID(),GetValue("ParentOrderSOID")))]]>
                </Action>
            </Operation>
        </OperationCollection>
        <Operation Key="OpenPMOrderCost" Caption="成本构成">
            <Action>
                <![CDATA[Open('CO_PMOrderCost',Macro_GetPMOrderCostID())]]>
            </Action>
        </Operation>
        <Operation Key="Lock" Caption="锁定" Enable="ReadOnly()&amp;&amp;!Macro_IsStatusActive('I0043,I0076,I0015')" NeedAccessLog="true">
            <Action>
                <![CDATA[UICheck();Macro_Lock_Opt_RunAsExp();RefreshOperation();]]>
            </Action>
        </Operation>
        <Operation Key="UnLock" Caption="取消锁定" Enable="ReadOnly()&amp;&amp;Macro_IsStatusActive('I0043')" NeedAccessLog="true">
            <Action>
                <![CDATA[UICheck();Macro_UnLock_Opt_RunAsExp();RefreshOperation();]]>
            </Action>
        </Operation>
        <OperationCollection Key="NewPrint" Caption="打印" SelfDisable="true">
            <Operation Key="NewPrintDefault" Caption="默认模板打印" RefKey="NewPrintDefault" Activity="04"/>
            <Operation Key="NewPrintSelect" Caption="其他模板选择" RefKey="NewPrintSelect" Activity="04"/>
            <Operation Key="ManagePrint" Caption="打印模板管理" RefKey="ManagePrint" Activity="04"/>
        </OperationCollection>
        <Operation Key="ERPExportExcel" Caption="导出" RefKey="ERPExportExcel" Activity="Y11"/>
        <Operation Key="ShowDataLog" Caption="查看数据日志" RefKey="ShowDataLog" Activity="Y08"/>
        <Operation Key="ShowMessage" Caption="显示消息" RefKey="ShowMessage"/>
        <Operation Key="UIClose" Caption="关闭" RefKey="UIClose"/>
    </OperationCollection>
    <Body>
        <Block>
            <FlexFlowLayoutPanel Key="root">
                <ToolBar Key="ToolBar" Caption="ToolBar1" Height="pref">
                    <ToolBarItemCollection/>
                </ToolBar>
                <SplitPanel Key="main_container" Orientation="Vertical" Height="100%">
                    <TabPanel Key="TopTabPanel">
                        <GridLayoutPanel Key="BasicInformation" Caption="基本信息" Padding="8px" OverflowY="Auto" TopPadding="24px" Visible="true">
                            <TextEditor Key="DocumentNumber" Caption="单据编号" LabelType="M" X="0" Y="0" Visible="true" Enable="false" MaxLength="50" Trim="true">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="DocumentNumber"/>
                            </TextEditor>
                            <UTCDatePicker Key="DocumentDate" Caption="凭证日期" LabelType="M" X="2" Y="1" Visible="false" Format="yyyy-MM-dd">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="DocumentDate" DefaultFormulaValue="DateLong()" Required="true"/>
                            </UTCDatePicker>
                            <Dict Key="OrderTypeID" Caption="订单类型" LabelType="M" X="1" Y="0" Visible="true" Enable="false" ItemKey="PM_OrderType">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="OrderTypeID"/>
                            </Dict>
                            <TextEditor Key="OrderText" Caption="订单描述" X="2" Y="0" Visible="true" MaxLength="2000" Trim="true" XSpan="2">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="OrderText">
                                    <ValueChanged>
                                        <![CDATA[IIF(Length(FirstOperation)==0,SetValue('FirstOperation',OrderText,true))]]>
                                    </ValueChanged>
                                </DataBinding>
                            </TextEditor>
                            <TextEditor Key="SystemStatusText" Caption="系统状态" LabelType="M" X="0" Y="1" Visible="true" Enable="false" MaxLength="100" Trim="true" XSpan="2">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="SystemStatusText" ValueDependency="SS_IsActive,SS_ERPSystemStatusID">
                                    <DefaultFormulaValue>
                                        <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.getSystemStatus()]]>
                                    </DefaultFormulaValue>
                                </DataBinding>
                            </TextEditor>
                            <TextEditor Key="UserStatusText" Caption="用户状态" LabelType="M" X="2" Y="1" Visible="true" Enable="false" CopyNew="false">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="UserStatusText" ValueDependency="US_ERPUserStatusID,US_IsActive,OrderTypeID,WU_ERPUserStatusID,WU_IsActive">
                                    <DefaultFormulaValue>
                                        <![CDATA[com.bokesoft.erp.basis.status.StatusFormula.getUserStatusLineHead('ORI')]]>
                                    </DefaultFormulaValue>
                                </DataBinding>
                            </TextEditor>
                            <RowDefCollection RowGap="24">
                                <RowDef Height="32px"/>
                                <RowDef Height="32px"/>
                            </RowDefCollection>
                            <ColumnDefCollection ColumnGap="16">
                                <ColumnDef Width="15%"/>
                                <ColumnDef Width="15%"/>
                                <ColumnDef Width="15%"/>
                                <ColumnDef Width="15%"/>
                                <ColumnDef Width="40%"/>
                            </ColumnDefCollection>
                        </GridLayoutPanel>
                        <FlexFlowLayoutPanel Key="BodySystem" Caption="系统信息" Padding="8px">
                            <Embed Key="BodySystemEmbed" FormKey="BodySystemEntityForm" RootKey="SystemInfoPanel">
                                <Var Key="SystemInfoTableKey" Value="EPM_MaintenanceOrderHead"/>
                            </Embed>
                        </FlexFlowLayoutPanel>
                        <FlexGridLayoutPanel Key="HiddenInformation" Caption="隐藏信息" ColumnCount="3" ColumnGap="16" OverflowY="Auto" RowGap="24" Visible="false">
                            <Dict Key="ReservationSOID" Caption="预留" LabelType="M" X="0" Y="0" Visible="true" ItemKey="MM_Reservation__Dic" StateMask="Enable|Disable|Discard">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="ReservationSOID"/>
                            </Dict>
                            <TextEditor Key="ReservationDocNo" Caption="预留编号" X="0" Y="1" Visible="true" MaxLength="100" Trim="true">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="ReservationDocNo"/>
                            </TextEditor>
                            <Dict Key="CatalogProfileID" Caption="类别参数文件" LabelType="M" X="1" Y="0" Visible="true" Enable="false" ItemKey="QM_CatalogProfile">
                                <DataBinding TableKey="EPM_MaintOrder_NotificationData" ColumnKey="CatalogProfileID"/>
                            </Dict>
                            <Dict Key="CurrencyID" Caption="币种" LabelType="M" X="1" Y="0" ItemKey="Currency">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="CurrencyID">
                                    <DefaultFormulaValue>
                                        <![CDATA[GetDictValue('CompanyCode', OrgCompanyCodeID, 'CurrencyID')]]>
                                    </DefaultFormulaValue>
                                </DataBinding>
                            </Dict>
                            <CheckBox Key="IsRefurbishment" Caption="刷新订单" LabelType="L" X="2" Y="0" Visible="true">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="IsRefurbishment"/>
                            </CheckBox>
                            <CheckBox Key="IsStatusInit" Caption="状态已初始化" LabelType="M" X="3" Y="7" Visible="true">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="IsStatusInit" DefaultFormulaValue="IIF(IsNew(), 0, 1)"/>
                            </CheckBox>
                            <Dict Key="RoutingID" Caption="工艺路线ID" X="1" Y="1" Visible="true" Enable="false" ItemKey="PP_Routing">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="RoutingID">
                                    <ValueChanged>
                                        <![CDATA[if (GetDictValue('PM_OrderType', OrderTypeID, 'IsRefurbishment')==1) {
                                                Macro_RoutingID_Trigger(0);
                                            } else {
                                                ConfirmMsg('PM_MAINTENANCEORDER002', '是否应删除工序？', {}, 'YES_NO', {
                                                    NO: {
                                                        Macro_RoutingID_Trigger(0);
                                                    },
                                                    YES: {
                                                        Macro_RoutingID_Trigger(1);
                                                    }
                                                });
                                                return 0;
                                            }]]>
                                    </ValueChanged>
                                </DataBinding>
                            </Dict>
                            <Dict Key="InspectionLotSOID" Caption="检验批" LabelType="M" X="3" Y="1" Visible="true" Enable="false" ItemKey="QM_InspectionLot__Dic" StateMask="Enable|Disable|Discard">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="InspectionLotSOID"/>
                            </Dict>
                            <Dict Key="TCodeID" Caption="TCodeID" X="3" Y="0" Visible="true" ItemKey="TCode">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="TCodeID"/>
                            </Dict>
                            <ComboBox Key="ATPStatus" Caption="ATPStatus" X="0" Y="2" Visible="true" SourceType="ParaGroup" GroupKey="ATPStatus" IntegerValue="true">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="ATPStatus" DefaultValue="0" ValueChanged="Macro_ATPStatus_Trigger();"/>
                            </ComboBox>
                            <ComboBox Key="MaintProcessingPhase" Caption="维修处理阶段" LabelType="M" X="0" Y="2" Visible="true" IntegerValue="true">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="MaintProcessingPhase" DefaultValue="0"/>
                                <Item Key="0" Caption="outstanding" Value="0"/>
                                <Item Key="1" Caption="postponed (currently not used)" Value="1"/>
                                <Item Key="2" Caption="released" Value="2"/>
                                <Item Key="3" Caption="Technically completed" Value="3"/>
                                <Item Key="4" Caption="manual deletion indicator set" Value="4"/>
                                <Item Key="5" Caption="historical order" Value="5"/>
                                <Item Key="6" Caption="completed for business" Value="6"/>
                            </ComboBox>
                            <ComboBox Key="SpecialIdentity" Caption="特殊库存" LabelType="S" X="1" Y="2" Visible="SaleOrderDtlOID&gt;0" Enable="false" SourceType="ParaGroup" GroupKey="SpecialIdentity">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="SpecialIdentity">
                                    <DefaultFormulaValue>
                                        <![CDATA[IIF(AccountAssignmentCategoryID>0,GetDictValue('AccountAssignmentCategory', AccountAssignmentCategoryID, 'SpecialIdentity'),'_')]]>
                                    </DefaultFormulaValue>
                                </DataBinding>
                            </ComboBox>
                            <Dict Key="AccountAssignmentCategoryID" Caption="科目分配类别" LabelType="M" X="3" Y="2" Visible="false" ItemKey="AccountAssignmentCategory">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="AccountAssignmentCategoryID">
                                    <DefaultFormulaValue>
                                        <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.getAccountAssignmentCategoryID(SaleOrderDtlOID)]]>
                                    </DefaultFormulaValue>
                                </DataBinding>
                                <ItemFilter>
                                    <Filter Key="Filter" Impl="com.bokesoft.yes.erp.condition.Filter" Type="Custom">
                                        <FilterValue Index="1" ParaValue="&quot;SpecialIdentity=&quot;&amp;SqlPara('E')&amp;&quot; Or SpecialIdentity=&quot;&amp;SqlPara('Q')"/>
                                    </Filter>
                                </ItemFilter>
                            </Dict>
                            <Dict Key="NotificationTypeID" Caption="通知类型" LabelType="M" X="0" Y="3" Visible="true" ItemKey="QM_NotificationType">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="NotificationTypeID"/>
                            </Dict>
                            <Dict Key="PriorityTypeID" Caption="优先级类型" LabelType="M" X="3" Y="3" Visible="true" ItemKey="QM_PriorityType" StateMask="Enable|Disable|Discard">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="PriorityTypeID">
                                    <DefaultFormulaValue>
                                        <![CDATA[GetDictValue('PM_OrderType', OrderTypeID, 'PriorityTypeID')]]>
                                    </DefaultFormulaValue>
                                </DataBinding>
                            </Dict>
                            <TextEditor Key="ATPMsg" Caption="ATPMsg" X="3" Y="4" Visible="false">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="ATPMsg"/>
                            </TextEditor>
                            <UTCDatePicker Key="SystemStatusTECODate" Caption="技术性完成日期" LabelType="M" X="1" Y="5">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="SystemStatusTECODate"/>
                            </UTCDatePicker>
                            <CheckBox Key="IsReleased" Caption="已下达" LabelType="M" X="0" Y="5">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="IsReleased"/>
                            </CheckBox>
                            <Dict Key="InspectionTypeID" Caption="检验类型" LabelType="M" X="3" Y="1" ItemKey="QM_InspectionType">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="InspectionTypeID">
                                    <DefaultFormulaValue>
                                        <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.getInspectionTypeID(PlanningPlantID,OrderTypeID)]]>
                                    </DefaultFormulaValue>
                                </DataBinding>
                            </Dict>
                            <UTCDatePicker Key="ReleasedDate" Caption="下达日期" LabelType="M" X="0" Y="6">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="ReleasedDate"/>
                            </UTCDatePicker>
                            <ComboBox Key="EstimInputControl" Caption="估算输入控制" LabelType="M" X="1" Y="6" Cache="false">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="EstimInputControl" DefaultValue="_"/>
                                <Item Key="_" Caption="无" Value="_"/>
                                <Item Key="Total" Caption="总计输入" Value="Total"/>
                                <Item Key="Dtl" Caption="明细输入" Value="Dtl"/>
                            </ComboBox>
                            <NumberEditor Key="SrcOID" Caption="SrcOID" X="0" Y="7">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="SrcOID"/>
                                <Format HAlign="Right"/>
                            </NumberEditor>
                            <NumberEditor Key="SrcSOID" Caption="SrcSOID" X="1" Y="7">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="SrcSOID"/>
                                <Format HAlign="Right"/>
                            </NumberEditor>
                            <TextEditor Key="SrcFormKey" Caption="SrcFormKey" X="3" Y="6">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="SrcFormKey"/>
                            </TextEditor>
                        </FlexGridLayoutPanel>
                    </TabPanel>
                    <TabPanel Key="DownTabPanel">
                        <FlexFlowLayoutPanel Key="HeadingDataFlexFlowLayoutPanel" Caption="抬头数据" OverflowY="Auto">
                            <GridLayoutPanel Key="ParentOrderGridLayoutPanel" Caption="上级订单Panel" Padding="8px" Visible="ParentOrderSOID&gt;0" TopPadding="24px">
                                <Dict Key="ParentOrderSOID" Caption="上级订单" LabelType="M" X="0" Y="0" Enable="false" ItemKey="PM_MaintenanceOrder__Dic" StateMask="Enable|Disable|Discard">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="ParentOrderSOID"/>
                                </Dict>
                                <Dict Key="LeadingOrderSOID" Caption="主订单" X="1" Y="0" Visible="false" ItemKey="PM_MaintenanceOrder__Dic" StateMask="Enable|Disable|Discard">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="LeadingOrderSOID" DefaultFormulaValue="GetOID()"/>
                                </Dict>
                                <RowDefCollection RowHeight="30" RowGap="24">
                                    <RowDef Height="32px"/>
                                </RowDefCollection>
                                <ColumnDefCollection ColumnGap="16">
                                    <ColumnDef Width="130px"/>
                                    <ColumnDef Width="130px"/>
                                    <ColumnDef Width="15%"/>
                                    <ColumnDef Width="5%"/>
                                    <ColumnDef Width="80%"/>
                                </ColumnDefCollection>
                            </GridLayoutPanel>
                            <GridLayoutPanel Key="GeneralUp" Padding="8px" OverflowY="Auto" TopPadding="24px">
                                <Label Key="PersonResponsibleTag" Caption="负责人" X="0" Y="0" Visible="true" Enable="false" Class="erp-group-title" XSpan="2"/>
                                <Label Key="Label_General_Normal" Caption="其它" X="2" Y="0" Visible="true" Enable="false" Class="erp-group-title" XSpan="2"/>
                                <Label Key="FirstOperationLab" Caption="第一道工序" X="4" Y="0" Visible="true" Enable="false" Class="erp-group-title" XSpan="3"/>
                                <Dict Key="PlannerGroupID" Caption="计划员组" LabelType="S" X="0" Y="1" Visible="true" ItemKey="PM_PlannerGroup">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="PlannerGroupID"/>
                                    <ItemFilter ItemKey="PM_PlannerGroup">
                                        <Filter Key="Filter" Impl="com.bokesoft.yes.erp.condition.Filter" Type="Custom">
                                            <FilterValue Index="1" ParaValue="'PlantID = '&amp;SqlPara(PlanningPlantID)"/>
                                        </Filter>
                                    </ItemFilter>
                                </Dict>
                                <Dict Key="PlanningPlantID" Caption="计划员组工厂" X="1" Y="1" Visible="true" Enable="false" ItemKey="Plant">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="PlanningPlantID"/>
                                </Dict>
                                <Dict Key="NotificationSOID" Caption="通知" X="2" Y="1" Visible="false" Enable="false" ItemKey="PM_Notification__Dic" StateMask="Enable|Disable|Discard" XSpan="2">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="NotificationSOID"/>
                                </Dict>
                                <TextEditor Key="NotificationDocNo" Caption="通知单" X="2" Y="1" Visible="true" Enable="false" MaxLength="50" Trim="true">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="NotificationDocNo"/>
                                </TextEditor>
                                <Button Key="NotificationLinkBtn" Caption=".." X="3" Y="1" Visible="NotificationSOID &gt; 0" Enable="true" Type="Normal">
                                    <OnClick>
                                        <![CDATA[IIF(NotificationSOID > 0, ERPShowModal('PM_Notification',GetCallFormula('Macro_OpenBill_ShowEvent',NotificationSOID),'newTab'),'')]]>
                                    </OnClick>
                                </Button>
                                <Button Key="PushToNotification" Caption="下推维护通知" X="3" Y="1" Visible="ReadOnly()&amp;&amp;NotificationDocNo==''" Enable="ReadOnly()&amp;&amp;!Macro_IsCompleted()" Type="Normal">
                                    <OnClick>
                                        <![CDATA[UICheck();ERPShowModal('PM_CreateNotification',GetCallFormula('Macro_PM_MaintenanceOrder_ShowEvent',SOID));]]>
                                    </OnClick>
                                </Button>
                                <TextEditor Key="FirstOperation" Caption="工序" LabelType="M" X="4" Y="1" Visible="true" MaxLength="100" Trim="true" XSpan="3">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="FirstOperation" Required="true">
                                        <ValueChanged>
                                            <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.setFirstOperation('FirstOperation');]]>
                                        </ValueChanged>
                                    </DataBinding>
                                </TextEditor>
                                <Dict Key="MainWorkCenterID" Caption="主工作中心" LabelType="M" X="0" Y="2" Visible="true" ItemKey="WorkCenter">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="MainWorkCenterID" Required="true">
                                        <CheckRule>
                                            <![CDATA[Macro_CheckWorkCenter(MainWorkCenterID,MainWorkCenterPlantID)]]>
                                        </CheckRule>
                                    </DataBinding>
                                </Dict>
                                <Dict Key="MainWorkCenterPlantID" Caption="主工作中心工厂" LabelType="M" X="1" Y="2" Visible="true" ItemKey="Plant">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="MainWorkCenterPlantID">
                                        <CheckRule>
                                            <![CDATA[Macro_CheckControllingArea(PlanningPlantID,MainWorkCenterPlantID,false)]]>
                                        </CheckRule>
                                        <DefaultFormulaValue>
                                            <![CDATA[GetDictValue('WorkCenter', MainWorkCenterID, 'PlantID')]]>
                                        </DefaultFormulaValue>
                                    </DataBinding>
                                </Dict>
                                <Dict Key="MaintenanceActivityTypeID" Caption="PM作业类型" LabelType="S" X="2" Y="2" Visible="true" ItemKey="PM_MaintenanceActivityType" XSpan="2">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="MaintenanceActivityTypeID">
                                        <ValueChanged>
                                            <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.checkMaintenanceActivityType(OrderTypeID, MaintenanceActivityTypeID)]]>
                                        </ValueChanged>
                                        <DefaultFormulaValue>
                                            <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.setMaintenanceActivityTypeID(OrderTypeID)]]>
                                        </DefaultFormulaValue>
                                    </DataBinding>
                                </Dict>
                                <Dict Key="FirstWorkCenterID" Caption="工作中心" LabelType="M" X="4" Y="2" Visible="true" ItemKey="WorkCenter" XSpan="2">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="FirstWorkCenterID">
                                        <ValueChanged>
                                            <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.setFirstOperation('FirstWorkCenterID');]]>
                                        </ValueChanged>
                                        <DefaultFormulaValue>
                                            <![CDATA[IIF(FirstWorkCenterID<=0,MainWorkCenterID,FirstWorkCenterID)]]>
                                        </DefaultFormulaValue>
                                    </DataBinding>
                                    <ItemFilter ItemKey="WorkCenter">
                                        <Filter Key="Filter" Impl="com.bokesoft.yes.erp.condition.Filter" Type="Custom">
                                            <FilterValue Index="1" ParaValue="IIF(FirstWorkCenterPlantID&gt;0, ' BK_WorkCenter.PlantID='&amp;SqlPara(FirstWorkCenterPlantID), '1=2')"/>
                                        </Filter>
                                    </ItemFilter>
                                </Dict>
                                <Dict Key="FirstWorkCenterPlantID" Caption="工作中心工厂" LabelType="M" X="6" Y="2" Visible="true" ItemKey="Plant">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="FirstWorkCenterPlantID">
                                        <ValueChanged>
                                            <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.setFirstOperation('FirstWorkCenterPlantID');]]>
                                        </ValueChanged>
                                        <CheckRule>
                                            <![CDATA[IIF(FirstWorkCenterPlantID>0&&GetDictValue('Plant', FirstWorkCenterPlantID, 'CompanyCodeID')!=GetDictValue('Plant', PlanningPlantID, 'CompanyCodeID'),MessageFacade('IW031','计划工厂的成本结算区域与工作中心工厂不是同一个'),true)]]>
                                        </CheckRule>
                                    </DataBinding>
                                </Dict>
                                <Dict Key="ResponsibleOperatorID" Caption="负责人" LabelType="M" X="0" Y="3" Visible="true" ItemKey="Operator" XSpan="2">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="ResponsibleOperatorID"/>
                                </Dict>
                                <Dict Key="OperatingConditionID" Caption="系统条件" LabelType="M" X="2" Y="3" ItemKey="PM_OperatingCondition" XSpan="2">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="OperatingConditionID"/>
                                </Dict>
                                <Dict Key="FirstControlCodeID" Caption="控制码" LabelType="M" X="4" Y="3" Visible="true" ItemKey="PP_ControlCode" XSpan="2">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="FirstControlCodeID" Required="true">
                                        <ValueChanged>
                                            <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.setFirstOperation('FirstControlCodeID');]]>
                                        </ValueChanged>
                                        <DefaultFormulaValue>
                                            <![CDATA[IIF(FirstControlCodeID<=0,com.bokesoft.erp.pm.function.MaintenanceOrderFormula.getDefaultControlCodeID(PlanningPlantID,OrderTypeID,MainWorkCenterID),FirstControlCodeID)]]>
                                        </DefaultFormulaValue>
                                    </DataBinding>
                                    <ItemFilter>
                                        <Filter Key="Filter" Impl="com.bokesoft.yes.erp.condition.Filter" Type="Custom">
                                            <FilterValue Index="1" ParaValue="&quot;(UseModel=&quot;&amp;SqlPara('PM')&amp;&quot; or soid in (select controlcodeid from bk_workcenter where soid = &quot;&amp;SqlPara(FirstWorkCenterID)&amp;&quot;))&quot;"/>
                                        </Filter>
                                    </ItemFilter>
                                </Dict>
                                <Label Key="DateTag" Caption="日期" X="0" Y="4" Visible="true" Enable="false" Class="erp-group-title" XSpan="2"/>
                                <Label Key="ReferenceTag" Caption="参考对象" X="2" Y="4" Visible="true" Enable="false" Class="erp-group-title" XSpan="2"/>
                                <Dict Key="FirstActivityTypeID" Caption="作业类型" LabelType="M" X="4" Y="4" Visible="true" ItemKey="CO_ActivityType" XSpan="2">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="FirstActivityTypeID">
                                        <ValueChanged>
                                            <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.setFirstOperation('FirstActivityTypeID');]]>
                                        </ValueChanged>
                                        <DefaultFormulaValue>
                                            <![CDATA[IIF(FirstActivityTypeID>0,FirstActivityTypeID,com.bokesoft.erp.pm.function.MaintenanceOrderFormula.getActivityTypeIDByWorkCenterID(FirstWorkCenterID))]]>
                                        </DefaultFormulaValue>
                                    </DataBinding>
                                    <ItemFilter>
                                        <Filter Key="Filter" Impl="com.bokesoft.yes.erp.condition.Filter" Type="Custom">
                                            <FilterValue Index="1" ParaValue="IIF(FirstWorkCenterID &gt; 0,Macro_ActivityTypeFilter(FirstWorkCenterID,BasicStartDate),' 1 = 2 ')"/>
                                        </Filter>
                                    </ItemFilter>
                                </Dict>
                                <ComboBox Key="FirstCalculationKey" Caption="计算规则" LabelType="M" X="6" Y="4" Visible="true" SourceType="ParaGroup" IntegerValue="true" GroupKey="CalculationKey">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="FirstCalculationKey">
                                        <ValueChanged>
                                            <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.setFirstOperation('FirstCalculationKey');]]>
                                        </ValueChanged>
                                    </DataBinding>
                                </ComboBox>
                                <UTCDatePicker Key="BasicStartDate" Caption="基本开始" X="0" Y="5" Visible="true" Format="yyyy-MM-dd">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="BasicStartDate" DefaultFormulaValue="DateLong()">
                                        <ValueChanged>
                                            <![CDATA[
                                            if (BasicStartDate <= 0) {
                                                if (Macro_GetScheduleTypeField('IsCurrentDate') == 1) {
                                                    SetValue('BasicStartDate', DateLong());
                                                    ConfirmMsg('IW429', '基本开始日期设置为当前日期');
                                                } else {
                                                    RaiseErrMsg('PM_MAINTENANCEORDER003', '基本开始日期不允许为空');
                                                }
                                            }]]>
                                        </ValueChanged>
                                        <CheckRule>
                                            <![CDATA[IIF(BasicStartDate <= 0 && Macro_GetScheduleTypeField('IsBackward') != 1, MessageFacade('IW426','计划类型不是向后排产, 请输入基本开始日期'), true);IIF(Macro_ToDateTime(BasicStartDate,  BasicStartTime)>Macro_ToDateTime(BasicEndDate, BasicEndTime)&&BasicStartDate>0&&BasicEndDate>0, MessageFacade('PEP258','结束时间发生在开始时间之前'), true);]]>
                                        </CheckRule>
                                    </DataBinding>
                                </UTCDatePicker>
                                <TimePicker Key="BasicStartTime" Caption="基本开始时间" LabelType="M" Second="true" Visible="Macro_GetScheduleTypeField('IsContainTime') == 1" X="1" Y="5">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="BasicStartTime" DefaultFormulaValue="'000000'">
                                        <CheckRule>
                                            <![CDATA[IIF(Macro_ToDateTime(BasicStartDate,  BasicStartTime)>Macro_ToDateTime(BasicEndDate, BasicEndTime)&&BasicStartDate>0&&BasicEndDate>0, MessageFacade('PEP258','结束时间发生在开始时间之前'), true);]]>
                                        </CheckRule>
                                    </DataBinding>
                                </TimePicker>
                                <Dict Key="FunctionalLocationSOID" Caption="功能位置" LabelType="M" X="2" Y="5" Visible="!IsRefurbishment" Enable="!ReadOnly()&amp;&amp;EquipmentSOID&lt;=0" ItemKey="PM_FunctionalLocation__Dic" StateMask="Enable|Disable|Discard">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="FunctionalLocationSOID">
                                        <ValueChanged>
                                            <![CDATA[if (EquipmentSOID <= 0){
                                            com.bokesoft.erp.pm.function.MaintenanceOrderFormula.setPMOrderDefine();
                                            Macro_AutoDisplayObjectInfo(EquipmentSOID, FunctionalLocationSOID, GetDictValue('PM_OrderType', OrderTypeID, 'ObjectInfoParameterID'));
                                            }]]>
                                        </ValueChanged>
                                        <CheckRule>
                                            <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.checkAvailable(false, FunctionalLocationSOID)]]>
                                        </CheckRule>
                                    </DataBinding>
                                </Dict>
                                <Dict Key="MaterialID" Caption="物料" LabelType="M" X="2" Y="5" Visible="IsRefurbishment" Enable="IsRefurbishment &amp;&amp; MaterialID &lt;= 0" ItemKey="Material">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="MaterialID">
                                        <ValueChanged>
                                            <![CDATA[IIF(IsRefurbishment,com.bokesoft.erp.pm.function.MaintenanceOrderFormula.setRefurbishmentBOM())]]>
                                        </ValueChanged>
                                        <DefaultFormulaValue>
                                            <![CDATA[IIF(!IsRefurbishment && EquipmentSOID>0,GetDictValue('PM_Equipment__Dic', EquipmentSOID, 'MaterialID'),MaterialID)]]>
                                        </DefaultFormulaValue>
                                    </DataBinding>
                                </Dict>
                                <Button Key="ObjectInfoBtn" Caption="对象信息" X="3" Y="5" Enable="true" Type="Normal">
                                    <OnClick>
                                        <![CDATA[Macro_ShowObjectInformation(EquipmentSOID,FunctionalLocationSOID,GetDictValue('PM_OrderType',OrderTypeID,'ObjectInfoParameterID'))]]>
                                    </OnClick>
                                </Button>
                                <NumberEditor Key="FirstProcessWorkTime" Caption="工作量" LabelType="M" X="4" Y="5" Visible="true" Enable="!ReadOnly()&amp;&amp;!Macro_IsExternal()" Scale="3">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="FirstProcessWorkTime">
                                        <ValueChanged>
                                            <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.setFirstOperation('FirstProcessWorkTime');]]>
                                        </ValueChanged>
                                    </DataBinding>
                                </NumberEditor>
                                <Dict Key="FirstProcessWorkTimeUnitID" Caption="单位" LabelType="M" X="5" Y="5" Visible="true" Enable="!ReadOnly()&amp;&amp;!Macro_IsExternal()" ItemKey="Unit">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="FirstProcessWorkTimeUnitID">
                                        <ValueChanged>
                                            <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.setFirstOperation('FirstProcessWorkTimeUnitID');]]>
                                        </ValueChanged>
                                        <DefaultFormulaValue>
                                            <![CDATA[com.bokesoft.erp.pm.function.RoutingFormula.getDefaultUnitID(FirstWorkCenterPlantID, 2)]]>
                                        </DefaultFormulaValue>
                                    </DataBinding>
                                    <ItemFilter>
                                        <Filter Key="Filter" Impl="com.bokesoft.yes.erp.condition.Filter" Type="Custom">
                                            <FilterValue Index="1" ParaValue="'soid in (SELECT soid FROM BK_Unit WHERE UnitSystemID IN (SELECT soid FROM BK_UnitSystem WHERE UnitTime = '&amp;SqlPara(1)&amp;'))'"/>
                                        </Filter>
                                    </ItemFilter>
                                </Dict>
                                <CheckBox Key="IsFirstComponent" Caption="组件" LabelType="M" X="6" Y="5" Visible="true" Enable="false">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="IsFirstComponent">
                                        <ValueChanged>
                                            <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.setFirstOperation('IsFirstComponent');]]>
                                        </ValueChanged>
                                    </DataBinding>
                                </CheckBox>
                                <UTCDatePicker Key="BasicEndDate" Caption="基本完成" X="0" Y="6" Visible="true" Format="yyyy-MM-dd">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="BasicEndDate">
                                        <CheckRule>
                                            <![CDATA[IIFS(BasicStartDate > 0 && BasicEndDate > 0 && BasicEndDate < BasicStartDate, MessageFacade('IW430','基本完成日期不能早于基本开始日期'), BasicEndDate <= 0 && Macro_GetScheduleTypeField('IsForward') != 1, MessageFacade('IW427','计划类型不是向前排产, 请输入基本结束日期'));IIF(Macro_ToDateTime(BasicStartDate,  BasicStartTime)>Macro_ToDateTime(BasicEndDate, BasicEndTime)&&BasicStartDate>0&&BasicEndDate>0, MessageFacade('PEP258','结束时间发生在开始时间之前'), true);]]>
                                        </CheckRule>
                                        <DefaultFormulaValue>
                                            <![CDATA[IIF(GetDictValue('Plant', PlanningPlantID, 'IsToday2BasicDate') == 1, DateLong(), BasicEndDate)]]>
                                        </DefaultFormulaValue>
                                    </DataBinding>
                                </UTCDatePicker>
                                <TimePicker Key="BasicEndTime" Caption="基本完成时间" LabelType="M" Second="true" Visible="Macro_GetScheduleTypeField('IsContainTime') == 1" X="1" Y="6">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="BasicEndTime" DefaultFormulaValue="'000000'">
                                        <CheckRule>
                                            <![CDATA[IIF(Macro_ToDateTime(BasicStartDate,  BasicStartTime)>Macro_ToDateTime(BasicEndDate, BasicEndTime)&&BasicStartDate>0&&BasicEndDate>0, MessageFacade('PEP258','结束时间发生在开始时间之前'), true);]]>
                                        </CheckRule>
                                    </DataBinding>
                                </TimePicker>
                                <Dict Key="EquipmentSOID" Caption="设备" LabelType="M" X="2" Y="6" Visible="true" Enable="!ReadOnly()&amp;&amp;!IsRefurbishment" ItemKey="PM_Equipment__Dic" StateMask="Enable|Disable|Discard">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="EquipmentSOID">
                                        <ValueChanged>
                                            <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.setPMOrderDefine();
                                            if (EquipmentSOID > 0) {
                                                Macro_AutoDisplayObjectInfo(EquipmentSOID, FunctionalLocationSOID, GetDictValue('PM_OrderType', OrderTypeID, 'ObjectInfoParameterID'))
                                            }]]>
                                        </ValueChanged>
                                        <CheckRule>
                                            <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.checkAvailable(true, EquipmentSOID)]]>
                                        </CheckRule>
                                    </DataBinding>
                                </Dict>
                                <Button Key="Btn" Caption=".." X="3" Y="6" Visible="!IsRefurbishment" Type="Normal">
                                    <OnClick>
                                        <![CDATA[IIF(TreeID<=0,ConfirmMsg('IM017', '在进行装配选择之前必须输入设备', {}, 'OK'),ERPShowModal('PM_FuncStructuralDisplay',GetCallFormula('Macro_PM_Notification_ShowEvent',EquipmentSOID,FunctionalLocationSOID),'newtab'));]]>
                                    </OnClick>
                                </Button>
                                <NumberEditor Key="FirstProcessDuration" Caption="工序持续时间" LabelType="M" X="4" Y="6" Enable="!ReadOnly()&amp;&amp;!Macro_IsExternal()" Scale="3">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="FirstProcessDuration">
                                        <ValueChanged>
                                            <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.setFirstOperation('FirstProcessDuration');]]>
                                        </ValueChanged>
                                    </DataBinding>
                                </NumberEditor>
                                <Dict Key="FirstProcessDurationUnitID" Caption="单位" LabelType="M" X="5" Y="6" Enable="!ReadOnly()&amp;&amp;!Macro_IsExternal()" ItemKey="Unit">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="FirstProcessDurationUnitID">
                                        <ValueChanged>
                                            <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.setFirstOperation('FirstProcessDurationUnitID');]]>
                                        </ValueChanged>
                                        <DefaultFormulaValue>
                                            <![CDATA[com.bokesoft.erp.pm.function.RoutingFormula.getDefaultUnitID(FirstWorkCenterPlantID, 1)]]>
                                        </DefaultFormulaValue>
                                    </DataBinding>
                                </Dict>
                                <Dict Key="PriorityID" Caption="优先级" LabelType="M" X="0" Y="7" Visible="true" ItemKey="QM_Priority__Dic" StateMask="Enable|Disable|Discard">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="PriorityID"/>
                                    <ItemFilter ItemKey="QM_Priority__Dic">
                                        <Filter Key="Filter" Impl="com.bokesoft.yes.erp.condition.Filter" Type="Custom">
                                            <FilterValue Index="1" ParaValue="'PriorityTypeID = '&amp;SqlPara(PriorityTypeID)"/>
                                        </Filter>
                                    </ItemFilter>
                                </Dict>
                                <Dict Key="RevisionID" Caption="修正" LabelType="M" X="1" Y="7" ItemKey="PM_Revision">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="RevisionID">
                                        <ValueChangeAction>
                                            <![CDATA[Macro_SetBasicDateTimeByRevisionID(RevisionID);IIFS(GetDictValue('PM_Revision', RevisionID, 'IsRevisionCompleted')>0, ConfirmMsg('IW655','修订{1}已被完成',{{GetDictValue('PM_Revision', RevisionID, 'UseCode')}}))]]>
                                        </ValueChangeAction>
                                    </DataBinding>
                                    <ItemFilter>
                                        <Filter Key="Filter" Impl="com.bokesoft.yes.erp.condition.Filter" Type="Custom">
                                            <FilterValue Index="1" ParaValue="'PlantID = '&amp;SqlPara(PlanningPlantID)"/>
                                        </Filter>
                                    </ItemFilter>
                                </Dict>
                                <TextEditor Key="UII" Caption="唯一项目标识" LabelType="M" X="2" Y="7" Visible="!IsRefurbishment" MaxLength="100" Trim="true" XSpan="2">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="UII"/>
                                </TextEditor>
                                <TextEditor Key="SerialNumber" Caption="序列号" LabelType="M" X="2" Y="7" Visible="IsRefurbishment" Enable="false" MaxLength="100" Trim="true" XSpan="2">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="SerialNumber">
                                        <DefaultFormulaValue>
                                            <![CDATA[IIF(MaterialID>0,GetDictValue('PM_Equipment__Dic', EquipmentSOID, 'SerialNumber'),'')]]>
                                        </DefaultFormulaValue>
                                    </DataBinding>
                                </TextEditor>
                                <Dict Key="SaleOrderDtlOID" Caption="销售订单-行号" LabelType="M" X="4" Y="7" Visible="IsRefurbishment" ItemKey="SD_SaleOrderDtl__Dic" StateMask="Enable|Disable|Discard">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="SaleOrderDtlOID"/>
                                    <ItemFilter>
                                        <Filter Key="Filter" Impl="com.bokesoft.yes.erp.condition.Filter" Type="Custom">
                                            <FilterValue Index="1" ParaValue="&quot;SpecialIdentity=&quot;&amp;SqlPara('E')"/>
                                        </Filter>
                                    </ItemFilter>
                                </Dict>
                                <Dict Key="DivisionID" Caption="产品部门" LabelType="M" X="5" Y="7" Visible="IsRefurbishment" ItemKey="Division">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="DivisionID" DefaultFormulaValue="GetDictValue('Material', MaterialID, 'DivisionID')"/>
                                </Dict>
                                <TextEditor Key="TreeID" Caption="TreeID" X="0" Y="0" Visible="Macro_DebugMode()" MaxLength="100" Trim="true">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="TreeID">
                                        <DefaultFormulaValue>
                                            <![CDATA[IIF(EquipmentSOID>0,EquipmentSOID,FunctionalLocationSOID)]]>
                                        </DefaultFormulaValue>
                                    </DataBinding>
                                </TextEditor>
                                <RowDefCollection RowGap="24">
                                    <RowDef Height="32px"/>
                                    <RowDef Height="32px"/>
                                    <RowDef Height="32px"/>
                                    <RowDef Height="32px"/>
                                    <RowDef Height="32px"/>
                                    <RowDef Height="32px"/>
                                    <RowDef Height="32px"/>
                                    <RowDef Height="32px"/>
                                </RowDefCollection>
                                <ColumnDefCollection ColumnGap="16">
                                    <ColumnDef Width="15%"/>
                                    <ColumnDef Width="14%"/>
                                    <ColumnDef Width="14%"/>
                                    <ColumnDef Width="14%"/>
                                    <ColumnDef Width="14%"/>
                                    <ColumnDef Width="14%"/>
                                    <ColumnDef Width="15%"/>
                                </ColumnDefCollection>
                            </GridLayoutPanel>
                            <GridLayoutPanel Key="HeadingDataGridLayoutPanel" Caption="抬头数据" Padding="8px" OverflowY="Auto" Visible="true">
                                <UTCDatePicker Key="ReferenceDate" Caption="参考日期" LabelType="M" X="0" Y="5" Enable="false">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="ReferenceDate">
                                        <DefaultFormulaValue>
                                            <![CDATA[IIF(SystemStatusTECODate>0,SystemStatusTECODate,BasicStartDate)]]>
                                        </DefaultFormulaValue>
                                    </DataBinding>
                                </UTCDatePicker>
                                <TimePicker Key="ReferenceTime" Caption="参考时间" LabelType="M" Second="true" Visible="false" X="1" Y="5">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="ReferenceTime"/>
                                </TimePicker>
                                <Dict Key="SchedulingTypeID" Caption="计划类型" LabelType="M" X="2" Y="1" ItemKey="PP_SchedulingType">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="SchedulingTypeID">
                                        <ValueChanged>
                                            <![CDATA[IIF(Macro_GetScheduleTypeField('IsCurrentDate') == 1, SetValue('BasicStartDate', DateLong()), true)]]>
                                        </ValueChanged>
                                        <DefaultFormulaValue>
                                            <![CDATA[Macro_GetSchedulePara(SchedulingTypeID, 'SchedulingTypeID');]]>
                                        </DefaultFormulaValue>
                                    </DataBinding>
                                </Dict>
                                <CheckBox Key="IsAutoSchedule" Caption="自动计划" LabelType="M" X="3" Y="3">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="IsAutoSchedule">
                                        <DefaultFormulaValue>
                                            <![CDATA[Macro_GetSchedulePara(IsAutoSchedule, 'IsAutomaticScheduling');]]>
                                        </DefaultFormulaValue>
                                    </DataBinding>
                                </CheckBox>
                                <NumberEditor Key="StartInPastDay" Caption="过去开始天数" LabelType="M" X="2" Y="2" Visible="true" Enable="false" IntegerValue="true" Precision="9" Scale="0" UseGroupingSeparator="false">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="StartInPastDay">
                                        <DefaultFormulaValue>
                                            <![CDATA[Macro_GetSchedulePara(StartInPastDay, 'StartInPastDays');]]>
                                        </DefaultFormulaValue>
                                    </DataBinding>
                                </NumberEditor>
                                <UTCDatePicker Key="ScheduleStartDate" Caption="排产/计划开始" X="0" Y="1" Enable="false">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="ScheduleStartDate"/>
                                </UTCDatePicker>
                                <TimePicker Key="ScheduleStartTime" Caption="排产/计划开始时间" LabelType="M" Enable="false" Format="HH:mm" X="1" Y="1">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="ScheduleStartTime"/>
                                </TimePicker>
                                <!--                                <UTCDatePicker Caption="实际开始" Enable="false" Key="PRT_ActualStartDate" X="0" Y="3">-->
                                <!--                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="PRT_ActualStartDate"/>-->
                                <!--                                </UTCDatePicker>-->
                                <!--                                <TimePicker Caption="实际开始时间" Enable="false" Format="HH:mm" Key="PRT_ActualStartTime" X="1" Y="3">-->
                                <!--                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="PRT_ActualStartTime"/>-->
                                <!--                                </TimePicker>-->
                                <UTCDatePicker Key="ScheduleEndDate" Caption="排产/计划结束" X="0" Y="2" Enable="false">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="ScheduleEndDate"/>
                                </UTCDatePicker>
                                <TimePicker Key="ScheduleEndTime" Caption="排产/计划结束时间" LabelType="M" Enable="false" Format="HH:mm" X="1" Y="2">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="ScheduleEndTime"/>
                                </TimePicker>
                                <UTCDatePicker Key="ActualEndDate" Caption="实际结束" X="0" Y="4" Enable="false">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="ActualEndDate"/>
                                </UTCDatePicker>
                                <TimePicker Key="ActualEndTime" Caption="实际结束时间" LabelType="M" Enable="false" Format="HH:mm" X="1" Y="4">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="ActualEndTime"/>
                                </TimePicker>
                                <ComboBox Key="AdjustDate" Caption="调整日期" LabelType="M" X="2" Y="3" Visible="true" Enable="false" SourceType="ParaGroup" IntegerValue="true" GroupKey="AdjustDateControl">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="AdjustDate" DefaultFormulaValue="Macro_GetSchedulePara(AdjustDate, 'AdjustDate');" DefaultValue="0"/>
                                </ComboBox>
                                <CheckBox Key="IsClassesOrder" Caption="班次订单" LabelType="M" X="3" Y="1" Enable="false">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="IsClassesOrder"/>
                                </CheckBox>
                                <CheckBox Key="IsRelationshipData" Caption="关系数据" LabelType="M" X="3" Y="2" Enable="false">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="IsRelationshipData"/>
                                </CheckBox>
                                <CheckBox Key="IsExactInterrupt" Caption="精确的中断" X="3" Y="4">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="IsExactInterrupt"/>
                                </CheckBox>
                                <CheckBox Key="IsCapacityRequire" Caption="能力需求" X="3" Y="5">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="IsCapacityRequire"/>
                                </CheckBox>
                                <Button Key="Schedule" Caption="计划" X="2" Y="4" Type="Normal">
                                    <OnClick>
                                        <![CDATA[Macro_GetScheduleDate()]]>
                                    </OnClick>
                                </Button>
                                <RowDefCollection RowGap="24">
                                    <RowDef Height="32px"/>
                                    <RowDef Height="32px"/>
                                    <RowDef Height="32px"/>
                                    <RowDef Height="32px"/>
                                    <RowDef Height="32px"/>
                                    <RowDef Height="32px"/>
                                    <RowDef Height="32px"/>
                                </RowDefCollection>
                                <ColumnDefCollection ColumnGap="16">
                                    <ColumnDef Width="15%"/>
                                    <ColumnDef Width="14%"/>
                                    <ColumnDef Width="14%"/>
                                    <ColumnDef Width="14%"/>
                                    <ColumnDef Width="14%"/>
                                    <ColumnDef Width="14%"/>
                                    <ColumnDef Width="15%"/>
                                </ColumnDefCollection>
                                <ExtraLayout>
                                    <GroupCollection>
                                        <Group Key="Group_1_5" Caption="详细计划" EndRow="5" Expanded="false" StartRow="1">
                                            <Handle X="0" Y="0"/>
                                        </Group>
                                    </GroupCollection>
                                </ExtraLayout>
                            </GridLayoutPanel>
                        </FlexFlowLayoutPanel>
                        <GridLayoutPanel Key="RefreshDataGridLayoutPanel" Caption="刷新" Padding="8px" OverflowY="Auto" Visible="IsRefurbishment">
                            <NumberEditor Key="TotalQuantity" Caption="总数量" LabelType="M" X="0" Y="2" Visible="true" Scale="3">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="TotalQuantity" DefaultValue="1">
                                    <ValueChanged>
                                        <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.setFirstBOM('TotalQuantity');]]>
                                    </ValueChanged>
                                    <CheckRule>
                                        <![CDATA[IIF(IsRefurbishment,IIFS((IsNew()||Macro_IsCRTD())&&TotalQuantity<=0, MessageFacade('CO036','请输入总数量'), TotalQuantity<ReceiptQuantity, MessageFacade('CO120','订单数量少于交货数量'), true, true),true)]]>
                                    </CheckRule>
                                </DataBinding>
                            </NumberEditor>
                            <Dict Key="UnitID" Caption="单位" LabelType="M" X="1" Y="2" Visible="true" ItemKey="Unit">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="UnitID" DefaultFormulaValue="GetDictValue('Material', MaterialID, 'BaseUnitID')">
                                    <ValueChanged>
                                        <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.setFirstBOM('BusinessUnitID');]]>
                                    </ValueChanged>
                                    <CheckRule>
                                        <![CDATA[IIF(IsRefurbishment,IIFS(UnitID<=0, MessageFacade('PM_MAINTENANCEORDER004','单位不能为空,请检查物料主数据是否设置业务单位'), UnitID>0&&MaterialID>0&&!com.bokesoft.erp.pp.function.ProductionOrderFormula.businessUnitIDIsValid4Material(MaterialID,UnitID), MessageFacade('PM_MAINTENANCEORDER005','生产单位在物料主数据基本信息视图中没有维护'), true, true),true)]]>
                                    </CheckRule>
                                </DataBinding>
                                <ItemFilter ItemKey="Unit">
                                    <Filter Key="Filter" Impl="com.bokesoft.yes.erp.condition.Filter" Type="Custom">
                                        <FilterValue Index="1" ParaValue="IIF(MaterialID&gt;0,'soid in ('&amp;com.bokesoft.erp.pp.function.ProductionOrderFormula.getUnitID4Material(MaterialID)&amp;')','')"/>
                                    </Filter>
                                </ItemFilter>
                            </Dict>
                            <NumberEditor Key="ReceiptQuantity" Caption="已交货" X="2" Y="2" Visible="true" Enable="false" Scale="3">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="ReceiptQuantity"/>
                            </NumberEditor>
                            <Label Key="Lab_Quantity" Caption="数量" X="0" Y="1" Visible="true" Enable="false" Class="erp-group-title" XSpan="5"/>
                            <Label Key="Lab_Refurbishment" Caption="刷新" X="0" Y="3" Visible="true" Enable="false" Class="erp-group-title" XSpan="5"/>
                            <Dict Key="FromPlantID" Caption="从      工厂" X="0" Y="4" Visible="true" ItemKey="Plant">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="FromPlantID" DefaultFormulaValue="IIF(FromPlantID&lt;=0,ToPlantID,FromPlantID)">
                                    <CheckRule>
                                        <![CDATA[IIF(FromPlantID>0&&GetDictValue('Plant', FromPlantID, 'CompanyCodeID')!=GetDictValue('Plant', PlanningPlantID, 'CompanyCodeID'),MessageFacade('IW038','计划工厂的成本结算区域与物料工厂不是同一个'),true)]]>
                                    </CheckRule>
                                </DataBinding>
                                <ItemFilter ItemKey="Plant">
                                    <Filter Key="Filter" Impl="com.bokesoft.yes.erp.condition.Filter" Type="Custom">
                                        <FilterValue Index="1" ParaValue="'soid in (select plantid from egs_Material_Plant where soid='&amp;SqlPara(MaterialID)&amp;')'"/>
                                    </Filter>
                                </ItemFilter>
                            </Dict>
                            <Dict Key="ToPlantID" Caption="至      工厂" X="0" Y="5" Visible="true" ItemKey="Plant">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="ToPlantID">
                                    <CheckRule>
                                        <![CDATA[IIF(IsRefurbishment,IIFS(ToPlantID<=0, MessageFacade('PM_MAINTENANCEORDER006','请指定物料的收货工厂'), ToPlantID>0&&GetDictValue('Plant', ToPlantID, 'CompanyCodeID')!=GetDictValue('Plant', PlanningPlantID, 'CompanyCodeID'), MessageFacade('IW038','计划工厂的成本结算区域与物料工厂不是同一个'), true, true),true)]]>
                                    </CheckRule>
                                </DataBinding>
                                <ItemFilter ItemKey="Plant">
                                    <Filter Key="Filter" Impl="com.bokesoft.yes.erp.condition.Filter" Type="Custom">
                                        <FilterValue Index="1" ParaValue="'soid in (select plantid from egs_Material_Plant where soid='&amp;SqlPara(MaterialID)&amp;')'"/>
                                    </Filter>
                                </ItemFilter>
                            </Dict>
                            <Dict Key="FromStorageLocationID" Caption="库存地点" LabelType="M" X="2" Y="4" Visible="true" ItemKey="StorageLocation">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="FromStorageLocationID">
                                    <ValueChanged>
                                        <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.setFirstBOM('FromStorageLocationID');]]>
                                    </ValueChanged>
                                </DataBinding>
                                <ItemFilter ItemKey="StorageLocation">
                                    <Filter Key="Filter" Impl="com.bokesoft.yes.erp.condition.Filter" Type="Custom">
                                        <FilterValue Index="1" ParaValue="IIF(FromPlantID&gt;0,'PlantID='&amp;SqlPara(FromPlantID),'')"/>
                                    </Filter>
                                </ItemFilter>
                            </Dict>
                            <Dict Key="ToStorageLocationID" Caption="库存地点" LabelType="M" X="2" Y="5" Visible="true" ItemKey="StorageLocation">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="ToStorageLocationID"/>
                                <ItemFilter ItemKey="StorageLocation">
                                    <Filter Key="Filter" Impl="com.bokesoft.yes.erp.condition.Filter" Type="Custom">
                                        <FilterValue Index="1" ParaValue="IIF(ToPlantID&gt;0,'PlantID='&amp;SqlPara(ToPlantID),'')"/>
                                    </Filter>
                                </ItemFilter>
                            </Dict>
                            <CheckBox Key="IsCompleteReceipt" Caption="已全部交货" X="3" Y="2" Visible="false" Enable="false">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="IsCompleteReceipt"/>
                            </CheckBox>
                            <CheckBox Key="IsWithoutLimit" Caption="未限制过量交货" LabelType="M" X="3" Y="3" Visible="false" XSpan="2">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="IsWithoutLimit"/>
                            </CheckBox>
                            <Dict Key="BaseUnitID" Caption="物料基本单位" X="1" Y="3" Visible="Macro_DebugMode()" Enable="false" ItemKey="Unit">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="BaseUnitID">
                                    <DefaultFormulaValue>
                                        <![CDATA[IIF(MaterialID<=0,GetDictOID('Unit','Code', 'PC'),GetDictValue('Material', MaterialID, 'BaseUnitID'))]]>
                                    </DefaultFormulaValue>
                                </DataBinding>
                            </Dict>
                            <NumberEditor Key="BaseUnitDenominator" Caption="订单到基本单位-分母" LabelType="M" X="2" Y="3" Visible="Macro_DebugMode()" Enable="false" IntegerValue="true" Precision="9" Scale="0" UseGroupingSeparator="false">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="BaseUnitDenominator">
                                    <DefaultFormulaValue>
                                        <![CDATA[IIF(BaseUnitID>0&&UnitID>0&&MaterialID>0,com.bokesoft.erp.basis.unit.UnitFormula.getDeno4MaTunit(UnitID,BaseUnitID,MaterialID),1)]]>
                                    </DefaultFormulaValue>
                                </DataBinding>
                            </NumberEditor>
                            <NumberEditor Key="BaseUnitNumerator" Caption="订单到基本单位-分子" LabelType="M" X="2" Y="3" Visible="Macro_DebugMode()" Enable="false" IntegerValue="true" Precision="9" Scale="0" UseGroupingSeparator="false">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="BaseUnitNumerator">
                                    <DefaultFormulaValue>
                                        <![CDATA[IIF(BaseUnitID>0&&UnitID>0&&MaterialID>0,com.bokesoft.erp.basis.unit.UnitFormula.getNume4MaTunit(UnitID,BaseUnitID,MaterialID),1)]]>
                                    </DefaultFormulaValue>
                                </DataBinding>
                            </NumberEditor>
                            <RowDefCollection RowGap="24">
                                <RowDef Height="32px"/>
                                <RowDef Height="32px"/>
                                <RowDef Height="32px"/>
                                <RowDef Height="32px"/>
                                <RowDef Height="32px"/>
                                <RowDef Height="32px"/>
                            </RowDefCollection>
                            <ColumnDefCollection ColumnGap="16">
                                <ColumnDef Width="300px"/>
                                <ColumnDef Width="150px"/>
                                <ColumnDef Width="300px"/>
                                <ColumnDef Width="130px"/>
                                <ColumnDef Width="75px"/>
                            </ColumnDefCollection>
                        </GridLayoutPanel>
                        <GridLayoutPanel Key="NotificationGridLayoutPanel" Caption="通知单" Padding="8px" OverflowY="Auto" Visible="Macro_IsIntegrateNotification()">
                            <UTCDatePicker Key="MalfunctionStartDate" Caption="故障开始" LabelType="M" X="0" Y="1" Enable="IsNew()" Format="yyyy-MM-dd">
                                <DataBinding TableKey="EPM_MaintOrder_NotificationData" ColumnKey="MalfunctionStartDate" DefaultFormulaValue="DateLong()">
                                    <CheckRule>
                                        <![CDATA[IIF(Macro_ToDateTime(MalfunctionStartDate,  MalfunctionStartTime)>Macro_ToDateTime(MalfunctionEndDate, MalfunctionEndTime)&&MalfunctionStartDate>0&&MalfunctionEndDate>0, MessageFacade('PEP258','结束时间发生在开始时间之前'), true);]]>
                                    </CheckRule>
                                </DataBinding>
                            </UTCDatePicker>
                            <TimePicker Key="MalfunctionStartTime" Caption="故障开始时间" LabelType="M" Second="true" Enable="IsNew()" X="1" Y="1">
                                <DataBinding TableKey="EPM_MaintOrder_NotificationData" ColumnKey="MalfunctionStartTime">
                                    <CheckRule>
                                        <![CDATA[IIF(Macro_ToDateTime(MalfunctionStartDate,  MalfunctionStartTime)>Macro_ToDateTime(MalfunctionEndDate, MalfunctionEndTime)&&MalfunctionStartDate>0&&MalfunctionEndDate>0, MessageFacade('PEP258','结束时间发生在开始时间之前'), true);]]>
                                    </CheckRule>
                                </DataBinding>
                            </TimePicker>
                            <UTCDatePicker Key="MalfunctionEndDate" Caption="故障结束" LabelType="M" X="0" Y="2" Enable="IsNew()" Format="yyyy-MM-dd">
                                <DataBinding TableKey="EPM_MaintOrder_NotificationData" ColumnKey="MalfunctionEndDate" DefaultFormulaValue="''">
                                    <CheckRule>
                                        <![CDATA[IIF(Macro_ToDateTime(MalfunctionStartDate,  MalfunctionStartTime)>Macro_ToDateTime(MalfunctionEndDate, MalfunctionEndTime)&&MalfunctionStartDate>0&&MalfunctionEndDate>0, MessageFacade('PEP258','结束时间发生在开始时间之前'), true);]]>
                                    </CheckRule>
                                </DataBinding>
                            </UTCDatePicker>
                            <TimePicker Key="MalfunctionEndTime" Caption="故障开始时间" Second="true" Enable="IsNew()" X="1" Y="2">
                                <DataBinding TableKey="EPM_MaintOrder_NotificationData" ColumnKey="MalfunctionEndTime">
                                    <CheckRule>
                                        <![CDATA[IIF(Macro_ToDateTime(MalfunctionStartDate,  MalfunctionStartTime)>Macro_ToDateTime(MalfunctionEndDate, MalfunctionEndTime)&&MalfunctionStartDate>0&&MalfunctionEndDate>0, MessageFacade('PEP258','结束时间发生在开始时间之前'), true);]]>
                                    </CheckRule>
                                </DataBinding>
                            </TimePicker>
                            <NumberEditor Key="BreakdownDuration" Caption="停机期间" X="2" Y="2" Enable="IsNew()">
                                <DataBinding TableKey="EPM_MaintOrder_NotificationData" ColumnKey="BreakdownDuration">
                                    <DefaultFormulaValue>
                                        <![CDATA[com.bokesoft.erp.pm.function.NotificationFormula.setBreakdownDuration(MalfunctionStartDate, MalfunctionStartTime, MalfunctionEndDate, MalfunctionEndTime, BreakdownDurationUnitID, IsBreakDown);]]>
                                    </DefaultFormulaValue>
                                </DataBinding>
                            </NumberEditor>
                            <Dict Key="BreakdownDurationUnitID" Caption="停机时长单位" LabelType="M" X="3" Y="2" Enable="IsNew()" ItemKey="Unit">
                                <DataBinding TableKey="EPM_MaintOrder_NotificationData" ColumnKey="BreakdownDurationUnitID">
                                    <DefaultFormulaValue>
                                        <![CDATA[com.bokesoft.erp.pm.function.PreventiveFormula.getUnitIDOfHour()]]>
                                    </DefaultFormulaValue>
                                </DataBinding>
                                <ItemFilter>
                                    <Filter Key="Filter" Impl="com.bokesoft.yes.erp.condition.Filter" Type="Custom">
                                        <FilterValue Index="1" ParaValue="'soid in (SELECT soid FROM BK_Unit WHERE UnitSystemID IN (SELECT soid FROM BK_UnitSystem WHERE UnitTime = '&amp;SqlPara(1)&amp;'))'"/>
                                    </Filter>
                                </ItemFilter>
                            </Dict>
                            <TextButton Key="CodeGroupProblem" Caption="故障" LabelType="M" X="0" Y="4" Enable="IsNew()" MaxLength="100" Trim="true">
                                <DataBinding TableKey="EPM_MaintOrder_NotificationData" ColumnKey="CodeGroupProblem">
                                    <ValueChanged>
                                        <![CDATA[Macro_CheckCodeOrCodeGroup('ProblemID', 'CodeGroupProblem', 'CodeProblem', 'CodeProblem_Text')]]>
                                    </ValueChanged>
                                </DataBinding>
                                <OnClick>
                                    <![CDATA[Macro_SetCode4QualityNotification('ProblemID', 'CodeGroupProblem', 'CodeProblem', 'CodeProblem_Text', '')]]>
                                </OnClick>
                            </TextButton>
                            <TextButton Key="CodeProblem" Caption="缺陷类型" LabelType="M" X="1" Y="4" Enable="IsNew()" MaxLength="100" Trim="true">
                                <DataBinding TableKey="EPM_MaintOrder_NotificationData" ColumnKey="CodeProblem">
                                    <ValueChanged>
                                        <![CDATA[Macro_CheckCodeOrCodeGroup('ProblemID', 'CodeGroupProblem', 'CodeProblem', 'CodeProblem_Text')]]>
                                    </ValueChanged>
                                    <CheckRule>
                                        <![CDATA[Macro_CheckRequired('CodeGroupProblem','CodeProblem')]]>
                                    </CheckRule>
                                </DataBinding>
                                <OnClick>
                                    <![CDATA[Macro_SetCode4QualityNotification('ProblemID', 'CodeGroupProblem', 'CodeProblem', 'CodeProblem_Text', CodeGroupProblem)]]>
                                </OnClick>
                            </TextButton>
                            <TextEditor Key="CodeProblem_Text" Caption="故障短文本" X="2" Y="4" Enable="IsNew()" MaxLength="100" Trim="true">
                                <DataBinding TableKey="EPM_MaintOrder_NotificationData" ColumnKey="CodeProblem_Text"/>
                            </TextEditor>
                            <TextEditor Key="CauseCodeNotes" Caption="文本" X="3" Y="4" Enable="IsNew()" MaxLength="100" Trim="true">
                                <DataBinding TableKey="EPM_MaintOrder_NotificationData" ColumnKey="CauseCodeNotes"/>
                            </TextEditor>
                            <TextButton Key="ICCodeGroupCauses" Caption="原因" LabelType="M" X="0" Y="5" Enable="IsNew()" MaxLength="100" Trim="true">
                                <DataBinding TableKey="EPM_MaintOrder_NotificationData" ColumnKey="ICCodeGroupCauses">
                                    <ValueChanged>
                                        <![CDATA[Macro_CheckCodeOrCodeGroup('CauseID', 'ICCodeGroupCauses', 'ICCodeCauses', 'ICCodeCauses_Text')]]>
                                    </ValueChanged>
                                </DataBinding>
                                <OnClick>
                                    <![CDATA[Macro_SetCode4QualityNotification('CauseID', 'ICCodeGroupCauses', 'ICCodeCauses', 'ICCodeCauses_Text', '')]]>
                                </OnClick>
                            </TextButton>
                            <TextButton Key="ICCodeCauses" Caption="原因代码" LabelType="M" X="1" Y="5" Enable="IsNew()" MaxLength="100" Trim="true">
                                <DataBinding TableKey="EPM_MaintOrder_NotificationData" ColumnKey="ICCodeCauses">
                                    <ValueChanged>
                                        <![CDATA[Macro_CheckCodeOrCodeGroup('CauseID', 'ICCodeGroupCauses', 'ICCodeCauses', 'ICCodeCauses_Text')]]>
                                    </ValueChanged>
                                    <CheckRule>
                                        <![CDATA[Macro_CheckRequired('ICCodeGroupCauses','ICCodeCauses')]]>
                                    </CheckRule>
                                </DataBinding>
                                <OnClick>
                                    <![CDATA[Macro_SetCode4QualityNotification('CauseID', 'ICCodeGroupCauses', 'ICCodeCauses', 'ICCodeCauses_Text', ICCodeGroupCauses)]]>
                                </OnClick>
                            </TextButton>
                            <TextEditor Key="ICCodeCauses_Text" Caption="原因短文本" X="2" Y="5" Enable="IsNew()" MaxLength="100" Trim="true">
                                <DataBinding TableKey="EPM_MaintOrder_NotificationData" ColumnKey="ICCodeCauses_Text"/>
                            </TextEditor>
                            <TextEditor Key="ICCauseText" Caption="文本" X="3" Y="5" Enable="IsNew()" MaxLength="100" Trim="true">
                                <DataBinding TableKey="EPM_MaintOrder_NotificationData" ColumnKey="ICCauseText"/>
                            </TextEditor>
                            <UTCDatePicker Key="RequireStartDate" Caption="请求启动" LabelType="M" X="0" Y="7" Enable="IsNew()" Format="yyyy-MM-dd">
                                <DataBinding TableKey="EPM_MaintOrder_NotificationData" ColumnKey="RequireStartDate" DefaultFormulaValue="DateLong()">
                                    <CheckRule>
                                        <![CDATA[IIF(Macro_ToDateTime(RequireStartDate,  RequireStartTime)>Macro_ToDateTime(RequireEndDate, RequireEndTime)&&RequireStartDate>0&&RequireEndDate>0, MessageFacade('PEP258','结束时间发生在开始时间之前'), true);]]>
                                    </CheckRule>
                                </DataBinding>
                            </UTCDatePicker>
                            <TimePicker Key="RequireStartTime" Caption="要求的起始时间" LabelType="M" Second="true" Enable="IsNew()" X="1" Y="7">
                                <DataBinding TableKey="EPM_MaintOrder_NotificationData" ColumnKey="RequireStartTime">
                                    <CheckRule>
                                        <![CDATA[IIF(Macro_ToDateTime(RequireStartDate,  RequireStartTime)>Macro_ToDateTime(RequireEndDate, RequireEndTime)&&RequireStartDate>0&&RequireEndDate>0, MessageFacade('PEP258','结束时间发生在开始时间之前'), true);]]>
                                    </CheckRule>
                                </DataBinding>
                            </TimePicker>
                            <Dict Key="ReporterOperatorID" Caption="报告者" LabelType="M" X="2" Y="7" Enable="IsNew()" ItemKey="Operator" EditValue="true">
                                <DataBinding TableKey="EPM_MaintOrder_NotificationData" ColumnKey="ReporterOperatorID"/>
                            </Dict>
                            <UTCDatePicker Key="RequireEndDate" Caption="要求结束" LabelType="S" X="0" Y="8" Enable="IsNew()" Format="yyyy-MM-dd">
                                <DataBinding TableKey="EPM_MaintOrder_NotificationData" ColumnKey="RequireEndDate">
                                    <CheckRule>
                                        <![CDATA[IIF(Macro_ToDateTime(RequireStartDate,  RequireStartTime)>Macro_ToDateTime(RequireEndDate, RequireEndTime)&&RequireStartDate>0&&RequireEndDate>0, MessageFacade('PEP258','结束时间发生在开始时间之前'), true);]]>
                                    </CheckRule>
                                </DataBinding>
                            </UTCDatePicker>
                            <TimePicker Key="RequireEndTime" Caption="要求的结束时间" LabelType="M" Second="true" Enable="IsNew()" X="1" Y="8">
                                <DataBinding TableKey="EPM_MaintOrder_NotificationData" ColumnKey="RequireEndTime">
                                    <CheckRule>
                                        <![CDATA[IIF(Macro_ToDateTime(RequireStartDate,  RequireStartTime)>Macro_ToDateTime(RequireEndDate, RequireEndTime)&&RequireStartDate>0&&RequireEndDate>0, MessageFacade('PEP258','结束时间发生在开始时间之前'), true);]]>
                                    </CheckRule>
                                </DataBinding>
                            </TimePicker>
                            <UTCDatePicker Key="NotificationDate" Caption="通知日期" LabelType="M" X="2" Y="8" Enable="IsNew()" Format="yyyy-MM-dd">
                                <DataBinding TableKey="EPM_MaintOrder_NotificationData" ColumnKey="NotificationDate" DefaultFormulaValue="DateLong()"/>
                            </UTCDatePicker>
                            <TimePicker Key="NotificationTime" Caption="通知时间" LabelType="M" Second="true" Enable="IsNew()" X="3" Y="8">
                                <DataBinding TableKey="EPM_MaintOrder_NotificationData" ColumnKey="NotificationTime"/>
                            </TimePicker>
                            <Label Key="MalfunctionData_Lab" Caption="故障数据" X="0" Y="0" Visible="true" Class="erp-group-title" XSpan="4"/>
                            <Label Key="Problem_Lab" Caption="损坏" X="0" Y="3" Visible="true" Class="erp-group-title" XSpan="4"/>
                            <Label Key="NotificationDate_Lab" Caption="通知日期" X="0" Y="6" Visible="true" Class="erp-group-title" XSpan="4"/>
                            <CheckBox Key="IsBreakDown" Caption="停机" LabelType="M" X="2" Y="1" Enable="IsNew()">
                                <DataBinding TableKey="EPM_MaintOrder_NotificationData" ColumnKey="IsBreakDown"/>
                            </CheckBox>
                            <RowDefCollection RowGap="24">
                                <RowDef Height="32px"/>
                                <RowDef Height="32px"/>
                                <RowDef Height="32px"/>
                                <RowDef Height="32px"/>
                                <RowDef Height="32px"/>
                                <RowDef Height="32px"/>
                                <RowDef Height="32px"/>
                                <RowDef Height="32px"/>
                                <RowDef Height="32px"/>
                            </RowDefCollection>
                            <ColumnDefCollection ColumnGap="16">
                                <ColumnDef Width="330px"/>
                                <ColumnDef Width="330px"/>
                                <ColumnDef Width="330px"/>
                                <ColumnDef Width="330px"/>
                            </ColumnDefCollection>
                        </GridLayoutPanel>
                        <SplitPanel Key="RoutingSplitPanel" Caption="工序" Orientation="Vertical" Visible="true">
                            <SplitPanel Key="RoutingTopSplitPanel" Caption="工序" Orientation="Vertical">
                                <Grid Key="MaintenanceOrder_RoutingGrid" Caption="工序" SerialSeq="true" DisabledOption="sum,groupSum" Padding="8px">
                                    <GridColumnCollection>
                                        <GridColumn Key="RO_IsSelect" Width="32px"/>
                                        <GridColumn Key="RO_OID" Caption="RO_OID" Visible="Macro_DebugMode()" Width="80px" Sortable="true"/>
                                        <GridColumn Key="RO_ProcessNo" Caption="项目" Width="80px" Sortable="true"/>
                                        <GridColumn Key="RO_SubProcessNo" Caption="子工序" LabelType="H" Width="80px"/>
                                        <GridColumn Key="RO_WorkCenterID" Caption="工作中心" LabelType="H" Width="80px" Sortable="true"/>
                                        <GridColumn Key="RO_PlantID" Caption="工厂" LabelType="H" Width="80px" Sortable="true"/>
                                        <GridColumn Key="RO_OperationShortText" Caption="工序短文本" LabelType="H" Width="100px" Sortable="true"/>
                                        <GridColumn Key="RO_ControlCodeID" Caption="控制码" LabelType="M" Width="80px" Sortable="true"/>
                                        <GridColumn Key="StandardTextKeyID" Caption="标准文本码" Width="100px"/>
                                        <GridColumn Key="RO_OperatingConditionID" Caption="系统条件" LabelType="H" Width="80px"/>
                                        <GridColumn Key="RO_RoutingNotes" Caption="描述" LabelType="H" Width="80px" Sortable="true"/>
                                        <GridColumn Key="RO_RoutingStatusText" Caption="系统状态" LabelType="H" Width="80px" Sortable="true"/>
                                        <GridColumn Key="RO_RoutingUserStatus" Caption="用户状态" LabelType="H" Width="80px" Sortable="true"/>
                                        <GridColumn Key="RO_ProcessWorkTime" Caption="工作量" LabelType="H" Width="80px" Sortable="true"/>
                                        <GridColumn Key="RO_ConfirmQuantity" Caption="反填工作量" Visible="Macro_DebugMode()" Width="100px" Sortable="true"/>
                                        <GridColumn Key="RO_ProcessWorkTimeUnitID" Caption="工作量单位" Width="100px" Sortable="true"/>
                                        <GridColumn Key="RO_NumberofCapacity" Caption="能力数" Width="80px" Sortable="true"/>
                                        <GridColumn Key="RO_ProcessDuration" Caption="工序持续期间" LabelType="H" Width="120px" Sortable="true"/>
                                        <GridColumn Key="RO_ProcessDurationUnitID" Caption="工序持续单位" Width="120px" Sortable="true"/>
                                        <GridColumn Key="RO_Percentage" Caption="工作百分比" Visible="false" Width="100px"/>
                                        <GridColumn Key="RO_EarliestStartDate" Caption="最早开始日期" LabelType="H" Width="120px" Sortable="true"/>
                                        <GridColumn Key="RO_EarliestStartTime" Caption="最早开始时间" LabelType="H" Width="120px" Sortable="true"/>
                                        <GridColumn Key="RO_EarliestEndDate" Caption="最早完工日期" LabelType="H" Width="120px" Sortable="true"/>
                                        <GridColumn Key="RO_EarliestEndTime" Caption="最早完工时间" Width="120px" Sortable="true"/>
                                        <GridColumn Key="RO_LatestStartDate" Caption="最迟开始日期" LabelType="H" Width="120px" Sortable="true"/>
                                        <GridColumn Key="RO_LatestStartTime" Caption="最迟开始时间" LabelType="H" Width="120px" Sortable="true"/>
                                        <GridColumn Key="RO_LatestEndDate" Caption="最迟完工日期" Width="120px" Sortable="true"/>
                                        <GridColumn Key="RO_LatestEndTime" Caption="最迟完工时间" Width="120px" Sortable="true"/>
                                        <GridColumn Key="RO_ActualStartDate" Caption="实际开始日期" LabelType="H" Width="120px" Sortable="true"/>
                                        <GridColumn Key="RO_ActualStartTime" Caption="实际开始时间" LabelType="H" Width="120px" Sortable="true"/>
                                        <GridColumn Key="RO_ActualEndDate" Caption="实际完工日期" LabelType="M" Width="120px" Sortable="true"/>
                                        <GridColumn Key="RO_ActualEndTime" Caption="实际完工时间" LabelType="M" Width="120px" Sortable="true"/>
                                        <GridColumn Key="RO_ForecastEndDate" Caption="预测完成日期" Width="120px" Sortable="true"/>
                                        <GridColumn Key="RO_ForecastEndTime" Caption="预测完工时间" Width="120px" Sortable="true"/>
                                        <GridColumn Key="RO_StartPoint" Caption="起点" LabelType="M" Visible="false" Width="80px"/>
                                        <GridColumn Key="RO_StartLimitDate" Caption="作业开始日期" LabelType="M" Visible="false" Width="120px"/>
                                        <GridColumn Key="RO_StartLimitTime" Caption="作业开始时间" LabelType="H" Visible="false" Width="120px"/>
                                        <GridColumn Key="RO_Ended" Caption="结束" LabelType="H" Visible="false" Width="80px"/>
                                        <GridColumn Key="RO_EndLimitDate" Caption="作业完成日期" LabelType="H" Visible="false" Width="120px"/>
                                        <GridColumn Key="RO_EndLimitTime" Caption="作业完成时间" LabelType="H" Visible="false" Width="120px"/>
                                        <GridColumn Key="RO_ConfirmationDocNo" Caption="完成确认" Width="80px" Sortable="true"/>
                                        <GridColumn Key="RO_ActualWorkTime" Caption="实际工作时长" LabelType="M" Width="120px" Sortable="true"/>
                                        <GridColumn Key="RO_ForecastWorkTime" Caption="预测工作时长" Width="120px" Sortable="true"/>
                                        <GridColumn Key="RO_IsNoRemainingWork" Caption="没有剩余工作" LabelType="M" Width="120px" Sortable="true"/>
                                        <GridColumn Key="RO_PurchaseReqSOID" Caption="采购申请" LabelType="H" Width="80px" Sortable="true"/>
                                        <GridColumn Key="RO_PurchaseRequisitionDtlOID" Caption="采购申请明细ID" LabelType="H" Visible="false" Width="80px"/>
                                        <GridColumn Key="RO_PurchaseRequisitioItem" Caption="采购申请项目" Width="120px" Sortable="true"/>
                                        <GridColumn Key="RO_IsPurchaseOrdExists" Caption="采购订单存在" LabelType="H" Visible="false" Width="120px"/>
                                        <GridColumn Key="RO_GRQuantity" Caption="GR数量" Width="100px" Sortable="true"/>
                                        <GridColumn Key="RO_GRUnitID" Caption="GR单位" LabelType="H" Width="80px" Sortable="true"/>
                                        <GridColumn Key="RO_ActivityTypeID" Caption="活动类型" LabelType="S" Width="80px" Sortable="true"/>
                                        <GridColumn Key="RO_ActivityTypePrice" Caption="作业类型价格" LabelType="H" Visible="false" Width="120px"/>
                                        <GridColumn Key="RO_CalculationKey" Caption="计算规则" Width="80px" Sortable="true"/>
                                        <GridColumn Key="RO_Receive" Caption="接收方" LabelType="H" Width="80px"/>
                                        <GridColumn Key="RO_UnloadingPoint" Caption="卸货点" LabelType="H" Width="80px"/>
                                        <GridColumn Key="RO_Requester" Caption="申请者" LabelType="M" Visible="false" Width="80px"/>
                                        <GridColumn Key="RO_TrackingNumber" Caption="跟踪号" LabelType="H" Visible="false" Width="80px"/>
                                        <GridColumn Key="RO_ExecutionFactor" Caption="执行因子" LabelType="M" Width="80px" Sortable="true"/>
                                        <GridColumn Key="RO_IsComponentAllocation" Caption="组件" LabelType="H" Width="80px" Sortable="true"/>
                                        <GridColumn Key="RO_NotificationSOID" Caption="通知单" LabelType="H" Width="80px" Sortable="true"/>
                                        <GridColumn Key="RO_FunctionalLocationSOID" Caption="功能位置" LabelType="H" Width="80px" Sortable="true"/>
                                        <GridColumn Key="RO_EquipmentSOID" Caption="设备" LabelType="H" Width="80px" Sortable="true"/>
                                        <GridColumn Key="RO_IsOutsourcing" Caption="外协工序" LabelType="H" Width="80px" Sortable="true"/>
                                        <GridColumn Key="RO_PurchasingOrganizationID" Caption="采购组织" LabelType="M" Width="80px" Sortable="true"/>
                                        <GridColumn Key="RO_PurchaseInfoRecordID" Caption="采购信息记录" LabelType="L" Width="120px" Sortable="true"/>
                                        <GridColumn Key="RO_PurchasingGroupID" Caption="采购组" LabelType="M" Visible="Macro_DebugMode()" Width="80px" Sortable="true"/>
                                        <GridColumn Key="RO_CostElementID" Caption="成本要素" LabelType="H" Width="80px" Sortable="true"/>
                                        <GridColumn Key="RO_ValueTypeID" Caption="数值种类" LabelType="H" Width="80px"/>
                                        <GridColumn Key="RO_SortTerm" Caption="排序字符串" LabelType="H" Visible="false" Width="100px" Sortable="true"/>
                                        <GridColumn Key="RO_MaterialGroupID" Caption="物料组" LabelType="H" Visible="Macro_DebugMode()" Width="80px" Sortable="true"/>
                                        <GridColumn Key="RO_VendorID" Caption="供应商" LabelType="H" Visible="false" Width="80px" Sortable="true"/>
                                        <GridColumn Key="RO_OperationQuantity" Caption="工序数量" LabelType="H" Width="100px" Sortable="true"/>
                                        <GridColumn Key="RO_OperationBaseUnitID" Caption="工序基本单位" Visible="Macro_DebugMode()" Width="120px" Sortable="true"/>
                                        <GridColumn Key="RO_PlannedDeliveryDay" Caption="计划交货时间(天)" Visible="Macro_DebugMode()" Width="80px" Sortable="true"/>
                                        <GridColumn Key="RO_NetPriceQuantity" Caption="价格数量" LabelType="H" Visible="Macro_DebugMode()" Width="100px" Sortable="true"/>
                                        <GridColumn Key="RO_NetPrice" Caption="净价" LabelType="M" Visible="Macro_DebugMode()" Width="80px" Sortable="true"/>
                                        <GridColumn Key="RO_NetPriceCurrencyID" Caption="币种" LabelType="M" Visible="false" Width="80px" Sortable="true"/>
                                        <GridColumn Key="RO_IsSubcontract" Caption="转包" LabelType="S" Visible="false" Width="80px" Sortable="true"/>
                                        <GridColumn Key="RO_RequisitionCreationControl" Caption="预留/采购申请" LabelType="M" Width="80px" Sortable="true"/>
                                        <GridColumn Key="RO_DefineUserFieldID" Caption="字段码" LabelType="H" Visible="false" Width="80px"/>
                                        <GridColumn Key="RO_UserFieldText1" Caption="Text1" Visible="false" Width="80px"/>
                                        <GridColumn Key="RO_UserFieldText2" Caption="Text2" LabelType="H" Visible="false" Width="80px"/>
                                        <GridColumn Key="RO_UserFieldText3" Caption="Text3" Visible="false" Width="80px"/>
                                        <GridColumn Key="RO_UserFieldText4" Caption="Text4" LabelType="M" Visible="false" Width="80px"/>
                                        <GridColumn Key="RO_UserFieldDate1Time" Caption="Date1" Visible="false" Width="160px"/>
                                        <GridColumn Key="RO_UserFieldDate2Time" Caption="Date2" LabelType="M" Visible="false" Width="160px"/>
                                        <GridColumn Key="RO_UserFieldNumber1" Caption="Number1" Visible="false" Width="80px"/>
                                        <GridColumn Key="RO_UserFieldNumber1UnitID" Caption="Number1UnitID" Visible="false" Width="80px"/>
                                        <GridColumn Key="RO_UserFieldNumber2" Caption="Number2" LabelType="M" Visible="false" Width="80px"/>
                                        <GridColumn Key="RO_UserFieldNumber2UnitID" Caption="Number2UnitID" LabelType="M" Visible="false" Width="80px"/>
                                        <GridColumn Key="RO_UserFieldValue1" Caption="Value1" LabelType="M" Visible="false" Width="80px"/>
                                        <GridColumn Key="RO_UserFieldValue1CurrencyID" Caption="Value1CurrencyID" Visible="false" Width="80px"/>
                                        <GridColumn Key="RO_UserFieldValue2" Caption="Value2" Visible="false" Width="80px"/>
                                        <GridColumn Key="RO_UserFieldValue2CurrencyID" Caption="Value2CurrencyID" LabelType="M" Visible="false" Width="80px"/>
                                        <GridColumn Key="RO_IsUserFieldCheckBox1" Caption="CheckBox1" Visible="false" Width="80px"/>
                                        <GridColumn Key="RO_IsUserFieldCheckBox2" Caption="CheckBox2" LabelType="H" Visible="false" Width="80px"/>
                                        <GridColumn Key="RO_Money" Caption="金额" LabelType="H" Visible="false" Width="100px"/>
                                        <GridColumn Key="RO_SourseRoutingDtlOID" Caption="RO_SourseRoutingDtlOID" Visible="Macro_DebugMode()" Width="80px" Sortable="true"/>
                                        <GridColumn Key="RO_RoutingID" Caption="RO_RoutingID" Visible="Macro_DebugMode()" Width="80px" Sortable="true"/>
                                        <GridColumn Key="RO_SOID" Visible="false" Width="80px" Sortable="true"/>
                                        <GridColumn Key="RO_SrcOID" Caption="SrcOID" Visible="Macro_DebugMode()" Width="80px"/>
                                        <GridColumn Key="RO_SrcSOID" Caption="SrcSOID" Visible="Macro_DebugMode()" Width="80px"/>
                                        <GridColumn Key="RO_SrcFormKey" Caption="SrcFormKey" Visible="Macro_DebugMode()" Width="80px"/>
                                        <GridColumn Key="RO_ServiceConfirmQuantity" Caption="服务确认数量" LabelType="H" Visible="false" Width="120px"/>
                                        <GridColumn Key="RO_IsCompleted" Caption="完成" Visible="false" Width="80px"/>
                                        <GridColumn Key="RO_StatusItem" Caption="项目状态" LabelType="H" Width="80px" Sortable="true"/>
                                        <GridColumn Key="Dtl_ExternalSystemPrimaryKey" Caption="外部系统关键字" LabelType="H" Visible="false" Width="100px"/>
                                    </GridColumnCollection>
                                    <GridRowCollection>
                                        <GridRow Key="MaintenanceOrder_RoutingGridRow" TableKey="EPM_MaintOrder_Routing">
                                            <GridCell Key="RO_IsSelect" Caption="选择" CellType="CheckBox" IsSelect="true"/>
                                            <GridCell Key="RO_OID" Caption="RO_OID" CellType="NumberEditor" Scale="0">
                                                <DataBinding ColumnKey="OID"/>
                                            </GridCell>
                                            <GridCell Key="RO_ProcessNo" Caption="项目" CellType="TextEditor" Enable="Length(RO_SubProcessNo)==0&amp;&amp;!ReadOnly()" InvalidChars="+-." MaxLength="4" Trim="true">
                                                <DataBinding ColumnKey="ProcessNo" Required="true">
                                                    <ValueChanged>
                                                        <![CDATA[Macro_CheckAndFixProcessNo(RO_ProcessNo, 'RO_ProcessNo'); com.bokesoft.erp.pm.function.MaintenanceOrderFormula.refreshRefProcessNo(RO_OID,RO_ProcessNo);]]>
                                                    </ValueChanged>
                                                    <CheckRule>
                                                        <![CDATA[Macro_CheckIfProcessNoDup(0, 'RO_ProcessNo', 'ProcessNo', 'SubProcessNo', RO_SubProcessNo)]]>
                                                    </CheckRule>
                                                    <DefaultFormulaValue>
                                                        <![CDATA[IIF(Length(RO_ProcessNo) == 0 && Length(RO_OperationShortText) > 0, com.bokesoft.erp.pm.function.MaintenanceOrderFormula.generateSequenceNumber('EPM_MaintOrder_Routing', 'ProcessNo', -1, RO_OID, false), RO_ProcessNo)]]>
                                                    </DefaultFormulaValue>
                                                </DataBinding>
                                            </GridCell>
                                            <GridCell Key="RO_SubProcessNo" Caption="子工序" CellType="TextEditor" Enable="com.bokesoft.erp.pp.function.ProductionOrderFormula.isAvailable4SubProcessNo('EPM_MaintOrder_Routing', RO_ProcessNo,RO_OID)&amp;&amp;!ReadOnly()" InvalidChars="+-." MaxLength="4">
                                                <DataBinding ColumnKey="SubProcessNo">
                                                    <CheckRule>
                                                        <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.isRepeat4SubProcessNo('EPM_MaintOrder_Routing', RO_ProcessNo, RO_SubProcessNo, RO_OID)]]>
                                                    </CheckRule>
                                                </DataBinding>
                                            </GridCell>
                                            <GridCell Key="RO_WorkCenterID" Caption="工作中心" CellType="Dict" ItemKey="WorkCenter">
                                                <DataBinding ColumnKey="WorkCenterID">
                                                    <ValueChanged>
                                                        <![CDATA[IIF(GetRowIndex('MaintenanceOrder_RoutingGrid')==0,SetValue('FirstWorkCenterID', RO_WorkCenterID),false);SetValue('RO_ActivityTypeID', com.bokesoft.erp.pm.function.MaintenanceOrderFormula.getActivityTypeIDByWorkCenterID(RO_WorkCenterID),true);IIF(GetRowIndex('MaintenanceOrder_RoutingGrid')>0, SetValue('RO_ControlCodeID', com.bokesoft.erp.pm.function.MaintenanceOrderFormula.getDefaultControlCodeID(RO_PlantID, OrderTypeID, RO_WorkCenterID)), true);]]>
                                                    </ValueChanged>
                                                    <DefaultFormulaValue>
                                                        <![CDATA[IIF(RO_WorkCenterID>0,RO_WorkCenterID,MainWorkCenterID)]]>
                                                    </DefaultFormulaValue>
                                                </DataBinding>
                                                <ItemFilter ItemKey="WorkCenter">
                                                    <Filter Key="Filter" Impl="com.bokesoft.yes.erp.condition.Filter" Type="Custom">
                                                        <FilterValue Index="1" ParaValue="IIF(RO_PlantID&gt;0, ' BK_WorkCenter.PlantID='&amp;SqlPara(RO_PlantID), '1=2')"/>
                                                    </Filter>
                                                </ItemFilter>
                                            </GridCell>
                                            <GridCell Key="RO_PlantID" Caption="工厂" CellType="Dict" ItemKey="Plant">
                                                <DataBinding ColumnKey="PlantID">
                                                    <ValueChanged>
                                                        <![CDATA[IIF(GetRowIndex('MaintenanceOrder_RoutingGrid')==0,SetValue('FirstWorkCenterPlantID', RO_PlantID),false);]]>
                                                    </ValueChanged>
                                                    <CheckRule>
                                                        <![CDATA[IIFS(RO_PlantID>0&&GetDictValue('Plant', RO_PlantID, 'CompanyCodeID')!=GetDictValue('Plant', PlanningPlantID, 'CompanyCodeID'), MessageFacade('IW031','计划工厂的成本结算区域与工作中心工厂不是同一个'), RO_PlantID<=0, MessageFacade('PM_MAINTENANCEORDER008','请输入工厂'), true);]]>
                                                    </CheckRule>
                                                    <DefaultFormulaValue>
                                                        <![CDATA[IIF(GetRowIndex('MaintenanceOrder_RoutingGrid')<0,0,IIF(MainWorkCenterPlantID<=0,PlanningPlantID,MainWorkCenterPlantID))]]>
                                                    </DefaultFormulaValue>
                                                </DataBinding>
                                            </GridCell>
                                            <GridCell Key="RO_OperationShortText" Caption="工序短文本" CellType="TextEditor" MaxLength="100" Trim="true">
                                                <DataBinding ColumnKey="OperationShortText">
                                                    <ValueChanged>
                                                        <![CDATA[if (!com.bokesoft.erp.pm.function.MaintenanceOrderFormula.existProcessStatus4ProcessDtl(RO_OID)) {com.bokesoft.erp.pm.function.OrderConfirmationFormula.pmOrderProcessStatus_Add(RO_OID);}
                                                                                        if (GetRowIndex('MaintenanceOrder_RoutingGrid') == 0) {SetValue('FirstOperation', RO_OperationShortText);}]]>
                                                    </ValueChanged>
                                                    <CheckRule>
                                                        <![CDATA[IIF(RO_OperationShortText=='',MessageFacade('PM_MAINTENANCEORDER009','请输入工序短文本'),true)]]>
                                                    </CheckRule>
                                                </DataBinding>
                                            </GridCell>
                                            <GridCell Key="RO_ControlCodeID" Caption="控制码" CellType="Dict" ItemKey="PP_ControlCode">
                                                <DataBinding ColumnKey="ControlCodeID">
                                                    <ValueChanged>
                                                        <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.onControlCodeChanged(RO_OID,RO_ControlCodeID,GetOldValue());]]>
                                                    </ValueChanged>
                                                    <CheckRule>
                                                        <![CDATA[IIF(RO_ControlCodeID<=0, MessageFacade('CP461','请输入工序控制码'),true)]]>
                                                    </CheckRule>
                                                    <DefaultFormulaValue>
                                                        <![CDATA[IIF(RO_ControlCodeID<=0,com.bokesoft.erp.pm.function.MaintenanceOrderFormula.getDefaultControlCodeID(PlanningPlantID,OrderTypeID,MainWorkCenterID),RO_ControlCodeID);]]>
                                                    </DefaultFormulaValue>
                                                </DataBinding>
                                                <ItemFilter>
                                                    <Filter Key="Filter" Impl="com.bokesoft.yes.erp.condition.Filter" Type="Custom">
                                                        <FilterValue Index="1" ParaValue="&quot;(UseModel=&quot;&amp;SqlPara('PM')&amp;&quot; or soid in (select controlcodeid from bk_workcenter where soid = &quot;&amp;SqlPara(FirstWorkCenterID)&amp;&quot;))&quot;"/>
                                                    </Filter>
                                                </ItemFilter>
                                            </GridCell>
                                            <GridCell Key="StandardTextKeyID" Caption="标准文本码" CellType="Dict" ItemKey="PP_StandardTextKey">
                                                <DataBinding ColumnKey="StandardTextKeyID"/>
                                            </GridCell>
                                            <GridCell Key="RO_OperatingConditionID" Caption="系统条件" CellType="Dict" ItemKey="PM_OperatingCondition">
                                                <DataBinding ColumnKey="OperatingConditionID"/>
                                            </GridCell>
                                            <GridCell Key="RO_RoutingNotes" Caption="描述" CellType="TextEditor" MaxLength="100" Trim="true">
                                                <DataBinding ColumnKey="RoutingNotes"/>
                                            </GridCell>
                                            <GridCell Key="RO_RoutingStatusText" Caption="系统状态" CellType="TextEditor" Enable="false" MaxLength="100" Trim="true">
                                                <DataBinding ColumnKey="RoutingStatusText" ValueDependency="ES_IsActive,ES_ERPSystemStatusID">
                                                    <DefaultFormulaValue>
                                                        <![CDATA[com.bokesoft.erp.basis.status.StatusFormula.getSysStatusLineExtra(RO_OID, 'OVH')]]>
                                                    </DefaultFormulaValue>
                                                </DataBinding>
                                            </GridCell>
                                            <GridCell Key="RO_RoutingUserStatus" Caption="用户状态" CellType="TextEditor" Enable="false" MaxLength="100" Trim="true">
                                                <DataBinding ColumnKey="RoutingUserStatus" ValueDependency="EU_IsActive,EU_ERPUserStatusID">
                                                    <DefaultFormulaValue>
                                                        <![CDATA[com.bokesoft.erp.basis.status.StatusFormula.getUserStatusLineExtra(RO_OID, 'OVH')]]>
                                                    </DefaultFormulaValue>
                                                </DataBinding>
                                            </GridCell>
                                            <GridCell Key="RO_ProcessWorkTime" Caption="工作量" CellType="NumberEditor" Enable="!ReadOnly()&amp;&amp;!Macro_IsExternal()&amp;&amp;RO_CalculationKey!=2" Scale="3">
                                                <DataBinding ColumnKey="ProcessWorkTime">
                                                    <ValueChanged>
                                                        <![CDATA[IIF(!Macro_IsPCNF(),SetValue('RO_ConfirmQuantity', RO_ProcessWorkTime),true);IIF(GetRowIndex('MaintenanceOrder_RoutingGrid')==0,SetValue('FirstProcessWorkTime', RO_ProcessWorkTime),false);IIFS(RO_CalculationKey == 1, SetValue('RO_ProcessDuration', Macro_setOperationDurationTime(RO_ProcessDuration, RO_ProcessWorkTime, RO_ProcessWorkTimeUnitID, RO_NumberofCapacity, RO_ProcessDurationUnitID, RO_Percentage)), RO_CalculationKey == 2, SetValue('RO_ProcessWorkTime', Macro_setWorkActiveTime(RO_ProcessWorkTime, RO_ProcessWorkTimeUnitID, RO_NumberofCapacity, RO_ProcessDuration, RO_ProcessDurationUnitID, RO_Percentage)), RO_CalculationKey == 3, SetValue('RO_NumberofCapacity', Macro_setNumberofCapacities(RO_NumberofCapacity, RO_ProcessWorkTime, RO_ProcessWorkTimeUnitID, RO_ProcessDuration, RO_ProcessDurationUnitID, RO_Percentage)));]]>
                                                    </ValueChanged>
                                                </DataBinding>
                                                <CellFormat HAlign="Right"/>
                                            </GridCell>
                                            <GridCell Key="RO_ConfirmQuantity" Caption="反填工作量" CellType="NumberEditor" Scale="3">
                                                <DataBinding ColumnKey="ConfirmQuantity"/>
                                                <CellFormat HAlign="Right"/>
                                            </GridCell>
                                            <GridCell Key="RO_ProcessWorkTimeUnitID" Caption="工作量单位" CellType="Dict" Enable="!ReadOnly()&amp;&amp;!Macro_IsExternal()" ItemKey="Unit">
                                                <DataBinding ColumnKey="ProcessWorkTimeUnitID">
                                                    <ValueChanged>
                                                        <![CDATA[IIF(GetRowIndex('MaintenanceOrder_RoutingGrid')==0,SetValue('FirstProcessWorkTimeUnitID', RO_ProcessWorkTimeUnitID),false);IIFS(RO_CalculationKey == 1, SetValue('RO_ProcessDuration', Macro_setOperationDurationTime(RO_ProcessDuration, RO_ProcessWorkTime, RO_ProcessWorkTimeUnitID, RO_NumberofCapacity, RO_ProcessDurationUnitID, RO_Percentage)), RO_CalculationKey == 2, SetValue('RO_ProcessWorkTime', Macro_setWorkActiveTime(RO_ProcessWorkTime, RO_ProcessWorkTimeUnitID, RO_NumberofCapacity, RO_ProcessDuration, RO_ProcessDurationUnitID, RO_Percentage)), RO_CalculationKey == 3, SetValue('RO_NumberofCapacity', Macro_setNumberofCapacities(RO_NumberofCapacity, RO_ProcessWorkTime, RO_ProcessWorkTimeUnitID, RO_ProcessDuration, RO_ProcessDurationUnitID, RO_Percentage)));]]>
                                                    </ValueChanged>
                                                    <CheckRule>
                                                        <![CDATA[IIF(RO_ProcessWorkTime>0&&RO_ProcessWorkTimeUnitID<=0, MessageFacade('IW101','请输入时间单位！'), true);]]>
                                                    </CheckRule>
                                                    <DefaultFormulaValue>
                                                        <![CDATA[com.bokesoft.erp.pm.function.RoutingFormula.getDefaultUnitID(PlanningPlantID, 2);]]>
                                                    </DefaultFormulaValue>
                                                </DataBinding>
                                                <ItemFilter>
                                                    <Filter Key="Filter" Impl="com.bokesoft.yes.erp.condition.Filter" Type="Custom">
                                                        <FilterValue Index="1" ParaValue="'soid in (SELECT soid FROM BK_Unit WHERE UnitSystemID IN (SELECT soid FROM BK_UnitSystem WHERE UnitTime = '&amp;SqlPara(1)&amp;'))'"/>
                                                    </Filter>
                                                </ItemFilter>
                                            </GridCell>
                                            <GridCell Key="RO_NumberofCapacity" Caption="能力数" CellType="NumberEditor" Enable="!ReadOnly()&amp;&amp;RO_CalculationKey!=3" Precision="9" Scale="0" UseGroupingSeparator="false">
                                                <DataBinding ColumnKey="NumberofCapacity">
                                                    <ValueChanged>
                                                        <![CDATA[IIFS(RO_CalculationKey == 1, SetValue('RO_ProcessDuration', Macro_setOperationDurationTime(RO_ProcessDuration, RO_ProcessWorkTime, RO_ProcessWorkTimeUnitID, RO_NumberofCapacity, RO_ProcessDurationUnitID, RO_Percentage)), RO_CalculationKey == 2, SetValue('RO_ProcessWorkTime', Macro_setWorkActiveTime(RO_ProcessWorkTime, RO_ProcessWorkTimeUnitID, RO_NumberofCapacity, RO_ProcessDuration, RO_ProcessDurationUnitID, RO_Percentage)), RO_CalculationKey == 3, SetValue('RO_NumberofCapacity', Macro_setNumberofCapacities(RO_NumberofCapacity, RO_ProcessWorkTime, RO_ProcessWorkTimeUnitID, RO_ProcessDuration, RO_ProcessDurationUnitID, RO_Percentage)));]]>
                                                    </ValueChanged>
                                                    <CheckRule>
                                                        <![CDATA[IIF(RO_NumberofCapacity<0 || RO_NumberofCapacity>255, MessageFacade('00059','请输入正确值'), true)]]>
                                                    </CheckRule>
                                                </DataBinding>
                                            </GridCell>
                                            <GridCell Key="RO_ProcessDuration" Caption="工序持续期间" CellType="NumberEditor" Enable="!ReadOnly()&amp;&amp;RO_CalculationKey!=1" Scale="3">
                                                <DataBinding ColumnKey="ProcessDuration">
                                                    <ValueChanged>
                                                        <![CDATA[IIFS(RO_CalculationKey == 1, SetValue('RO_ProcessDuration', Macro_setOperationDurationTime(RO_ProcessDuration, RO_ProcessWorkTime, RO_ProcessWorkTimeUnitID, RO_NumberofCapacity, RO_ProcessDurationUnitID, RO_Percentage)), RO_CalculationKey == 2, SetValue('RO_ProcessWorkTime', Macro_setWorkActiveTime(RO_ProcessWorkTime, RO_ProcessWorkTimeUnitID, RO_NumberofCapacity, RO_ProcessDuration, RO_ProcessDurationUnitID, RO_Percentage)), RO_CalculationKey == 3, SetValue('RO_NumberofCapacity', Macro_setNumberofCapacities(RO_NumberofCapacity, RO_ProcessWorkTime, RO_ProcessWorkTimeUnitID, RO_ProcessDuration, RO_ProcessDurationUnitID, RO_Percentage)));IIF(GetRowIndex('MaintenanceOrder_RoutingGrid')==0,SetValue('FirstProcessDuration', RO_ProcessDuration),false);]]>
                                                    </ValueChanged>
                                                </DataBinding>
                                                <CellFormat HAlign="Right"/>
                                            </GridCell>
                                            <GridCell Key="RO_ProcessDurationUnitID" Caption="工序持续单位" CellType="Dict" ItemKey="Unit">
                                                <DataBinding ColumnKey="ProcessDurationUnitID">
                                                    <ValueChanged>
                                                        <![CDATA[IIFS(RO_CalculationKey == 1, SetValue('RO_ProcessDuration', Macro_setOperationDurationTime(RO_ProcessDuration, RO_ProcessWorkTime, RO_ProcessWorkTimeUnitID, RO_NumberofCapacity, RO_ProcessDurationUnitID, RO_Percentage)), RO_CalculationKey == 2, SetValue('RO_ProcessWorkTime', Macro_setWorkActiveTime(RO_ProcessWorkTime, RO_ProcessWorkTimeUnitID, RO_NumberofCapacity, RO_ProcessDuration, RO_ProcessDurationUnitID, RO_Percentage)), RO_CalculationKey == 3, SetValue('RO_NumberofCapacity', Macro_setNumberofCapacities(RO_NumberofCapacity, RO_ProcessWorkTime, RO_ProcessWorkTimeUnitID, RO_ProcessDuration, RO_ProcessDurationUnitID, RO_Percentage)));IIF(GetRowIndex('MaintenanceOrder_RoutingGrid')==0,SetValue('FirstProcessDurationUnitID', RO_ProcessDurationUnitID),false);]]>
                                                    </ValueChanged>
                                                    <CheckRule>
                                                        <![CDATA[IIF(RO_ProcessDuration>0&&RO_ProcessDurationUnitID<=0, MessageFacade('IW101','请输入时间单位！'), true);]]>
                                                    </CheckRule>
                                                    <DefaultFormulaValue>
                                                        <![CDATA[com.bokesoft.erp.pm.function.RoutingFormula.getDefaultUnitID(PlanningPlantID, 1)]]>
                                                    </DefaultFormulaValue>
                                                </DataBinding>
                                                <ItemFilter>
                                                    <Filter Key="Filter" Impl="com.bokesoft.yes.erp.condition.Filter" Type="Custom">
                                                        <FilterValue Index="1" ParaValue="'soid in (SELECT soid FROM BK_Unit WHERE UnitSystemID IN (SELECT soid FROM BK_UnitSystem WHERE UnitTime = '&amp;SqlPara(1)&amp;'))'"/>
                                                    </Filter>
                                                </ItemFilter>
                                            </GridCell>
                                            <GridCell Key="RO_Percentage" Caption="工作百分比" CellType="NumberEditor" Precision="9">
                                                <DataBinding ColumnKey="Percentage">
                                                    <ValueChanged>
                                                        <![CDATA[IIFS(RO_CalculationKey == 1, SetValue('RO_ProcessDuration', Macro_setOperationDurationTime(RO_ProcessDuration, RO_ProcessWorkTime, RO_ProcessWorkTimeUnitID, RO_NumberofCapacity, RO_ProcessDurationUnitID, RO_Percentage)), RO_CalculationKey == 2, SetValue('RO_ProcessWorkTime', Macro_setWorkActiveTime(RO_ProcessWorkTime, RO_ProcessWorkTimeUnitID, RO_NumberofCapacity, RO_ProcessDuration, RO_ProcessDurationUnitID, RO_Percentage)), RO_CalculationKey == 3, SetValue('RO_NumberofCapacity', Macro_setNumberofCapacities(RO_NumberofCapacity, RO_ProcessWorkTime, RO_ProcessWorkTimeUnitID, RO_ProcessDuration, RO_ProcessDurationUnitID, RO_Percentage)));]]>
                                                    </ValueChanged>
                                                </DataBinding>
                                                <CellFormat HAlign="Right"/>
                                            </GridCell>
                                            <GridCell Key="RO_EarliestStartDate" Caption="最早开始日期" CellType="UTCDatePicker" Enable="false" Format="yyyy-MM-dd">
                                                <DataBinding ColumnKey="EarliestStartDate" DefaultFormulaValue="BasicStartDate"/>
                                            </GridCell>
                                            <GridCell Key="RO_EarliestStartTime" Caption="最早开始时间" CellType="TimePicker" Enable="false" Second="true">
                                                <DataBinding ColumnKey="EarliestStartTime"/>
                                            </GridCell>
                                            <GridCell Key="RO_EarliestEndDate" Caption="最早完工日期" CellType="UTCDatePicker" Enable="false" Format="yyyy-MM-dd">
                                                <DataBinding ColumnKey="EarliestEndDate"/>
                                            </GridCell>
                                            <GridCell Key="RO_EarliestEndTime" Caption="最早完工时间" CellType="TimePicker" Enable="false" Second="true">
                                                <DataBinding ColumnKey="EarliestEndTime"/>
                                            </GridCell>
                                            <GridCell Key="RO_LatestStartDate" Caption="最迟开始日期" CellType="UTCDatePicker" Enable="false" Format="yyyy-MM-dd">
                                                <DataBinding ColumnKey="LatestStartDate"/>
                                            </GridCell>
                                            <GridCell Key="RO_LatestStartTime" Caption="最迟开始时间" CellType="TimePicker" Enable="false" Second="true">
                                                <DataBinding ColumnKey="LatestStartTime"/>
                                            </GridCell>
                                            <GridCell Key="RO_LatestEndDate" Caption="最迟完工日期" CellType="UTCDatePicker" Enable="false" Format="yyyy-MM-dd">
                                                <DataBinding ColumnKey="LatestEndDate"/>
                                            </GridCell>
                                            <GridCell Key="RO_LatestEndTime" Caption="最迟完工时间" CellType="TimePicker" Enable="false" Second="true">
                                                <DataBinding ColumnKey="LatestEndTime"/>
                                            </GridCell>
                                            <GridCell Key="RO_ActualStartDate" Caption="实际开始日期" CellType="UTCDatePicker" Enable="false" Format="yyyy-MM-dd">
                                                <DataBinding ColumnKey="ActualStartDate"/>
                                            </GridCell>
                                            <GridCell Key="RO_ActualStartTime" Caption="实际开始时间" CellType="TimePicker" Enable="false" Second="true">
                                                <DataBinding ColumnKey="ActualStartTime"/>
                                            </GridCell>
                                            <GridCell Key="RO_ActualEndDate" Caption="实际完工日期" CellType="UTCDatePicker" Enable="false" Format="yyyy-MM-dd">
                                                <DataBinding ColumnKey="ActualEndDate"/>
                                            </GridCell>
                                            <GridCell Key="RO_ActualEndTime" Caption="实际完工时间" CellType="TimePicker" Enable="false" Second="true">
                                                <DataBinding ColumnKey="ActualEndTime"/>
                                            </GridCell>
                                            <GridCell Key="RO_ForecastEndDate" Caption="预测完成日期" CellType="UTCDatePicker" Enable="false" Format="yyyy-MM-dd">
                                                <DataBinding ColumnKey="ForecastEndDate"/>
                                            </GridCell>
                                            <GridCell Key="RO_ForecastEndTime" Caption="预测完工时间" CellType="TimePicker" Enable="false" Second="true">
                                                <DataBinding ColumnKey="ForecastEndTime"/>
                                            </GridCell>
                                            <GridCell Key="RO_StartPoint" Caption="起点" CellType="ComboBox" GroupKey="ActivityStartDateLimit" SourceType="ParaGroup">
                                                <DataBinding ColumnKey="StartPoint"/>
                                            </GridCell>
                                            <GridCell Key="RO_StartLimitDate" Caption="作业开始日期" CellType="UTCDatePicker">
                                                <DataBinding ColumnKey="StartLimitDate">
                                                    <CheckRule>
                                                        <![CDATA[IIF(Macro_ToDateTime(RO_StartLimitDate,  RO_StartLimitTime)>Macro_ToDateTime(RO_EndLimitDate, RO_EndLimitTime)&&RO_StartLimitDate>0&&RO_EndLimitDate>0, MessageFacade('PEP258','结束时间发生在开始时间之前'), true);]]>
                                                    </CheckRule>
                                                </DataBinding>
                                            </GridCell>
                                            <GridCell Key="RO_StartLimitTime" Caption="作业开始时间" CellType="TimePicker" Second="true">
                                                <DataBinding ColumnKey="StartLimitTime">
                                                    <CheckRule>
                                                        <![CDATA[IIF(Macro_ToDateTime(RO_StartLimitDate,  RO_StartLimitTime)>Macro_ToDateTime(RO_EndLimitDate, RO_EndLimitTime)&&RO_StartLimitDate>0&&RO_EndLimitDate>0, MessageFacade('PEP258','结束时间发生在开始时间之前'), true);]]>
                                                    </CheckRule>
                                                </DataBinding>
                                            </GridCell>
                                            <GridCell Key="RO_Ended" Caption="结束" CellType="ComboBox" GroupKey="ActivityEndDateLimit" SourceType="ParaGroup">
                                                <DataBinding ColumnKey="Ended"/>
                                            </GridCell>
                                            <GridCell Key="RO_EndLimitDate" Caption="作业完成日期" CellType="UTCDatePicker">
                                                <DataBinding ColumnKey="EndLimitDate">
                                                    <CheckRule>
                                                        <![CDATA[IIF(Macro_ToDateTime(RO_StartLimitDate,  RO_StartLimitTime)>Macro_ToDateTime(RO_EndLimitDate, RO_EndLimitTime)&&RO_StartLimitDate>0&&RO_EndLimitDate>0, MessageFacade('PEP258','结束时间发生在开始时间之前'), true);]]>
                                                    </CheckRule>
                                                </DataBinding>
                                            </GridCell>
                                            <GridCell Key="RO_EndLimitTime" Caption="作业完成时间" CellType="TimePicker" Second="true">
                                                <DataBinding ColumnKey="EndLimitTime">
                                                    <CheckRule>
                                                        <![CDATA[IIF(Macro_ToDateTime(RO_StartLimitDate,  RO_StartLimitTime)>Macro_ToDateTime(RO_EndLimitDate, RO_EndLimitTime)&&RO_StartLimitDate>0&&RO_EndLimitDate>0, MessageFacade('PEP258','结束时间发生在开始时间之前'), true);]]>
                                                    </CheckRule>
                                                </DataBinding>
                                            </GridCell>
                                            <GridCell Key="RO_ConfirmationDocNo" Caption="完成确认" CellType="TextEditor" Enable="false" MaxLength="100" Trim="true">
                                                <DataBinding ColumnKey="ConfirmationDocNo"/>
                                            </GridCell>
                                            <GridCell Key="RO_ActualWorkTime" Caption="实际工作时长" CellType="NumberEditor" Enable="false">
                                                <DataBinding ColumnKey="ActualWorkTime"/>
                                                <CellFormat HAlign="Right"/>
                                            </GridCell>
                                            <GridCell Key="RO_ForecastWorkTime" Caption="预测工作时长" CellType="NumberEditor" Enable="false" Scale="3">
                                                <DataBinding ColumnKey="ForecastWorkTime"/>
                                                <CellFormat HAlign="Right"/>
                                            </GridCell>
                                            <GridCell Key="RO_IsNoRemainingWork" Caption="没有剩余工作" CellType="CheckBox">
                                                <DataBinding ColumnKey="IsNoRemainingWork"/>
                                            </GridCell>
                                            <GridCell Key="RO_PurchaseReqSOID" Caption="采购申请" CellType="Dict" Enable="false" ItemKey="MM_PurchaseRequisition__Dic" StateMask="Enable|Disable|Discard">
                                                <DataBinding ColumnKey="PurchaseReqSOID"/>
                                            </GridCell>
                                            <GridCell Key="RO_PurchaseRequisitionDtlOID" Caption="采购申请明细ID" CellType="NumberEditor" Scale="0">
                                                <DataBinding ColumnKey="PurchaseRequisitionDtlOID"/>
                                                <CellFormat HAlign="Right"/>
                                            </GridCell>
                                            <GridCell Key="RO_PurchaseRequisitioItem" Caption="采购申请项目" CellType="TextEditor" Enable="false" MaxLength="100" Trim="true">
                                                <DataBinding ColumnKey="PurchaseRequisitioItem"/>
                                            </GridCell>
                                            <GridCell Key="RO_IsPurchaseOrdExists" Caption="采购订单存在" CellType="CheckBox">
                                                <DataBinding ColumnKey="RO_IsPurchaseOrdExists">
                                                    <DefaultFormulaValue>
                                                        <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderOperation.isPurchaseOrdExists(RO_PurchaseReqSOID, RO_PurchaseRequisitionDtlOID);]]>
                                                    </DefaultFormulaValue>
                                                </DataBinding>
                                            </GridCell>
                                            <GridCell Key="RO_GRQuantity" Caption="GR数量" CellType="NumberEditor" Enable="false" Scale="3">
                                                <DataBinding ColumnKey="GRQuantity"/>
                                                <CellFormat HAlign="Right"/>
                                            </GridCell>
                                            <GridCell Key="RO_GRUnitID" Caption="GR单位" CellType="Dict" ItemKey="Unit">
                                                <DataBinding ColumnKey="GRUnitID"/>
                                            </GridCell>
                                            <GridCell Key="RO_ActivityTypeID" Caption="活动类型" CellType="Dict" ItemKey="CO_ActivityType">
                                                <DataBinding ColumnKey="ActivityTypeID">
                                                    <ValueChanged>
                                                        <![CDATA[SetValue('RO_CostElementID',GetDictValue('CO_ActivityType',RO_ActivityTypeID,'AllocationCostElementID'),true);IIF(GetRowIndex('MaintenanceOrder_RoutingGrid')==0,SetValue('FirstActivityTypeID', RO_ActivityTypeID),false);]]>
                                                    </ValueChanged>
                                                    <DefaultFormulaValue>
                                                        <![CDATA[IIF(RO_ActivityTypeID>0,RO_ActivityTypeID,com.bokesoft.erp.pm.function.MaintenanceOrderFormula.getActivityTypeIDByWorkCenterID(RO_WorkCenterID));]]>
                                                    </DefaultFormulaValue>
                                                </DataBinding>
                                                <ItemFilter>
                                                    <Filter Key="Filter" Impl="com.bokesoft.yes.erp.condition.Filter" Type="Custom">
                                                        <FilterValue Index="1" ParaValue="IIF(RO_WorkCenterID &gt; 0,Macro_ActivityTypeFilter(RO_WorkCenterID,RO_EarliestStartDate),' 1 = 2 ')"/>
                                                    </Filter>
                                                </ItemFilter>
                                            </GridCell>
                                            <GridCell Key="RO_ActivityTypePrice" Caption="作业类型价格" CellType="NumberEditor">
                                                <DataBinding ColumnKey="ActivityTypePrice">
                                                    <DefaultFormulaValue>
                                                        <![CDATA[IIF(RO_ActivityTypeID > 0 && RO_PlantID > 0 && RO_WorkCenterID > 0 && RO_EarliestStartDate > 0 && OrgControllingAreaID > 0 && PlanCostingVariantID > 0,com.bokesoft.erp.co.formula.PMOrderCostFormula.getActivityTypePriceByWorkCenter(OrgControllingAreaID,RO_PlantID,RO_WorkCenterID,RO_EarliestStartDate,RO_ActivityTypeID,PlanCostingVariantID),0)]]>
                                                    </DefaultFormulaValue>
                                                </DataBinding>
                                                <CellFormat HAlign="Right"/>
                                            </GridCell>
                                            <GridCell Key="RO_CalculationKey" Caption="计算规则" CellType="ComboBox" IntegerValue="true" GroupKey="CalculationKey" SourceType="ParaGroup">
                                                <DataBinding ColumnKey="CalculationKey">
                                                    <ValueChanged>
                                                        <![CDATA[IIFS(RO_CalculationKey == 1, SetValue('RO_ProcessDuration', Macro_setOperationDurationTime(RO_ProcessDuration, RO_ProcessWorkTime, RO_ProcessWorkTimeUnitID, RO_NumberofCapacity, RO_ProcessDurationUnitID, RO_Percentage)), RO_CalculationKey == 2, SetValue('RO_ProcessWorkTime', Macro_setWorkActiveTime(RO_ProcessWorkTime, RO_ProcessWorkTimeUnitID, RO_NumberofCapacity, RO_ProcessDuration, RO_ProcessDurationUnitID, RO_Percentage)), RO_CalculationKey == 3, SetValue('RO_NumberofCapacity', Macro_setNumberofCapacities(RO_NumberofCapacity, RO_ProcessWorkTime, RO_ProcessWorkTimeUnitID, RO_ProcessDuration, RO_ProcessDurationUnitID, RO_Percentage)));]]>
                                                    </ValueChanged>
                                                </DataBinding>
                                            </GridCell>
                                            <GridCell Key="RO_Receive" Caption="接收方" CellType="TextEditor" MaxLength="50">
                                                <DataBinding ColumnKey="Receive"/>
                                            </GridCell>
                                            <GridCell Key="RO_UnloadingPoint" Caption="卸货点" CellType="TextEditor" MaxLength="100">
                                                <DataBinding ColumnKey="UnloadingPoint"/>
                                            </GridCell>
                                            <GridCell Key="RO_Requester" Caption="申请者" CellType="TextEditor" MaxLength="100">
                                                <DataBinding ColumnKey="Requester"/>
                                            </GridCell>
                                            <GridCell Key="RO_TrackingNumber" Caption="跟踪号" CellType="TextEditor">
                                                <DataBinding ColumnKey="TrackingNumber"/>
                                            </GridCell>
                                            <GridCell Key="RO_ExecutionFactor" Caption="执行因子" CellType="NumberEditor" Enable="false" Precision="9" Scale="0" UseGroupingSeparator="false">
                                                <DataBinding ColumnKey="ExecutionFactor"/>
                                            </GridCell>
                                            <GridCell Key="RO_IsComponentAllocation" Caption="组件" CellType="CheckBox" Enable="false">
                                                <DataBinding ColumnKey="IsComponentAllocation"/>
                                            </GridCell>
                                            <GridCell Key="RO_NotificationSOID" Caption="通知单" CellType="Dict" Enable="false" ItemKey="PM_Notification__Dic" StateMask="Enable|Disable|Discard">
                                                <DataBinding ColumnKey="NotificationSOID"/>
                                            </GridCell>
                                            <GridCell Key="RO_FunctionalLocationSOID" Caption="功能位置" CellType="Dict" Enable="false" ItemKey="PM_FunctionalLocation__Dic" StateMask="Enable|Disable|Discard">
                                                <DataBinding ColumnKey="FunctionalLocationSOID">
                                                    <CheckRule>
                                                        <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.checkAvailable(false, RO_FunctionalLocationSOID)]]>
                                                    </CheckRule>
                                                </DataBinding>
                                            </GridCell>
                                            <GridCell Key="RO_EquipmentSOID" Caption="设备" CellType="Dict" Enable="false" ItemKey="PM_Equipment__Dic" StateMask="Enable|Disable|Discard">
                                                <DataBinding ColumnKey="EquipmentSOID">
                                                    <CheckRule>
                                                        <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.checkAvailable(true, RO_EquipmentSOID)]]>
                                                    </CheckRule>
                                                </DataBinding>
                                            </GridCell>
                                            <GridCell Key="RO_IsOutsourcing" Caption="外协工序" CellType="CheckBox">
                                                <DataBinding ColumnKey="IsOutsourcing"/>
                                            </GridCell>
                                            <GridCell Key="RO_PurchasingOrganizationID" Caption="采购组织" CellType="Dict" ItemKey="PurchasingOrganization">
                                                <DataBinding ColumnKey="PurchasingOrganizationID" ValueDependency="RO_PlantID,OrderTypeID,RO_ControlCodeID">
                                                    <DefaultFormulaValue>
                                                        <![CDATA[IIF(RO_PurchasingOrganizationID > 0, RO_PurchasingOrganizationID, Macro_GetDefaultRoutingData('PurchasingOrganizationID'))]]>
                                                    </DefaultFormulaValue>
                                                </DataBinding>
                                            </GridCell>
                                            <GridCell Key="RO_PurchaseInfoRecordID" Caption="采购信息记录" CellType="Dict" ItemKey="MM_PurchaseInfoRecord">
                                                <DataBinding ColumnKey="PurchaseInfoRecordID"/>
                                            </GridCell>
                                            <GridCell Key="RO_PurchasingGroupID" Caption="采购组" CellType="Dict" ItemKey="PurchasingGroup">
                                                <DataBinding ColumnKey="PurchasingGroupID" ValueDependency="RO_PlantID,OrderTypeID,RO_ControlCodeID">
                                                    <CheckRule>
                                                        <![CDATA[IIF(Macro_IsExternal()&&RO_PurchasingGroupID<=0,MessageFacade('IW111','外协工序，请输入采购组'),true)]]>
                                                    </CheckRule>
                                                    <DefaultFormulaValue>
                                                        <![CDATA[IIF(RO_PurchasingGroupID > 0, RO_PurchasingGroupID, Macro_GetDefaultRoutingData('PurchasingGroupID'))]]>
                                                    </DefaultFormulaValue>
                                                </DataBinding>
                                            </GridCell>
                                            <GridCell Key="RO_CostElementID" Caption="成本要素" CellType="Dict" ItemKey="CO_CostElement">
                                                <DataBinding ColumnKey="CostElementID">
                                                    <CheckRule>
                                                        <![CDATA[IIF(Macro_IsExternalWithoutService()&&RO_CostElementID<=0,MessageFacade('IW113','外协工序，请输入成本要素'),true)]]>
                                                    </CheckRule>
                                                    <DefaultFormulaValue>
                                                        <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.getDefaultCostElement(RO_PlantID, OrderTypeID, RO_ActivityTypeID, RO_ControlCodeID, RO_MaterialGroupID, RO_CostElementID)]]>
                                                    </DefaultFormulaValue>
                                                </DataBinding>
                                                <ItemFilter>
                                                    <Filter Key="Filter" Impl="com.bokesoft.yes.erp.condition.Filter" Type="Custom">
                                                        <FilterValue Index="1" ParaValue="IIF(RO_PlantID&gt;0, &quot;ControllingAreaID = (select ControllingAreaID from EGS_COACAssignCpyCodeDtl where CompanyCodeID = (select CompanyCodeID from bk_plant where oid = &quot;&amp;SqlPara(RO_PlantID)&amp;&quot;))&quot;&amp;IIF(Macro_IsExternal(),&quot; and IsPrimaryCostEle = &quot;&amp;SqlPara(1),&quot;&quot;), &quot;1=2&quot;);"/>
                                                    </Filter>
                                                </ItemFilter>
                                            </GridCell>
                                            <GridCell Key="RO_ValueTypeID" Caption="数值种类" CellType="Dict" ItemKey="CO_ValueType">
                                                <DataBinding ColumnKey="ValueTypeID">
                                                    <DefaultFormulaValue>
                                                        <![CDATA[com.bokesoft.erp.co.formula.PMOrderCostFormula.getValueTypeByCostElement('PM',OrgControllingAreaID,RO_CostElementID)]]>
                                                    </DefaultFormulaValue>
                                                </DataBinding>
                                            </GridCell>
                                            <GridCell Key="RO_SortTerm" Caption="排序字符串" CellType="TextEditor" MaxLength="100" Trim="true">
                                                <DataBinding ColumnKey="SortTerm">
                                                    <DefaultFormulaValue>
                                                        <![CDATA[GetDictValue('MM_PurchaseInfoRecord', RO_PurchaseInfoRecordID, 'SortTerm')]]>
                                                    </DefaultFormulaValue>
                                                </DataBinding>
                                            </GridCell>
                                            <GridCell Key="RO_MaterialGroupID" Caption="物料组" CellType="Dict" ItemKey="MaterialGroup">
                                                <DataBinding ColumnKey="MaterialGroupID" ValueDependency="RO_PurchaseInfoRecordID,RO_PlantID,OrderTypeID,RO_ControlCodeID">
                                                    <CheckRule>
                                                        <![CDATA[IIF(Macro_IsExternal()&&RO_MaterialGroupID<=0,MessageFacade('IW117','外协工序，请输入物料组'),true)]]>
                                                    </CheckRule>
                                                    <DefaultFormulaValue>
                                                        <![CDATA[IIF(RO_PurchaseInfoRecordID > 0, GetDictValue('MM_PurchaseInfoRecord', RO_PurchaseInfoRecordID, 'MaterialGroupID'), IIF(RO_MaterialGroupID > 0, RO_MaterialGroupID, Macro_GetDefaultRoutingData('MaterialGroupID')))]]>
                                                    </DefaultFormulaValue>
                                                </DataBinding>
                                            </GridCell>
                                            <GridCell Key="RO_VendorID" Caption="供应商" CellType="Dict" ItemKey="Vendor">
                                                <DataBinding ColumnKey="VendorID">
                                                    <DefaultFormulaValue>
                                                        <![CDATA[GetDictValue('MM_PurchaseInfoRecord', RO_PurchaseInfoRecordID, 'VendorID')]]>
                                                    </DefaultFormulaValue>
                                                </DataBinding>
                                            </GridCell>
                                            <GridCell Key="RO_OperationQuantity" Caption="工序数量" CellType="NumberEditor" Scale="3">
                                                <DataBinding ColumnKey="OperationQuantity" DefaultValue="1">
                                                    <CheckRule>
                                                        <![CDATA[IIF(Macro_IsExternal()&&RO_OperationQuantity<=0,MessageFacade('IW109','外协工序，请输入工序数量'),true)]]>
                                                    </CheckRule>
                                                </DataBinding>
                                                <CellFormat HAlign="Right"/>
                                            </GridCell>
                                            <GridCell Key="RO_OperationBaseUnitID" Caption="工序基本单位" CellType="Dict" ItemKey="Unit">
                                                <DataBinding ColumnKey="OperationBaseUnitID">
                                                    <CheckRule>
                                                        <![CDATA[IIF(Macro_IsExternal()&&RO_OperationBaseUnitID<=0,MessageFacade('PM_MAINTENANCEORDER021','外协工序，请输入订单单位'),true)]]>
                                                    </CheckRule>
                                                    <DefaultFormulaValue>
                                                        <![CDATA[IIFS(RO_OperationBaseUnitID > 0, RO_OperationBaseUnitID,RO_PurchaseInfoRecordID > 0, GetDictValue('MM_PurchaseInfoRecord', RO_PurchaseInfoRecordID, 'PurchaseUnitID'),true, com.bokesoft.erp.pm.function.MaintenanceOrderFormula.getDefaultProcessUnitID(RO_PlantID, OrderTypeID));]]>
                                                    </DefaultFormulaValue>
                                                </DataBinding>
                                            </GridCell>
                                            <GridCell Key="RO_PlannedDeliveryDay" Caption="计划交货时间(天)" CellType="NumberEditor" Precision="9" Scale="0" UseGroupingSeparator="false">
                                                <DataBinding ColumnKey="PlannedDeliveryDay">
                                                    <CheckRule>
                                                        <![CDATA[IIF(Macro_IsExternal()&&RO_PlannedDeliveryDay<=0,MessageFacade('PM_MAINTENANCEORDER010','外协工序，请输入大于0的计划交付时间'),true)]]>
                                                    </CheckRule>
                                                    <DefaultFormulaValue>
                                                        <![CDATA[IIF(RO_PurchaseInfoRecordID>0&&RO_PurchasingOrganizationID>0,Macro_getPurchaseInfoRecordOrgPropAllowNull('PlannedDeliveryTime'),true)]]>
                                                    </DefaultFormulaValue>
                                                </DataBinding>
                                            </GridCell>
                                            <GridCell Key="RO_NetPriceQuantity" Caption="价格数量" CellType="NumberEditor" Scale="3">
                                                <DataBinding ColumnKey="NetPriceQuantity" DefaultFormulaValue="1">
                                                    <CheckRule>
                                                        <![CDATA[IIF(Macro_IsExternal()&&RO_NetPriceQuantity<=0,MessageFacade('PM_MAINTENANCEORDER011','外协工序，请输入大于0的价格数量'),true)]]>
                                                    </CheckRule>
                                                </DataBinding>
                                                <CellFormat HAlign="Right"/>
                                            </GridCell>
                                            <GridCell Key="RO_NetPrice" Caption="净价" CellType="NumberEditor" Scale="6">
                                                <DataBinding ColumnKey="NetPrice" ValueDependency="Service_ServiceSumMoney">
                                                    <DefaultFormulaValue>
                                                        <![CDATA[IIF(Macro_IsService(),Sum('Service_ServiceSumMoney'),RO_NetPrice)]]>
                                                    </DefaultFormulaValue>
                                                </DataBinding>
                                                <CellFormat HAlign="Right"/>
                                            </GridCell>
                                            <GridCell Key="RO_NetPriceCurrencyID" Caption="币种" CellType="Dict" ItemKey="Currency">
                                                <DataBinding ColumnKey="NetPriceCurrencyID">
                                                    <CheckRule>
                                                        <![CDATA[IIF(Macro_IsExternal()&&RO_NetPriceCurrencyID<=0,MessageFacade('IW107','外协工序，请输入币种'),true)]]>
                                                    </CheckRule>
                                                    <DefaultFormulaValue>
                                                        <![CDATA[GetDictValue('CompanyCode', GetDictValue('Plant', RO_PlantID, 'CompanyCodeID'), 'CurrencyID')]]>
                                                    </DefaultFormulaValue>
                                                </DataBinding>
                                            </GridCell>
                                            <GridCell Key="RO_IsSubcontract" Caption="转包" CellType="CheckBox">
                                                <DataBinding ColumnKey="IsSubcontract"/>
                                            </GridCell>
                                            <GridCell Key="RO_RequisitionCreationControl" Caption="预留/采购申请" CellType="ComboBox" IntegerValue="true" GroupKey="GenerateControl" SourceType="ParaGroup">
                                                <DataBinding ColumnKey="RequisitionCreationControl">
                                                    <ValueChanged>
                                                        <![CDATA[IIF(Macro_IsREL() && RO_RequisitionCreationControl == 2,  Macro_RevertResPurReq('O_ResPurReqRelevance'), true);]]>
                                                    </ValueChanged>
                                                    <DefaultFormulaValue>
                                                        <![CDATA[IIF(Macro_IsREL() && RO_RequisitionCreationControl == 2, 3, IIF(RO_RequisitionCreationControl < 1 && RequisitionCreationControl > 0, RequisitionCreationControl, RO_RequisitionCreationControl))]]>
                                                    </DefaultFormulaValue>
                                                </DataBinding>
                                            </GridCell>
                                            <GridCell Key="RO_DefineUserFieldID" Caption="字段码" CellType="Dict" ItemKey="PM_DefineUserField">
                                                <DataBinding ColumnKey="DefineUserFieldID"/>
                                            </GridCell>
                                            <GridCell Key="RO_UserFieldText1" Caption="Text1" CellType="TextEditor">
                                                <DataBinding ColumnKey="UserFieldText1"/>
                                            </GridCell>
                                            <GridCell Key="RO_UserFieldText2" Caption="Text2" CellType="TextEditor">
                                                <DataBinding ColumnKey="UserFieldText2"/>
                                            </GridCell>
                                            <GridCell Key="RO_UserFieldText3" Caption="Text3" CellType="TextEditor">
                                                <DataBinding ColumnKey="UserFieldText3"/>
                                            </GridCell>
                                            <GridCell Key="RO_UserFieldText4" Caption="Text4" CellType="TextEditor">
                                                <DataBinding ColumnKey="UserFieldText4"/>
                                            </GridCell>
                                            <GridCell Key="RO_UserFieldDate1Time" Caption="Date1" CellType="DatePicker">
                                                <DataBinding ColumnKey="UserFieldDate1Time"/>
                                            </GridCell>
                                            <GridCell Key="RO_UserFieldDate2Time" Caption="Date2" CellType="DatePicker">
                                                <DataBinding ColumnKey="UserFieldDate2Time"/>
                                            </GridCell>
                                            <GridCell Key="RO_UserFieldNumber1" Caption="Number1" CellType="NumberEditor">
                                                <DataBinding ColumnKey="UserFieldNumber1"/>
                                                <CellFormat HAlign="Right"/>
                                            </GridCell>
                                            <GridCell Key="RO_UserFieldNumber1UnitID" Caption="Number1UnitID" CellType="Dict" ItemKey="Unit">
                                                <DataBinding ColumnKey="UserFieldNumber1UnitID"/>
                                            </GridCell>
                                            <GridCell Key="RO_UserFieldNumber2" Caption="Number2" CellType="NumberEditor">
                                                <DataBinding ColumnKey="UserFieldNumber2"/>
                                                <CellFormat HAlign="Right"/>
                                            </GridCell>
                                            <GridCell Key="RO_UserFieldNumber2UnitID" Caption="Number1UnitID" CellType="Dict" ItemKey="Unit">
                                                <DataBinding ColumnKey="UserFieldNumber2UnitID"/>
                                            </GridCell>
                                            <GridCell Key="RO_UserFieldValue1" Caption="Value1" CellType="NumberEditor">
                                                <DataBinding ColumnKey="UserFieldValue1"/>
                                                <CellFormat HAlign="Right"/>
                                            </GridCell>
                                            <GridCell Key="RO_UserFieldValue1CurrencyID" Caption="Value1CurrencyID" CellType="Dict" ItemKey="Currency">
                                                <DataBinding ColumnKey="UserFieldValue1CurrencyID"/>
                                            </GridCell>
                                            <GridCell Key="RO_UserFieldValue2" Caption="Value2" CellType="NumberEditor">
                                                <DataBinding ColumnKey="UserFieldValue2"/>
                                                <CellFormat HAlign="Right"/>
                                            </GridCell>
                                            <GridCell Key="RO_UserFieldValue2CurrencyID" Caption="Value2CurrencyID" CellType="Dict" ItemKey="Currency">
                                                <DataBinding ColumnKey="UserFieldValue2CurrencyID"/>
                                            </GridCell>
                                            <GridCell Key="RO_IsUserFieldCheckBox1" Caption="CheckBox1" CellType="CheckBox">
                                                <DataBinding ColumnKey="IsUserFieldCheckBox1"/>
                                            </GridCell>
                                            <GridCell Key="RO_IsUserFieldCheckBox2" Caption="CheckBox2" CellType="CheckBox">
                                                <DataBinding ColumnKey="IsUserFieldCheckBox2"/>
                                            </GridCell>
                                            <GridCell Key="RO_Money" Caption="金额" CellType="NumberEditor">
                                                <DataBinding ColumnKey="Money"/>
                                                <CellFormat HAlign="Right"/>
                                            </GridCell>
                                            <GridCell Key="RO_SourseRoutingDtlOID" Caption="RO_SourseRoutingDtlOID" CellType="NumberEditor" Scale="0" UseGroupingSeparator="false">
                                                <DataBinding ColumnKey="SourseRoutingDtlOID"/>
                                            </GridCell>
                                            <GridCell Key="RO_RoutingID" Caption="RO_RoutingID" CellType="Dict" Enable="false" ItemKey="PP_Routing">
                                                <DataBinding ColumnKey="RoutingID"/>
                                            </GridCell>
                                            <GridCell Key="RO_SOID" CellType="NumberEditor" Scale="0">
                                                <DataBinding ColumnKey="SOID"/>
                                            </GridCell>
                                            <GridCell Key="RO_SrcOID" Caption="SrcOID" CellType="NumberEditor" Enable="false">
                                                <DataBinding ColumnKey="SrcOID" DefaultFormulaValue="SOID"/>
                                                <CellFormat HAlign="Right"/>
                                            </GridCell>
                                            <GridCell Key="RO_SrcSOID" Caption="SrcSOID" CellType="NumberEditor" Enable="false">
                                                <DataBinding ColumnKey="SrcSOID" DefaultFormulaValue="SOID"/>
                                                <CellFormat HAlign="Right"/>
                                            </GridCell>
                                            <GridCell Key="RO_SrcFormKey" Caption="SrcFormKey" CellType="TextEditor" Enable="false">
                                                <DataBinding ColumnKey="SrcFormKey" DefaultValue="PM_MaintenanceOrder"/>
                                            </GridCell>
                                            <GridCell Key="RO_ServiceConfirmQuantity" Caption="服务确认数量" CellType="NumberEditor" Scale="3">
                                                <DataBinding ColumnKey="ServiceConfirmQuantity"/>
                                                <CellFormat HAlign="Right"/>
                                            </GridCell>
                                            <GridCell Key="RO_IsCompleted" Caption="已完成" CellType="CheckBox">
                                                <DataBinding ColumnKey="IsCompleted" ValueDependency="ES_IsActive,ES_ERPSystemStatusID">
                                                    <DefaultFormulaValue>
                                                        <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.routingIsCompleted()]]>
                                                    </DefaultFormulaValue>
                                                </DataBinding>
                                            </GridCell>
                                            <GridCell Key="RO_StatusItem" Caption="工序状态" CellType="ComboBox" Enable="false" IntegerValue="true">
                                                <DataBinding ColumnKey="StatusItem" DefaultFormulaValue="0"/>
                                                <Item Key="0" Value="0"/>
                                                <Item Key="1" Caption="删除" Value="1"/>
                                            </GridCell>
                                            <GridCell Key="Dtl_ExternalSystemPrimaryKey" Caption="外部系统关键字" CellType="TextEditor">
                                                <DataBinding ColumnKey="ExternalSystemPrimaryKey"/>
                                            </GridCell>
                                        </GridRow>
                                    </GridRowCollection>
                                    <OnRowDelete>
                                        <![CDATA[Macro_DeleteRoutingDtl_ExtOpt()]]>
                                    </OnRowDelete>
                                    <ExtOptCollection>
                                        <ExtOpt Key="DeleteRouting" Caption="维护订单工序删除" Icon="../Resource/images/PM_MaintenanceOrder/delete.png">
                                            <![CDATA[Macro_DeleteRoutingDtl_ExtOpt()]]>
                                        </ExtOpt>
                                    </ExtOptCollection>
                                    <GridFilter Op="OR">
                                        <FilterValue Index="1" FieldKey="RO_StatusItem" RefValue="ToBool(GetPara('_IsDisplayDeletions'))" DataType="Integer"/>
                                        <FilterValue Index="2" FieldKey="RO_StatusItem" RefValue="0" DataType="Integer"/>
                                    </GridFilter>
                                </Grid>
                                <SplitSize Size="100%"/>
                            </SplitPanel>
                            <TabPanel Key="RoutingMirrorTabPanel">
                                <SubDetail Key="RoutingMirrorGeneralSubDetail" Caption="常规" BindingGridKey="MaintenanceOrder_RoutingGrid">
                                    <GridLayoutPanel Key="RoutingMirrorGeneralGridLayoutPanel" Caption="常规" Padding="8px" OverflowY="Auto" TopPadding="24px">
                                        <NumberEditor Key="RO_ExecutionFactor__mirror" Caption="执行因子" X="0" Y="0" Visible="true" BindingCellKey="RO_ExecutionFactor" IntegerValue="true" Scale="0" UseGroupingSeparator="false" XSpan="2"/>
                                        <Dict Key="RO_WorkCenterID__mirror" Caption="工作中心" X="0" Y="1" Visible="true" BindingCellKey="RO_WorkCenterID" ItemKey="WorkCenter"/>
                                        <Dict Key="RO_PlantID__mirror" Caption="工厂" X="1" Y="1" Visible="true" BindingCellKey="RO_PlantID" ItemKey="Plant"/>
                                        <Dict Key="RO_ControlCodeID__mirror" Caption="控制码" X="2" Y="0" Visible="true" BindingCellKey="RO_ControlCodeID" ItemKey="PP_ControlCode"/>
                                        <Dict Key="RO_FunctionalLocationSOID__mirror" Caption="功能位置" X="3" Y="0" Visible="true" BindingCellKey="RO_FunctionalLocationSOID" ItemKey="PM_FunctionalLocation__Dic" StateMask="Enable|Disable|Discard"/>
                                        <Dict Key="RO_EquipmentSOID__mirror" Caption="设备" X="3" Y="1" Visible="true" BindingCellKey="RO_EquipmentSOID" ItemKey="PM_Equipment__Dic" StateMask="Enable|Disable|Discard"/>
                                        <Dict Key="RO_NotificationSOID__mirror" Caption="通知单" X="4" Y="0" Visible="true" Enable="false" BindingCellKey="RO_NotificationSOID" ItemKey="PM_Notification__Dic" StateMask="Enable|Disable|Discard"/>
                                        <Dict Key="RO_OperatingConditionID__mirror" Caption="系统条件" X="2" Y="1" BindingCellKey="RO_OperatingConditionID" ItemKey="PM_OperatingCondition">
                                            <DataBinding/>
                                        </Dict>
                                        <RowDefCollection RowGap="24">
                                            <RowDef Height="32px"/>
                                            <RowDef Height="32px"/>
                                        </RowDefCollection>
                                        <ColumnDefCollection ColumnGap="16">
                                            <ColumnDef Width="17%"/>
                                            <ColumnDef Width="8%"/>
                                            <ColumnDef Width="25%"/>
                                            <ColumnDef Width="25%"/>
                                            <ColumnDef Width="25%"/>
                                        </ColumnDefCollection>
                                    </GridLayoutPanel>
                                </SubDetail>
                                <SubDetail Key="RoutingMirrorInternalSubDetail" Caption="内部" BindingGridKey="MaintenanceOrder_RoutingGrid">
                                    <GridLayoutPanel Key="RoutingMirrorInternalGridLayoutPanel" Caption="内部" Padding="8px" OverflowY="Auto" TopPadding="24px">
                                        <Dict Key="RO_WorkCenterID__mirror2" Caption="工作中心" X="0" Y="0" Visible="true" BindingCellKey="RO_WorkCenterID" ItemKey="WorkCenter"/>
                                        <Dict Key="RO_PlantID__mirror2" Caption="工厂" X="1" Y="0" Visible="true" BindingCellKey="RO_PlantID" ItemKey="Plant"/>
                                        <Dict Key="RO_ActivityTypeID__mirror" Caption="活动类型" X="2" Y="0" Visible="true" BindingCellKey="RO_ActivityTypeID" ItemKey="CO_ActivityType"/>
                                        <ComboBox Key="RO_CalculationKey__mirror" Caption="计算规则" X="3" Y="0" Visible="true" SourceType="ParaGroup" BindingCellKey="RO_CalculationKey" IntegerValue="true" GroupKey="CalculationKey"/>
                                        <Dict Key="RO_ControlCodeID__mirror2" Caption="控制码" X="0" Y="1" Visible="true" BindingCellKey="RO_ControlCodeID" ItemKey="PP_ControlCode"/>
                                        <NumberEditor Key="RO_ProcessWorkTime__mirror" Caption="工作量" X="0" Y="2" Visible="true" BindingCellKey="RO_ProcessWorkTime" Scale="1"/>
                                        <Dict Key="RO_ProcessWorkTimeUnitID__mirror" Caption="单位" X="1" Y="2" Visible="true" BindingCellKey="RO_ProcessWorkTimeUnitID" ItemKey="Unit"/>
                                        <NumberEditor Key="RO_NumberofCapacity__mirror" Caption="能力数" X="2" Y="2" Visible="true" BindingCellKey="RO_NumberofCapacity" IntegerValue="true" Scale="0" UseGroupingSeparator="false">
                                            <DataBinding/>
                                        </NumberEditor>
                                        <NumberEditor Key="RO_ProcessDuration__mirror" Caption="工序持续时间" X="3" Y="2" Visible="true" BindingCellKey="RO_ProcessDuration" Scale="1"/>
                                        <Dict Key="RO_ProcessDurationUnitID__mirror" Caption="工序持续单位" X="4" Y="2" Visible="true" BindingCellKey="RO_ProcessDurationUnitID" ItemKey="Unit"/>
                                        <NumberEditor Key="RO_Percentage__mirror" Caption="%" X="5" Y="2" Visible="true" BindingCellKey="RO_Percentage" Scale="0">
                                            <DataBinding>
                                                <CheckRule>
                                                    <![CDATA[IIF(RO_Percentage__mirror<0 || RO_Percentage__mirror>255, MessageFacade('00059','请输入正确值'), true)]]>
                                                </CheckRule>
                                            </DataBinding>
                                            <Format HAlign="Right"/>
                                        </NumberEditor>
                                        <RowDefCollection RowGap="24">
                                            <RowDef Height="32px"/>
                                            <RowDef Height="32px"/>
                                            <RowDef Height="32px"/>
                                        </RowDefCollection>
                                        <ColumnDefCollection ColumnGap="16">
                                            <ColumnDef Width="300px"/>
                                            <ColumnDef Width="150px"/>
                                            <ColumnDef Width="300px"/>
                                            <ColumnDef Width="200px"/>
                                            <ColumnDef Width="150px"/>
                                            <ColumnDef Width="150px"/>
                                        </ColumnDefCollection>
                                    </GridLayoutPanel>
                                </SubDetail>
                                <SubDetail Key="RoutingMirrorExternalSubDetail" Caption="外部的" BindingGridKey="MaintenanceOrder_RoutingGrid">
                                    <GridLayoutPanel Key="RoutingMirrorExternalGridLayoutPanel" Caption="外部的" Padding="8px" OverflowY="Auto" TopPadding="24px">
                                        <NumberEditor Key="RO_OperationQuantity__mirror" Caption="工序数量" X="0" Y="0" Visible="true" Enable="!ReadOnly()" BindingCellKey="RO_OperationQuantity" Scale="3"/>
                                        <Dict Key="RO_OperationBaseUnitID__mirror" Caption="单位" X="1" Y="0" Visible="true" BindingCellKey="RO_OperationBaseUnitID" ItemKey="Unit"/>
                                        <TextEditor Key="RO_SortTerm__mirror" Caption="排序字符串" X="2" Y="0" Visible="true" BindingCellKey="RO_SortTerm" MaxLength="100" Trim="true"/>
                                        <NumberEditor Key="RO_NetPrice__mirror" Caption="价格" X="0" Y="1" Visible="true" Enable="!ReadOnly()&amp;&amp;(!Macro_IsExternal()||!Macro_IsService())" BindingCellKey="RO_NetPrice" Scale="3"/>
                                        <Dict Key="RO_NetPriceCurrencyID__mirror" Caption="币种" X="1" Y="1" Visible="true" Enable="!ReadOnly()&amp;&amp;!Macro_IsService()" BindingCellKey="RO_NetPriceCurrencyID" ItemKey="Currency"/>
                                        <NumberEditor Key="RO_NetPriceQuantity__mirror" Caption="价格数量" X="2" Y="1" Visible="true" Enable="!ReadOnly()&amp;&amp;!Macro_IsExternalWithService()" BindingCellKey="RO_NetPriceQuantity" Scale="3"/>
                                        <Dict Key="RO_MaterialGroupID__mirror" Caption="物料组" X="3" Y="0" Visible="true" BindingCellKey="RO_MaterialGroupID" ItemKey="MaterialGroup"/>
                                        <Dict Key="RO_CostElementID__mirror" Caption="成本要素" X="2" Y="2" Visible="true" Enable="!ReadOnly()&amp;&amp;!Macro_IsExternalWithService()" BindingCellKey="RO_CostElementID" ItemKey="CO_CostElement"/>
                                        <Dict Key="RO_PurchasingGroupID__mirror" Caption="采购组" X="0" Y="2" Visible="true" BindingCellKey="RO_PurchasingGroupID" ItemKey="PurchasingGroup"/>
                                        <Dict Key="RO_PurchasingOrganizationID__mirror" Caption="采购组织" X="1" Y="2" Visible="true" BindingCellKey="RO_PurchasingOrganizationID" ItemKey="PurchasingOrganization"/>
                                        <Dict Key="RO_VendorID__mirror" Caption="供应商" X="4" Y="2" Visible="true" BindingCellKey="RO_VendorID" ItemKey="Vendor"/>
                                        <Dict Key="RO_PurchaseInfoRecordID__mirror" Caption="采购信息记录" X="3" Y="1" Visible="true" Enable="!ReadOnly()&amp;&amp;!Macro_IsExternalWithService()" BindingCellKey="RO_PurchaseInfoRecordID" ItemKey="MM_PurchaseInfoRecord"/>
                                        <CheckBox Key="RO_IsSubcontract__mirror" Caption="转包" X="5" Y="0" Visible="!IsRefurbishment" BindingCellKey="RO_IsSubcontract"/>
                                        <NumberEditor Key="RO_PlannedDeliveryDay__mirror" Caption="计划交货时间(天)" X="4" Y="1" Visible="true" BindingCellKey="RO_PlannedDeliveryDay" IntegerValue="true" Scale="0" UseGroupingSeparator="false"/>
                                        <TextEditor Key="RO_Receive__mirror" Caption="接收方" X="3" Y="2" BindingCellKey="RO_Receive">
                                            <DataBinding/>
                                        </TextEditor>
                                        <TextEditor Key="RO_UnloadingPoint__mirror" Caption="卸货点" X="5" Y="1" BindingCellKey="RO_UnloadingPoint" MaxLength="100">
                                            <DataBinding/>
                                        </TextEditor>
                                        <TextEditor Key="RO_Requester__mirror" Caption="申请者" X="4" Y="0" Visible="true" BindingCellKey="RO_Requester">
                                            <DataBinding/>
                                        </TextEditor>
                                        <TextEditor Key="RO_TrackingNumber__mirror" Caption="跟踪号" X="5" Y="2" Visible="true" BindingCellKey="RO_TrackingNumber">
                                            <DataBinding/>
                                        </TextEditor>
                                        <RowDefCollection RowGap="24">
                                            <RowDef Height="32px"/>
                                            <RowDef Height="32px"/>
                                            <RowDef Height="32px"/>
                                        </RowDefCollection>
                                        <ColumnDefCollection ColumnGap="16">
                                            <ColumnDef Width="16%"/>
                                            <ColumnDef Width="16%"/>
                                            <ColumnDef Width="17%"/>
                                            <ColumnDef Width="17%"/>
                                            <ColumnDef Width="17%"/>
                                            <ColumnDef Width="17%"/>
                                        </ColumnDefCollection>
                                    </GridLayoutPanel>
                                </SubDetail>
                                <SubDetail Key="RoutingMirrorDateSubDetail" Caption="日期" BindingGridKey="MaintenanceOrder_RoutingGrid">
                                    <GridLayoutPanel Key="RoutingMirrorDateGridLayoutPanel" Caption="日期" Padding="8px" OverflowY="Auto" TopPadding="24px">
                                        <UTCDatePicker Key="RO_EarliestStartDate__mirror" Caption="最早开始" X="0" Y="0" Visible="true" Enable="false" BindingCellKey="RO_EarliestStartDate" Format="yyyy-MM-dd"/>
                                        <TimePicker Key="RO_EarliestStartTime__mirror" Caption="最早开始时间" BindingCellKey="RO_EarliestStartTime" Enable="false" Second="true" Visible="true" X="1" Y="0"/>
                                        <UTCDatePicker Key="RO_EarliestEndDate__mirror" Caption="最早完成" X="2" Y="0" Visible="true" Enable="false" BindingCellKey="RO_EarliestEndDate" Format="yyyy-MM-dd"/>
                                        <TimePicker Key="RO_EarliestEndTime__mirror" Caption="最早完成时间" BindingCellKey="RO_EarliestEndTime" Enable="false" Second="true" Visible="true" X="3" Y="0"/>
                                        <UTCDatePicker Key="RO_LatestStartDate__mirror" Caption="最迟开始" X="0" Y="1" Visible="true" Enable="false" BindingCellKey="RO_LatestStartDate" Format="yyyy-MM-dd"/>
                                        <TimePicker Key="RO_LatestStartTime__mirror" Caption="最迟开始时间" BindingCellKey="RO_LatestStartTime" Enable="false" Second="true" Visible="true" X="1" Y="1"/>
                                        <UTCDatePicker Key="RO_LatestEndDate__mirror" Caption="最迟完成" X="2" Y="1" Visible="true" Enable="false" BindingCellKey="RO_LatestEndDate" Format="yyyy-MM-dd"/>
                                        <TimePicker Key="RO_LatestEndTime__mirror" Caption="最迟完成时间" BindingCellKey="RO_LatestEndTime" Enable="false" Second="true" Visible="true" X="3" Y="1"/>
                                        <UTCDatePicker Key="RO_ActualStartDate__mirror" Caption="实际开始" X="0" Y="2" Visible="true" Enable="false" BindingCellKey="RO_ActualStartDate" Format="yyyy-MM-dd"/>
                                        <TimePicker Key="RO_ActualStartTime__mirror" Caption="实际开始时间" BindingCellKey="RO_ActualStartTime" Enable="false" Second="true" Visible="true" X="1" Y="2"/>
                                        <TimePicker Key="RO_ActualEndTime__mirror" Caption="实际完成时间" BindingCellKey="RO_ActualEndTime" Enable="false" Second="true" Visible="true" X="1" Y="3"/>
                                        <TimePicker Key="RO_ForecastEndTime__mirror" Caption="预测完成时间" BindingCellKey="RO_ForecastEndTime" Enable="false" Second="true" Visible="true" X="3" Y="2"/>
                                        <UTCDatePicker Key="RO_ActualEndDate__mirror" Caption="实际完成" X="0" Y="3" Visible="true" Enable="false" BindingCellKey="RO_ActualEndDate" Format="yyyy-MM-dd"/>
                                        <UTCDatePicker Key="RO_ForecastEndDate__mirror" Caption="预测完成" X="2" Y="2" Visible="true" Enable="false" BindingCellKey="RO_ForecastEndDate" Format="yyyy-MM-dd"/>
                                        <ComboBox Key="RO_StartPoint__mirror" Caption="起点" X="4" Y="1" Visible="true" SourceType="ParaGroup" BindingCellKey="RO_StartPoint" Cache="false" GroupKey="ActivityStartDateLimit">
                                            <DataBinding/>
                                        </ComboBox>
                                        <ComboBox Key="RO_Ended__mirror" Caption="结束" X="4" Y="2" Visible="true" SourceType="ParaGroup" BindingCellKey="RO_Ended" Cache="false" GroupKey="ActivityEndDateLimit">
                                            <DataBinding/>
                                        </ComboBox>
                                        <UTCDatePicker Key="RO_StartLimitDate__mirror" Caption="作业开始日期" X="5" Y="1" Visible="true" BindingCellKey="RO_StartLimitDate">
                                            <DataBinding/>
                                        </UTCDatePicker>
                                        <TimePicker Key="RO_StartLimitTime__mirror" Caption="作业开始时间" BindingCellKey="RO_StartLimitTime" Second="true" Visible="true" X="6" Y="1">
                                            <DataBinding/>
                                        </TimePicker>
                                        <UTCDatePicker Key="RO_EndLimitDate__mirror" Caption="作业完成日期" X="5" Y="2" Visible="true" BindingCellKey="RO_EndLimitDate">
                                            <DataBinding/>
                                        </UTCDatePicker>
                                        <TimePicker Key="RO_EndLimitTime__mirror" Caption="作业完成时间" BindingCellKey="RO_EndLimitTime" Second="true" Visible="true" X="6" Y="2">
                                            <DataBinding/>
                                        </TimePicker>
                                        <Label Key="LimitLab" Caption="限制" X="4" Y="0" Visible="true" Enable="false" Class="erp-group-title">
                                            <DataBinding/>
                                        </Label>
                                        <RowDefCollection RowGap="24">
                                            <RowDef Height="32px"/>
                                            <RowDef Height="32px"/>
                                            <RowDef Height="32px"/>
                                            <RowDef Height="32px"/>
                                        </RowDefCollection>
                                        <ColumnDefCollection ColumnGap="16">
                                            <ColumnDef Width="120px"/>
                                            <ColumnDef Width="120px"/>
                                            <ColumnDef Width="120px"/>
                                            <ColumnDef Width="120px"/>
                                            <ColumnDef Width="170px"/>
                                            <ColumnDef Width="120px"/>
                                            <ColumnDef Width="120px"/>
                                        </ColumnDefCollection>
                                    </GridLayoutPanel>
                                </SubDetail>
                                <SubDetail Key="RoutingMirrorActualDataSubDetail" Caption="实际数据" BindingGridKey="MaintenanceOrder_RoutingGrid">
                                    <GridLayoutPanel Key="RoutingMirrorActualDataGridLayoutPanel" Caption="实际数据" Padding="8px" OverflowY="Auto">
                                        <Label Key="ConfirmLab" Caption="完成确认" X="0" Y="0" Visible="true" Enable="false" Class="erp-group-title"/>
                                        <Label Key="PurchaseLab" Caption="采购" X="3" Y="0" Visible="true" Enable="false" Class="erp-group-title"/>
                                        <TextEditor Key="RO_ConfirmationDocNo__mirror" Caption="确认" X="0" Y="1" Visible="true" Enable="false" BindingCellKey="RO_ConfirmationDocNo" MaxLength="100" Trim="true"/>
                                        <NumberEditor Key="RO_ActualWorkTime__mirror" Caption="实际工作时长" X="1" Y="1" Visible="true" Enable="false" BindingCellKey="RO_ActualWorkTime"/>
                                        <Dict Key="RO_ProcessWorkTimeUnitID__mirror1" Caption="工作量单位" X="2" Y="1" Visible="true" Enable="false" BindingCellKey="RO_ProcessWorkTimeUnitID" ItemKey="Unit">
                                            <ItemFilter>
                                                <Filter Key="Filter" Impl="com.bokesoft.yes.erp.condition.Filter" Type="Custom">
                                                    <FilterValue Index="1" ParaValue="'soid in (SELECT soid FROM BK_Unit WHERE UnitSystemID IN (SELECT soid FROM BK_UnitSystem WHERE UnitTime = '&amp;SqlPara(1)&amp;'))'"/>
                                                </Filter>
                                            </ItemFilter>
                                        </Dict>
                                        <CheckBox Key="RO_IsNoRemainingWork__mirror" Caption="没有剩余工作" X="0" Y="2" Visible="true" Enable="false" BindingCellKey="RO_IsNoRemainingWork"/>
                                        <NumberEditor Key="RO_ForecastWorkTime__mirror" Caption="预测工作时长" X="1" Y="2" Visible="true" Enable="false" BindingCellKey="RO_ForecastWorkTime"/>
                                        <Dict Key="RO_PurchaseReqSOID__mirror" Caption="采购申请" X="3" Y="1" Visible="true" Enable="false" BindingCellKey="RO_PurchaseReqSOID" ItemKey="MM_PurchaseRequisition__Dic" StateMask="Enable|Disable|Discard"/>
                                        <TextEditor Key="RO_PurchaseRequisitioItem__mirror" Caption="采购申请项目" X="3" Y="2" Visible="true" Enable="false" BindingCellKey="RO_PurchaseRequisitioItem" MaxLength="100" Trim="true"/>
                                        <NumberEditor Key="RO_GRQuantity__mirror" Caption="GR数量" X="4" Y="1" Visible="true" Enable="false" BindingCellKey="RO_GRQuantity" Scale="3"/>
                                        <Dict Key="RO_GRUnitID__mirror" Caption="GR单位" X="5" Y="1" Visible="true" Enable="false" BindingCellKey="RO_GRUnitID" ItemKey="Unit"/>
                                        <CheckBox Key="IsO_PurchaseOrdExists__mirror" Caption="采购订单存在" X="4" Y="2" Visible="true" Enable="false" BindingCellKey="RO_IsPurchaseOrdExists">
                                            <DataBinding/>
                                        </CheckBox>
                                        <RowDefCollection RowGap="24">
                                            <RowDef Height="32px"/>
                                            <RowDef Height="32px"/>
                                            <RowDef Height="32px"/>
                                        </RowDefCollection>
                                        <ColumnDefCollection ColumnGap="16">
                                            <ColumnDef Width="16%"/>
                                            <ColumnDef Width="16%"/>
                                            <ColumnDef Width="17%"/>
                                            <ColumnDef Width="17%"/>
                                            <ColumnDef Width="17%"/>
                                            <ColumnDef Width="17%"/>
                                        </ColumnDefCollection>
                                    </GridLayoutPanel>
                                </SubDetail>
                                <SubDetail Key="RoutingServiceSubDetail" Caption="服务" BindingGridKey="MaintenanceOrder_RoutingGrid">
                                    <FlexFlowLayoutPanel Key="RoutingServiceFlexFlowLayoutPanel" Caption="服务" Visible="Macro_IsService()" Padding="8px">
                                        <Embed Key="MM_PR_ServicesDtl_Impl" FormKey="MM_PR_ServicesDtl_Impl" RootKey="MM_PR_ServicesDtl_ImplRoot" Height="100%">
                                            <Var Key="ParentKey" Value="EPM_MaintOrder_Routing"/>
                                        </Embed>
                                    </FlexFlowLayoutPanel>
                                </SubDetail>
                                <SubDetail Key="RoutingComponentsAllocatedSubDetail" Caption="分配的组件" BindingGridKey="MaintenanceOrder_RoutingGrid">
                                    <GridLayoutPanel Key="RoutingComponentsAllocatedGridLayoutPanel" Caption="分配的组件" OverflowY="Auto" Visible="false">
                                        <Grid Key="RoutingComponentsAllocatedGrid" Caption="分配的组件" NewEmptyRow="false" SerialSeq="true" X="0" Y="0" Padding="8px">
                                            <GridColumnCollection>
                                                <GridColumn Key="NS_IsSelect" Width="32px"/>
                                                <GridColumn Key="NS_POID" Caption="NS_POID" Visible="Macro_DebugMode()" Width="80px" Sortable="true"/>
                                                <GridColumn Key="NS_ProcessNo" Caption="项目" LabelType="H" Width="80px" Sortable="true"/>
                                                <GridColumn Key="NS_MaterialID" Caption="组件" Width="80px" Sortable="true"/>
                                                <GridColumn Key="NS_ShortText" Caption="短文本" LabelType="H" Width="80px" Sortable="true"/>
                                                <GridColumn Key="NS_RequirementQuantity" Caption="需求数量" LabelType="H" Width="100px" Sortable="true"/>
                                                <GridColumn Key="NS_RequirementDate" Caption="需求日期" LabelType="H" Width="100px" Sortable="true"/>
                                                <GridColumn Key="NS_RequirementTime" Caption="需求时间" LabelType="H" Width="80px" Sortable="true"/>
                                                <GridColumn Key="NS_OffsetPos" Caption="偏置" LabelType="H" Width="80px" Sortable="true"/>
                                                <GridColumn Key="NS_OffsetUnitID" Caption="偏置单位" Width="80px" Sortable="true"/>
                                                <GridColumn Key="NS_IsManualReqDateIndicator" Caption="手工需求日期" LabelType="M" Width="120px" Sortable="true"/>
                                                <GridColumn Key="NS_ReservationSOID" Caption="预留" LabelType="M" Width="80px" Sortable="true"/>
                                                <GridColumn Key="NS_ReservationDtlOID" Caption="预留明细号" Visible="Macro_DebugMode()" Width="100px" Sortable="true"/>
                                                <GridColumn Key="NS_ReservationItem" Caption="预留项目" LabelType="H" Width="80px" Sortable="true"/>
                                                <GridColumn Key="NS_MoveTypeID" Caption="移动类型" LabelType="M" Width="80px" Sortable="true"/>
                                                <GridColumn Key="NS_CommittedQuantity" Caption="允许数量" LabelType="H" Width="100px" Sortable="true"/>
                                                <GridColumn Key="NS_RequisiteQuantity" Caption="领料数量" Width="100px" Sortable="true"/>
                                                <GridColumn Key="NS_BaseUnitID" Caption="基本单位" LabelType="M" Width="80px" Sortable="true"/>
                                                <GridColumn Key="NS_DivisionID" Caption="产品部门" LabelType="H" Width="80px" Sortable="true"/>
                                                <GridColumn Key="NS_IsFixedQuantity" Caption="数量固定" LabelType="L" Width="80px" Sortable="true"/>
                                                <GridColumn Key="NS_IsFinalDelivery" Caption="最后的发货" Width="100px" Sortable="true"/>
                                                <GridColumn Key="NS_ItemCategoryID" Caption="项目类别" LabelType="M" Width="80px" Sortable="true"/>
                                                <GridColumn Key="NS_PlantID" Caption="工厂" LabelType="H" Width="80px" Sortable="true"/>
                                                <GridColumn Key="NS_StorageLocationID" Caption="库存地点" LabelType="M" Width="80px" Sortable="true"/>
                                                <GridColumn Key="NS_RefProcessNo" Caption="对应的工序" Width="100px" Sortable="true"/>
                                                <GridColumn Key="NS_BatchCode" Caption="批次" LabelType="H" Width="80px" Sortable="true"/>
                                                <GridColumn Key="NS_IsDelete" Caption="已删除" Width="80px" Sortable="true"/>
                                                <GridColumn Key="NS_IsBulkMaterial" Caption="散装物料" LabelType="M" Width="80px" Sortable="true"/>
                                                <GridColumn Key="NS_IsBackFlush" Caption="反冲" LabelType="M" Width="80px" Sortable="true"/>
                                                <GridColumn Key="NS_IsAllowedMovment" Caption="允许的货物移动" LabelType="H" Width="80px" Sortable="true"/>
                                                <GridColumn Key="NS_ResPurReqRelevance" Caption="预留/采购申请" LabelType="H" Width="80px" Sortable="true"/>
                                                <GridColumn Key="NS_RelevancyToCostingID" Caption="成本核算相关" LabelType="H" Width="120px" Sortable="true"/>
                                                <GridColumn Key="NS_ProvisionIndicator" Caption="物料供应标识" LabelType="M" Width="120px" Sortable="true"/>
                                                <GridColumn Key="NS_AccountAssignmentCategoryID" Caption="科目分配类别" LabelType="M" Width="120px" Sortable="true"/>
                                                <GridColumn Key="NS_SpecialIdentity" Caption="特殊库存标识" LabelType="M" Visible="OrgWBSElementID&gt;0 || OrgSaleOrderDtlOID&gt;0" Width="120px" Sortable="true"/>
                                                <GridColumn Key="NS_DynIdentityID" Caption="特殊库存" LabelType="H" Width="80px" Sortable="true"/>
                                                <GridColumn Key="NS_DynIdentityIDDEKey" Caption="特殊库存字典Key" LabelType="H" Visible="false" Width="80px" Sortable="true"/>
                                                <GridColumn Key="NS_ValuationSpecialStock" Caption="评估" LabelType="M" Width="80px" Sortable="true"/>
                                                <GridColumn Key="NS_ConsumptionIndicator" Caption="消耗过账" LabelType="M" Width="80px" Sortable="true"/>
                                                <GridColumn Key="NS_PlannedDeliveryDay" Caption="计划交货时间(天)" Width="80px" Sortable="true"/>
                                                <GridColumn Key="NS_NetPriceQuantity" Caption="价格数量" LabelType="H" Width="100px" Sortable="true"/>
                                                <GridColumn Key="NS_NetPrice" Caption="净价" LabelType="H" Width="80px" Sortable="true"/>
                                                <GridColumn Key="NS_NetPriceCurrencyID" Caption="币种" LabelType="H" Visible="false" Width="80px" Sortable="true"/>
                                                <GridColumn Key="NS_PurchasingOrganizationID" Caption="采购组织" LabelType="M" Width="80px" Sortable="true"/>
                                                <GridColumn Key="NS_PurchaseInfoRecordID" Caption="采购信息记录" LabelType="L" Width="120px" Sortable="true"/>
                                                <GridColumn Key="NS_PurchasingGroupID" Caption="采购组" LabelType="M" Width="80px" Sortable="true"/>
                                                <GridColumn Key="NS_PurchaseReqSOID" Caption="采购申请" LabelType="H" Width="80px" Sortable="true"/>
                                                <GridColumn Key="NS_PurchaseRequisitioItem" Caption="行号" LabelType="H" Width="80px" Sortable="true"/>
                                                <GridColumn Key="NS_SortTerm" Caption="排序字符串" LabelType="H" Visible="false" Width="100px" Sortable="true"/>
                                                <GridColumn Key="NS_CostElementID" Caption="总账科目" Width="80px" Sortable="true"/>
                                                <GridColumn Key="NS_MaterialGroupID" Caption="物料组" LabelType="H" Width="80px" Sortable="true"/>
                                                <GridColumn Key="NS_VendorID" Caption="供应商" LabelType="H" Visible="false" Width="80px" Sortable="true"/>
                                                <GridColumn Key="NS_ReceiptProcessDay" Caption="收货处理时间" LabelType="H" Width="120px" Sortable="true"/>
                                                <GridColumn Key="NS_IsRefurbishment" Caption="刷新物料" Visible="Macro_DebugMode()" Width="80px" Sortable="true"/>
                                                <GridColumn Key="NS_WorkCenterID" Caption="工作中心" LabelType="H" Visible="false" Width="80px" Sortable="true"/>
                                                <GridColumn Key="NS_OID" Visible="false" Width="80px" Sortable="true"/>
                                                <GridColumn Key="NS_SOID" Visible="false" Width="80px" Sortable="true"/>
                                            </GridColumnCollection>
                                            <GridRowCollection>
                                                <GridRow Key="RoutingComponentsAllocatedGridRow" TableKey="EPM_MaintenanceOrder_NoSave">
                                                    <GridCell Key="NS_IsSelect" Caption="选择" CellType="CheckBox" IsSelect="true"/>
                                                    <GridCell Key="NS_POID" Caption="NS_POID" CellType="NumberEditor" Scale="0" UseGroupingSeparator="false">
                                                        <DataBinding ColumnKey="POID"/>
                                                    </GridCell>
                                                    <GridCell Key="NS_ProcessNo" Caption="项目" CellType="TextEditor" MaxLength="4" Trim="true">
                                                        <DataBinding ColumnKey="ProcessNo" DefaultFormulaValue="Right('0000'&amp;((GetRowCount('grid4')+1)*10), 4)" ValueChanged="Macro_PM_MaintenanceOrder_GridTrigger();"/>
                                                    </GridCell>
                                                    <GridCell Key="NS_MaterialID" Caption="组件" CellType="Dict" Enable="NS_ItemCategoryID&lt;=0&amp;&amp;NS_MaterialID&lt;=0" ItemKey="Material">
                                                        <DataBinding ColumnKey="MaterialID">
                                                            <ValueChanged>
                                                                <![CDATA[SetValue('NS_IsBackFlush', com.bokesoft.erp.pm.function.MaintenanceOrderFormula.getBackFlush());Macro_PM_MaintenanceOrder_GridTrigger();]]>
                                                            </ValueChanged>
                                                            <CheckRule>
                                                                <![CDATA[IIF(NS_MaterialID>0||GetDictValue('PP_ItemCategory', NS_ItemCategoryID, 'Code')=='N',true,MessageFacade('CO133','请输入组件'))]]>
                                                            </CheckRule>
                                                        </DataBinding>
                                                        <ItemFilter>
                                                            <Filter Key="Filter" Impl="com.bokesoft.yes.erp.condition.Filter" Type="Custom">
                                                                <FilterValue Index="1" ParaValue="IIF(PlanningPlantID&gt;0, 'OID IN ( Select BK_Material.OID FROM BK_Material  left join EGS_Material_Plant on BK_Material.SOID = EGS_Material_Plant.SOID  where  EGS_Material_Plant.PlantID='&amp;SqlPara(PlanningPlantID)&amp;' and EGS_Material_Plant.Status_Plant&lt;&gt;'&amp;SqlPara(2)&amp;' )', '1=2')"/>
                                                            </Filter>
                                                        </ItemFilter>
                                                    </GridCell>
                                                    <GridCell Key="NS_ShortText" Caption="短文本" CellType="TextEditor" MaxLength="100" Trim="true">
                                                        <DataBinding ColumnKey="ShortText" DefaultFormulaValue="GetDictValue('Material', NS_MaterialID, 'Name')" ValueChanged="Macro_PM_MaintenanceOrder_GridTrigger();"/>
                                                    </GridCell>
                                                    <GridCell Key="NS_RequirementQuantity" Caption="需求数量" CellType="NumberEditor" Enable="!ReadOnly()&amp;&amp;BO_IsRefurbishment==0" Scale="3">
                                                        <DataBinding ColumnKey="RequirementQuantity" Required="true" ValueChanged="Macro_PM_MaintenanceOrder_GridTrigger();"/>
                                                        <CellFormat HAlign="Right"/>
                                                    </GridCell>
                                                    <GridCell Key="NS_RequirementDate" Caption="需求日期" CellType="UTCDatePicker" Format="yyyy-MM-dd">
                                                        <DataBinding ColumnKey="RequirementDate" ValueChanged="Macro_PM_MaintenanceOrder_GridTrigger();"/>
                                                    </GridCell>
                                                    <GridCell Key="NS_RequirementTime" Caption="需求时间" CellType="TimePicker" Second="true">
                                                        <DataBinding ColumnKey="RequirementTime" ValueChanged="Macro_PM_MaintenanceOrder_GridTrigger();"/>
                                                    </GridCell>
                                                    <GridCell Key="NS_OffsetPos" Caption="偏置" CellType="NumberEditor" Scale="0" UseGroupingSeparator="false">
                                                        <DataBinding ColumnKey="OffsetPos" ValueChanged="Macro_PM_MaintenanceOrder_GridTrigger();"/>
                                                    </GridCell>
                                                    <GridCell Key="NS_OffsetUnitID" Caption="偏置单位" CellType="Dict" ItemKey="Unit">
                                                        <DataBinding ColumnKey="OffsetUnitID" ValueChanged="Macro_PM_MaintenanceOrder_GridTrigger();"/>
                                                    </GridCell>
                                                    <GridCell Key="NS_IsManualReqDateIndicator" Caption="手工需求日期" CellType="CheckBox">
                                                        <DataBinding ColumnKey="IsManualReqDateIndicator" ValueChanged="Macro_PM_MaintenanceOrder_GridTrigger();"/>
                                                    </GridCell>
                                                    <GridCell Key="NS_ReservationSOID" Caption="预留" CellType="Dict" Enable="false" ItemKey="MM_Reservation__Dic" StateMask="Enable|Disable|Discard">
                                                        <DataBinding ColumnKey="ReservationSOID"/>
                                                    </GridCell>
                                                    <GridCell Key="NS_ReservationDtlOID" Caption="预留明细号" CellType="NumberEditor" Enable="false" Scale="0" UseGroupingSeparator="false">
                                                        <DataBinding ColumnKey="ReservationDtlOID"/>
                                                    </GridCell>
                                                    <GridCell Key="NS_ReservationItem" Caption="预留项目" CellType="NumberEditor" Enable="false" IntegerValue="true" Precision="9">
                                                        <DataBinding ColumnKey="ReservationItem"/>
                                                    </GridCell>
                                                    <GridCell Key="NS_MoveTypeID" Caption="移动类型" CellType="Dict" Enable="false" ItemKey="MoveType">
                                                        <DataBinding ColumnKey="MoveTypeID">
                                                            <DefaultFormulaValue>
                                                                <![CDATA[IIF(NS_MaterialID>0,com.bokesoft.erp.pm.function.MaintenanceOrderFormula.getMoveTypeID(),0)]]>
                                                            </DefaultFormulaValue>
                                                        </DataBinding>
                                                    </GridCell>
                                                    <GridCell Key="NS_CommittedQuantity" Caption="允许数量" CellType="NumberEditor" Scale="3">
                                                        <DataBinding ColumnKey="CommittedQuantity" ValueChanged="Macro_PM_MaintenanceOrder_GridTrigger();"/>
                                                        <CellFormat HAlign="Right"/>
                                                    </GridCell>
                                                    <GridCell Key="NS_RequisiteQuantity" Caption="领料数量" CellType="NumberEditor" Scale="3">
                                                        <DataBinding ColumnKey="RequisiteQuantity" ValueChanged="Macro_PM_MaintenanceOrder_GridTrigger();"/>
                                                        <CellFormat HAlign="Right"/>
                                                    </GridCell>
                                                    <GridCell Key="NS_BaseUnitID" Caption="基本单位" CellType="Dict" Enable="NS_IsRefurbishment==0" ItemKey="Unit">
                                                        <DataBinding ColumnKey="BaseUnitID" ValueChanged="Macro_PM_MaintenanceOrder_GridTrigger();">
                                                            <DefaultFormulaValue>
                                                                <![CDATA[GetDictValue('Material', NS_MaterialID, 'BaseUnitID')]]>
                                                            </DefaultFormulaValue>
                                                        </DataBinding>
                                                    </GridCell>
                                                    <GridCell Key="NS_DivisionID" Caption="产品部门" CellType="Dict" ItemKey="Division">
                                                        <DataBinding ColumnKey="DivisionID">
                                                            <DefaultFormulaValue>
                                                                <![CDATA[GetDictValue('Material', NS_MaterialID, 'DivisionID')]]>
                                                            </DefaultFormulaValue>
                                                        </DataBinding>
                                                    </GridCell>
                                                    <GridCell Key="NS_IsFixedQuantity" Caption="数量固定" CellType="CheckBox">
                                                        <DataBinding ColumnKey="IsFixedQuantity" ValueChanged="Macro_PM_MaintenanceOrder_GridTrigger();"/>
                                                    </GridCell>
                                                    <GridCell Key="NS_IsFinalDelivery" Caption="最后的发货" CellType="CheckBox">
                                                        <DataBinding ColumnKey="IsFinalDelivery" ValueChanged="Macro_PM_MaintenanceOrder_GridTrigger();"/>
                                                    </GridCell>
                                                    <GridCell Key="NS_ItemCategoryID" Caption="项目类别" CellType="Dict" Enable="NS_ItemCategoryID&lt;=0" ItemKey="PP_ItemCategory">
                                                        <DataBinding ColumnKey="ItemCategoryID" Required="true">
                                                            <ValueChanged>
                                                                <![CDATA[IIF(GetDictValue('PP_ItemCategory', NS_ItemCategoryID, 'Code')=='N',SetValue('NS_MaterialID', 0,true),true);Macro_PM_MaintenanceOrder_GridTrigger();]]>
                                                            </ValueChanged>
                                                            <DefaultFormulaValue>
                                                                <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.getAssemblyTypeID(NS_MaterialID,PlanningPlantID)]]>
                                                            </DefaultFormulaValue>
                                                        </DataBinding>
                                                    </GridCell>
                                                    <GridCell Key="NS_PlantID" Caption="工厂" CellType="Dict" ItemKey="Plant">
                                                        <DataBinding ColumnKey="PlantID" DefaultFormulaValue="PlanningPlantID">
                                                            <ValueChanged>
                                                                <![CDATA[IIF(NS_IsRefurbishment==1,SetValue('FromPlantID', NS_PlantID),true);Macro_PM_MaintenanceOrder_GridTrigger();]]>
                                                            </ValueChanged>
                                                            <CheckRule>
                                                                <![CDATA[IIFS(NS_PlantID>0&&GetDictValue('Plant', NS_PlantID, 'CompanyCodeID')!=GetDictValue('Plant', PlanningPlantID, 'CompanyCodeID'),MessageFacade('IW038','计划工厂的成本结算区域与物料工厂不是同一个'),NS_PlantID<=0, MessageFacade('CO020','请输入工厂'),true,true)]]>
                                                            </CheckRule>
                                                        </DataBinding>
                                                        <ItemFilter ItemKey="Plant">
                                                            <Filter Key="Filter" Impl="com.bokesoft.yes.erp.condition.Filter" Type="Custom">
                                                                <FilterValue Index="1" ParaValue="'soid in (select plantid from egs_Material_Plant where soid='&amp;SqlPara(NS_MaterialID)&amp;')'"/>
                                                            </Filter>
                                                        </ItemFilter>
                                                    </GridCell>
                                                    <GridCell Key="NS_StorageLocationID" Caption="库存地点" CellType="Dict" ItemKey="StorageLocation">
                                                        <DataBinding ColumnKey="StorageLocationID" ValueChanged="Macro_PM_MaintenanceOrder_GridTrigger();"/>
                                                    </GridCell>
                                                    <GridCell Key="NS_RefProcessNo" Caption="对应的工序" CellType="TextEditor" MaxLength="4" Trim="true">
                                                        <DataBinding ColumnKey="RefProcessNo" DefaultFormulaValue="RO_ProcessNo" ValueChanged="Macro_PM_MaintenanceOrder_GridTrigger();">
                                                            <CheckRule>
                                                                <![CDATA[IIF(RO_ProcessNo!=NS_RefProcessNo,SetValue('NS_RefProcessNo', RO_ProcessNo),true)]]>
                                                            </CheckRule>
                                                        </DataBinding>
                                                    </GridCell>
                                                    <GridCell Key="NS_BatchCode" Caption="批次" CellType="TextEditor" Enable="!ReadOnly()&amp;&amp;Macro_MaterialIsBatchManagement(NS_PlantID,NS_MaterialID)" Case="Upper" MaxLength="30" Trim="true">
                                                        <DataBinding ColumnKey="BatchCode" DefaultValue="_" ValueChanged="Macro_PM_MaintenanceOrder_GridTrigger();"/>
                                                    </GridCell>
                                                    <GridCell Key="NS_IsDelete" Caption="已删除" CellType="CheckBox">
                                                        <DataBinding ColumnKey="IsDelete" ValueChanged="Macro_PM_MaintenanceOrder_GridTrigger();"/>
                                                    </GridCell>
                                                    <GridCell Key="NS_IsBulkMaterial" Caption="散装物料" CellType="CheckBox">
                                                        <DataBinding ColumnKey="IsBulkMaterial" ValueChanged="Macro_PM_MaintenanceOrder_GridTrigger();"/>
                                                    </GridCell>
                                                    <GridCell Key="NS_IsBackFlush" Caption="反冲" CellType="CheckBox">
                                                        <DataBinding ColumnKey="IsBackFlush" ValueChanged="Macro_PM_MaintenanceOrder_GridTrigger();"/>
                                                    </GridCell>
                                                    <GridCell Key="NS_IsAllowedMovment" Caption="允许的货物移动" CellType="CheckBox" Enable="false">
                                                        <DataBinding ColumnKey="IsAllowedMovment">
                                                            <DefaultFormulaValue>
                                                                <![CDATA[IIF(Length(NS_RefProcessNo) > 0, NS_MaterialID > 0 && Macro_IsREL() && NS_ResPurReqRelevance != 1, NS_IsAllowedMovment)]]>
                                                            </DefaultFormulaValue>
                                                        </DataBinding>
                                                    </GridCell>
                                                    <GridCell Key="NS_ResPurReqRelevance" Caption="预留/采购申请" CellType="ComboBox" IntegerValue="true" GroupKey="GenerateControl" SourceType="ParaGroup">
                                                        <DataBinding ColumnKey="ResPurReqRelevance">
                                                            <ValueChanged>
                                                                <![CDATA[IIF(Macro_IsREL() && NS_ResPurReqRelevance == 2,  Macro_RevertResPurReq('A_ResPurReqRelevance'), true);]]>
                                                            </ValueChanged>
                                                            <DefaultFormulaValue>
                                                                <![CDATA[IIF(Macro_IsREL() && NS_ResPurReqRelevance == 2, 3, IIF(NS_ResPurReqRelevance < 1 && RequisitionCreationControl > 0, RequisitionCreationControl, NS_ResPurReqRelevance))]]>
                                                            </DefaultFormulaValue>
                                                        </DataBinding>
                                                    </GridCell>
                                                    <GridCell Key="NS_RelevancyToCostingID" Caption="成本核算相关" CellType="ComboBox">
                                                        <DataBinding ColumnKey="RelevancyToCostingID" ValueChanged="Macro_PM_MaintenanceOrder_GridTrigger();"/>
                                                        <Item Key="0" Caption="与成本核算无关" Value="0"/>
                                                        <Item Key="1" Caption="与成本核算50%相关" Value="1"/>
                                                        <Item Key="2" Caption="与成本核算25%相关" Value="2"/>
                                                        <Item Key="3" Caption="与成本核算75%相关" Value="3"/>
                                                        <Item Key="X" Caption="与成本核算100%相关" Value="X"/>
                                                    </GridCell>
                                                    <GridCell Key="NS_ProvisionIndicator" Caption="物料供应标识" CellType="ComboBox" GroupKey="MaterialSupplyIdentification" SourceType="ParaGroup">
                                                        <DataBinding ColumnKey="ProvisionIndicator" ValueChanged="Macro_PM_MaintenanceOrder_GridTrigger();"/>
                                                    </GridCell>
                                                    <GridCell Key="NS_AccountAssignmentCategoryID" Caption="科目分配类别" CellType="Dict" ItemKey="AccountAssignmentCategory">
                                                        <DataBinding ColumnKey="AccountAssignmentCategoryID" ValueChanged="Macro_PM_MaintenanceOrder_GridTrigger();"/>
                                                    </GridCell>
                                                    <GridCell Key="NS_SpecialIdentity" Caption="特殊库存标识" CellType="ComboBox" SourceType="ParaGroup" GroupKey="SpecialIdentity">
                                                        <DataBinding ColumnKey="SpecialIdentity" ValueChanged="Macro_PM_MaintenanceOrder_GridTrigger();">
                                                            <DefaultFormulaValue>
                                                                <![CDATA[IIF(NS_AccountAssignmentCategoryID>0,GetDictValue('AccountAssignmentCategory', NS_AccountAssignmentCategoryID, 'SpecialIdentity'),'_')]]>
                                                            </DefaultFormulaValue>
                                                        </DataBinding>
                                                    </GridCell>
                                                    <GridCell Key="NS_DynIdentityID" Caption="特殊库存" CellType="DynamicDict" Enable="false" IsDynamic="true" RefDataElementKey="NS_DynIdentityIDDEKey">
                                                        <DataBinding ColumnKey="DynIdentityID">
                                                            <CheckRule>
                                                                <![CDATA[IIFS(NS_SpecialIdentity=='_', true, NS_SpecialIdentity=='E'&&NS_DynIdentityID<=0, MessageFacade('CO714','请输入订单'), NS_SpecialIdentity=='K'&&NS_DynIdentityID<=0, MessageFacade('PM_MAINTENANCEORDER012','请输入(寄售)供应商'), NS_SpecialIdentity=='O'&&NS_DynIdentityID<=0, MessageFacade('PM_MAINTENANCEORDER013','请输入分包供应商'), NS_SpecialIdentity=='Q'&&NS_DynIdentityID<=0, MessageFacade('PM_MAINTENANCEORDER014','请输入项目库存'), NS_SpecialIdentity=='W'&&NS_DynIdentityID<=0, MessageFacade('PM_MAINTENANCEORDER015','请输入(寄售)客户'), NS_SpecialIdentity=='V'&&NS_DynIdentityID<=0, MessageFacade('PM_MAINTENANCEORDER016','请输入(可回收包装物)客户'), true, true)]]>
                                                            </CheckRule>
                                                        </DataBinding>
                                                    </GridCell>
                                                    <GridCell Key="NS_DynIdentityIDDEKey" Caption="特殊库存字典Key" CellType="TextEditor">
                                                        <DataBinding ColumnKey="DynIdentityIDDEKey">
                                                            <DefaultFormulaValue>
                                                                <![CDATA[Macro_GetIdentityDataElementKey(NS_SpecialIdentity)]]>
                                                            </DefaultFormulaValue>
                                                        </DataBinding>
                                                    </GridCell>
                                                    <GridCell Key="NS_ValuationSpecialStock" Caption="评估" CellType="ComboBox" GroupKey="Assessment" SourceType="ParaGroup">
                                                        <DataBinding ColumnKey="ValuationSpecialStock" ValueChanged="Macro_PM_MaintenanceOrder_GridTrigger();"/>
                                                    </GridCell>
                                                    <GridCell Key="NS_ConsumptionIndicator" Caption="消耗过账" CellType="ComboBox" GroupKey="ConsumptionIndicator" SourceType="ParaGroup">
                                                        <DataBinding ColumnKey="ConsumptionIndicator" ValueChanged="Macro_PM_MaintenanceOrder_GridTrigger();"/>
                                                    </GridCell>
                                                    <GridCell Key="NS_PlannedDeliveryDay" Caption="计划交货时间(天)" CellType="NumberEditor" Scale="0" UseGroupingSeparator="false">
                                                        <DataBinding ColumnKey="PlannedDeliveryDay" ValueChanged="Macro_PM_MaintenanceOrder_GridTrigger();"/>
                                                    </GridCell>
                                                    <GridCell Key="NS_NetPriceQuantity" Caption="价格数量" CellType="NumberEditor" Scale="3">
                                                        <DataBinding ColumnKey="NetPriceQuantity" ValueChanged="Macro_PM_MaintenanceOrder_GridTrigger();"/>
                                                        <CellFormat HAlign="Right"/>
                                                    </GridCell>
                                                    <GridCell Key="NS_NetPrice" Caption="净价" CellType="NumberEditor" Scale="6">
                                                        <DataBinding ColumnKey="NetPrice" ValueChanged="Macro_PM_MaintenanceOrder_GridTrigger();">
                                                            <CheckRule>
                                                                <![CDATA[IIF(GetDictValue('PP_ItemCategory', NS_ItemCategoryID, 'Code')!='N'||(GetDictValue('PP_ItemCategory', NS_ItemCategoryID, 'Code')=='N'&&NS_NetPrice>0),true,MessageFacade('PM_MAINTENANCEORDER017','非库存项目请输入价格'))]]>
                                                            </CheckRule>
                                                        </DataBinding>
                                                        <CellFormat HAlign="Right"/>
                                                    </GridCell>
                                                    <GridCell Key="NS_NetPriceCurrencyID" Caption="币种" CellType="Dict" ItemKey="Currency">
                                                        <DataBinding ColumnKey="NetPriceCurrencyID"/>
                                                    </GridCell>
                                                    <GridCell Key="NS_PurchasingOrganizationID" Caption="采购组织" CellType="Dict" ItemKey="PurchasingOrganization">
                                                        <DataBinding ColumnKey="PurchasingOrganizationID" ValueChanged="Macro_PM_MaintenanceOrder_GridTrigger();"/>
                                                    </GridCell>
                                                    <GridCell Key="NS_PurchaseInfoRecordID" Caption="采购信息记录" CellType="Dict" ItemKey="MM_PurchaseInfoRecord">
                                                        <DataBinding ColumnKey="PurchaseInfoRecordID" ValueChanged="Macro_PM_MaintenanceOrder_GridTrigger();"/>
                                                    </GridCell>
                                                    <GridCell Key="NS_PurchasingGroupID" Caption="采购组" CellType="Dict" ItemKey="PurchasingGroup">
                                                        <DataBinding ColumnKey="PurchasingGroupID" ValueChanged="Macro_PM_MaintenanceOrder_GridTrigger();">
                                                            <CheckRule>
                                                                <![CDATA[IIF(GetDictValue('PP_ItemCategory', NS_ItemCategoryID, 'Code')!='N'||(GetDictValue('PP_ItemCategory', NS_ItemCategoryID, 'Code')=='N'&&NS_PurchasingGroupID>0),true,MessageFacade('SE192','非库存项目请输入采购组'))]]>
                                                            </CheckRule>
                                                        </DataBinding>
                                                    </GridCell>
                                                    <GridCell Key="NS_PurchaseReqSOID" Caption="采购申请" CellType="Dict" Enable="false" ItemKey="MM_PurchaseRequisition__Dic" StateMask="Enable|Disable|Discard">
                                                        <DataBinding ColumnKey="PurchaseReqSOID"/>
                                                    </GridCell>
                                                    <GridCell Key="NS_PurchaseRequisitioItem" Caption="行号" CellType="TextEditor" Enable="false" MaxLength="100" Trim="true">
                                                        <DataBinding ColumnKey="PurchaseRequisitioItem"/>
                                                    </GridCell>
                                                    <GridCell Key="NS_SortTerm" Caption="排序字符串" CellType="TextEditor" MaxLength="100" Trim="true">
                                                        <DataBinding ColumnKey="SortTerm"/>
                                                    </GridCell>
                                                    <GridCell Key="NS_CostElementID" Caption="总账科目" CellType="Dict" ItemKey="CO_CostElement">
                                                        <DataBinding ColumnKey="CostElementID" ValueChanged="Macro_PM_MaintenanceOrder_GridTrigger();">
                                                            <CheckRule>
                                                                <![CDATA[IIF(GetDictValue('PP_ItemCategory', NS_ItemCategoryID, 'Code')!='N'||(GetDictValue('PP_ItemCategory', NS_ItemCategoryID, 'Code')=='N'&&NS_CostElementID>0),true,MessageFacade('SE121','非库存项目请输入成本要素'))]]>
                                                            </CheckRule>
                                                        </DataBinding>
                                                    </GridCell>
                                                    <GridCell Key="NS_MaterialGroupID" Caption="物料组" CellType="Dict" ItemKey="MaterialGroup">
                                                        <DataBinding ColumnKey="MaterialGroupID" ValueChanged="Macro_PM_MaintenanceOrder_GridTrigger();">
                                                            <CheckRule>
                                                                <![CDATA[IIF(GetDictValue('PP_ItemCategory', NS_ItemCategoryID, 'Code')!='N'||(GetDictValue('PP_ItemCategory', NS_ItemCategoryID, 'Code')=='N'&&NS_MaterialGroupID>0),true,MessageFacade('SE193','非库存项目请输入物料组'))]]>
                                                            </CheckRule>
                                                            <DefaultFormulaValue>
                                                                <![CDATA[GetDictValue('MM_PurchaseInfoRecord', NS_PurchaseInfoRecordID, 'MaterialGroupID')]]>
                                                            </DefaultFormulaValue>
                                                        </DataBinding>
                                                    </GridCell>
                                                    <GridCell Key="NS_VendorID" Caption="供应商" CellType="Dict" ItemKey="Vendor">
                                                        <DataBinding ColumnKey="VendorID">
                                                            <DefaultFormulaValue>
                                                                <![CDATA[GetDictValue('MM_PurchaseInfoRecord', NS_PurchaseInfoRecordID, 'VendorID')]]>
                                                            </DefaultFormulaValue>
                                                        </DataBinding>
                                                    </GridCell>
                                                    <GridCell Key="NS_ReceiptProcessDay" Caption="收货处理时间" CellType="NumberEditor" Scale="0" UseGroupingSeparator="false">
                                                        <DataBinding ColumnKey="ReceiptProcessDay" ValueChanged="Macro_PM_MaintenanceOrder_GridTrigger();"/>
                                                    </GridCell>
                                                    <GridCell Key="NS_IsRefurbishment" Caption="刷新物料" CellType="CheckBox" Enable="false">
                                                        <DataBinding ColumnKey="IsRefurbishment"/>
                                                    </GridCell>
                                                    <GridCell Key="NS_WorkCenterID" Caption="工作中心" CellType="Dict" ItemKey="WorkCenter">
                                                        <DataBinding ColumnKey="WorkCenterID" DefaultFormulaValue="RO_WorkCenterID"/>
                                                    </GridCell>
                                                    <GridCell Key="NS_OID" CellType="NumberEditor" Scale="0">
                                                        <DataBinding ColumnKey="OID"/>
                                                    </GridCell>
                                                    <GridCell Key="NS_SOID" CellType="NumberEditor" Scale="0">
                                                        <DataBinding ColumnKey="SOID"/>
                                                    </GridCell>
                                                </GridRow>
                                            </GridRowCollection>
                                            <OnRowDelete>
                                                <![CDATA[if (NS_IsRefurbishment==1) {ConfirmMsg('IW823', '对待修理的元件的删除不在计划中', {}, 'OK'); return 0;} else {DeleteRow();};Macro_PM_MaintenanceOrder_GridTrigger()]]>
                                            </OnRowDelete>
                                        </Grid>
                                        <RowDefCollection RowGap="24">
                                            <RowDef Height="100%"/>
                                        </RowDefCollection>
                                        <ColumnDefCollection ColumnGap="16">
                                            <ColumnDef Width="100%"/>
                                        </ColumnDefCollection>
                                    </GridLayoutPanel>
                                </SubDetail>
                                <Grid Key="RoutingRelationshipGrid" Caption="关系" DefaultFitWidth="true" SerialSeq="true" Padding="8px">
                                    <GridColumnCollection>
                                        <GridColumn Key="RE_IsSelect" Width="32px"/>
                                        <GridColumn Key="RE_OperationNumber" Caption="工序号" Width="80px" Sortable="true"/>
                                        <GridColumn Key="RE_OffsetPos" Caption="偏置量" Width="80px" Sortable="true"/>
                                        <GridColumn Key="RE_OffsetUnitID" Caption="单位" Width="80px" Sortable="true"/>
                                        <GridColumn Key="RE_RelationType" Caption="关系类型" LabelType="M" Width="80px" Sortable="true"/>
                                        <GridColumn Key="RE_IsSuccessorIndicator" Caption="后续标识" LabelType="H" Width="80px" Sortable="true"/>
                                        <GridColumn Key="RE_OperationShortText" Caption="工序短文本" LabelType="H" Width="100px" Sortable="true"/>
                                        <GridColumn Key="RE_OID" Visible="false" Width="80px" Sortable="true"/>
                                        <GridColumn Key="RE_SOID" Visible="false" Width="80px" Sortable="true"/>
                                    </GridColumnCollection>
                                    <GridRowCollection>
                                        <GridRow Key="RoutingRelationshipGridRow" TableKey="EPM_MaintOrderRelations">
                                            <GridCell Key="RE_IsSelect" Caption="选择" CellType="CheckBox" IsSelect="true"/>
                                            <GridCell Key="RE_OperationNumber" Caption="工序号" CellType="TextEditor" MaxLength="100" Trim="true">
                                                <DataBinding ColumnKey="OperationNumber"/>
                                            </GridCell>
                                            <GridCell Key="RE_OffsetPos" Caption="偏置量" CellType="NumberEditor" Precision="9" Scale="0" UseGroupingSeparator="false">
                                                <DataBinding ColumnKey="OffsetPos"/>
                                            </GridCell>
                                            <GridCell Key="RE_OffsetUnitID" Caption="单位" CellType="Dict" ItemKey="Unit">
                                                <DataBinding ColumnKey="OffsetUnitID"/>
                                            </GridCell>
                                            <GridCell Key="RE_RelationType" Caption="关系类型" CellType="ComboBox">
                                                <DataBinding ColumnKey="RelationType"/>
                                                <Item Key="FF" Caption="FF关系" Value="FF"/>
                                                <Item Key="FS" Caption="FS关系" Value="FS"/>
                                                <Item Key="SF" Caption="SF关系" Value="SF"/>
                                                <Item Key="SS" Caption="SS关系" Value="SS"/>
                                            </GridCell>
                                            <GridCell Key="RE_IsSuccessorIndicator" Caption="后续标识" CellType="CheckBox">
                                                <DataBinding ColumnKey="IsSuccessorIndicator"/>
                                            </GridCell>
                                            <GridCell Key="RE_OperationShortText" Caption="工序短文本" CellType="TextEditor" MaxLength="100" Trim="true">
                                                <DataBinding ColumnKey="OperationShortText"/>
                                            </GridCell>
                                            <GridCell Key="RE_OID" CellType="NumberEditor" Scale="0">
                                                <DataBinding ColumnKey="OID"/>
                                            </GridCell>
                                            <GridCell Key="RE_SOID" CellType="NumberEditor" Scale="0">
                                                <DataBinding ColumnKey="SOID"/>
                                            </GridCell>
                                        </GridRow>
                                    </GridRowCollection>
                                </Grid>
                                <SubDetail Key="RoutingStatusSubDetail" Caption="工序状态管理" BindingGridKey="MaintenanceOrder_RoutingGrid">
                                    <FlexFlowLayoutPanel Key="RoutingStatusFlexFlowLayoutPanel" Caption="工序状态管理" Padding="8px">
                                        <Embed Key="ExtraStatusManage" FormKey="ExtraStatusManage" RootKey="ExtraStatusManageRoot" Height="100%">
                                            <Var Key="SystemStatusParentKey" Value="EPM_MaintOrder_Routing"/>
                                            <Var Key="UserStatusParentKey" Value="EPM_MaintOrder_Routing"/>
                                        </Embed>
                                    </FlexFlowLayoutPanel>
                                </SubDetail>
                                <SubDetail Key="RoutingProductionResourceToolAreaSubDetail" Caption="生产资源/工具" BindingGridKey="MaintenanceOrder_RoutingGrid">
                                    <FlexFlowLayoutPanel Key="RoutingProductionResourceToolAreaFlexFlowLayoutPanel" Caption="生产资源/工具" Visible="!Macro_IsSubRouting(RO_SubProcessNo)" Padding="8px">
                                        <Embed Key="PP_UseProductResourceTool" FormKey="PP_UseProductResourceTool" RootKey="UseProductResourceToolFlexFlowLayoutPanel" Height="100%">
                                            <Var Key="ParentKey" Value="EPM_MaintOrder_Routing"/>
                                        </Embed>
                                    </FlexFlowLayoutPanel>
                                </SubDetail>
                                <SubDetail Key="SubDetail_TAB_Intensify" Caption="增强" BindingGridKey="MaintenanceOrder_RoutingGrid">
                                    <GridLayoutPanel Key="Intensify" Caption="增强" Padding="8px" TopPadding="24px">
                                        <Dict Key="RO_DefineUserFieldID__mirror" Caption="字段码" X="0" Y="0" Visible="true" ItemKey="PM_DefineUserField" BindingCellKey="RO_DefineUserFieldID"/>
                                        <TextEditor Key="RO_UserFieldText1__mirror1" Caption="Text1" X="0" Y="1" Visible="GetDictValue('PM_DefineUserField',RO_DefineUserFieldID,'DefineUserFieldText1') != &quot;&quot;" BindingCellKey="RO_UserFieldText1" FormulaCaption="GetDictValue('PM_DefineUserField', RO_DefineUserFieldID, 'DefineUserFieldText1')"/>
                                        <TextEditor Key="RO_UserFieldText2__mirror2" Caption="Text2" X="2" Y="1" Visible="GetDictValue('PM_DefineUserField',RO_DefineUserFieldID,'DefineUserFieldText2') != &quot;&quot;" BindingCellKey="RO_UserFieldText2" XSpan="2" FormulaCaption="GetDictValue('PM_DefineUserField', RO_DefineUserFieldID, 'DefineUserFieldText2')"/>
                                        <TextEditor Key="RO_UserFieldText3__mirror3" Caption="Text3" X="0" Y="2" Visible="GetDictValue('PM_DefineUserField',RO_DefineUserFieldID,'DefineUserFieldText3') != &quot;&quot;" BindingCellKey="RO_UserFieldText3" FormulaCaption="GetDictValue('PM_DefineUserField', RO_DefineUserFieldID, 'DefineUserFieldText3')">
                                            <DataBinding/>
                                        </TextEditor>
                                        <TextEditor Key="RO_UserFieldText4__mirror4" Caption="Text4" X="2" Y="2" Visible="GetDictValue('PM_DefineUserField',RO_DefineUserFieldID,'DefineUserFieldText4') != &quot;&quot;" BindingCellKey="RO_UserFieldText4" XSpan="2" FormulaCaption="GetDictValue('PM_DefineUserField', RO_DefineUserFieldID, 'DefineUserFieldText4')">
                                            <DataBinding/>
                                        </TextEditor>
                                        <DatePicker Key="O_Date1Time_mirror" Caption="Date1" X="0" Y="3" Visible="GetDictValue('PM_DefineUserField',RO_DefineUserFieldID,'DefineUserFieldDate1') != &quot;&quot;" BindingCellKey="RO_UserFieldDate1Time" FormulaCaption="GetDictValue('PM_DefineUserField',RO_DefineUserFieldID,'DefineUserFieldDate1')">
                                            <DataBinding/>
                                        </DatePicker>
                                        <DatePicker Key="O_Date2Time_mirror" Caption="Date2" X="2" Y="3" Visible="GetDictValue('PM_DefineUserField',RO_DefineUserFieldID,'DefineUserFieldDate2') != &quot;&quot;" BindingCellKey="RO_UserFieldDate2Time" XSpan="2" FormulaCaption="GetDictValue('PM_DefineUserField',RO_DefineUserFieldID,'DefineUserFieldDate2')">
                                            <DataBinding/>
                                        </DatePicker>
                                        <NumberEditor Key="RO_UserFieldNumber1__mirror1" Caption="Number1" X="0" Y="4" Visible="GetDictValue('PM_DefineUserField',RO_DefineUserFieldID,'DefineUserFieldNumber1') != &quot;&quot;" BindingCellKey="RO_UserFieldNumber1" FormulaCaption="GetDictValue('PM_DefineUserField',RO_DefineUserFieldID,'DefineUserFieldNumber1')">
                                            <DataBinding/>
                                            <Format HAlign="Right"/>
                                        </NumberEditor>
                                        <NumberEditor Key="RO_UserFieldNumber2__mirror2" Caption="Number2" X="2" Y="4" Visible="GetDictValue('PM_DefineUserField',RO_DefineUserFieldID,'DefineUserFieldNumber2') != &quot;&quot;" XSpan="2" BindingCellKey="RO_UserFieldNumber2" FormulaCaption="GetDictValue('PM_DefineUserField',RO_DefineUserFieldID,'DefineUserFieldNumber2')">
                                            <DataBinding/>
                                            <Format HAlign="Right"/>
                                        </NumberEditor>
                                        <NumberEditor Key="RO_UserFieldValue1__mirror1" Caption="Value1" X="0" Y="5" Visible="GetDictValue('PM_DefineUserField',RO_DefineUserFieldID,'DefineUserFieldValue1') != &quot;&quot;" BindingCellKey="RO_UserFieldValue1" FormulaCaption="GetDictValue('PM_DefineUserField',RO_DefineUserFieldID,'DefineUserFieldValue1')">
                                            <DataBinding/>
                                            <Format HAlign="Right"/>
                                        </NumberEditor>
                                        <NumberEditor Key="RO_UserFieldValue2__mirror2" Caption="Value2" X="0" Y="6" Visible="GetDictValue('PM_DefineUserField',RO_DefineUserFieldID,'DefineUserFieldValue2') != &quot;&quot;" BindingCellKey="RO_UserFieldValue2" FormulaCaption="GetDictValue('PM_DefineUserField',RO_DefineUserFieldID,'DefineUserFieldValue2')">
                                            <DataBinding/>
                                            <Format HAlign="Right"/>
                                        </NumberEditor>
                                        <Dict Key="RO_UserFieldNumber1UnitID__mirror1" X="1" Y="4" Visible="GetDictValue('PM_DefineUserField',RO_DefineUserFieldID,'DefineUserFieldNumber1') != &quot;&quot;" ItemKey="Unit" BindingCellKey="RO_UserFieldNumber1UnitID" FormulaCaption="GetDictValue('PM_DefineUserField',RO_DefineUserFieldID,'DefineUserFieldUnit1')">
                                            <DataBinding/>
                                        </Dict>
                                        <Dict Key="RO_UserFieldNumber2UnitID__mirror2" X="4" Y="4" Visible="GetDictValue('PM_DefineUserField',RO_DefineUserFieldID,'DefineUserFieldNumber2') != &quot;&quot;" ItemKey="Unit" BindingCellKey="RO_UserFieldNumber2UnitID" FormulaCaption="GetDictValue('PM_DefineUserField',RO_DefineUserFieldID,'DefineUserFieldUnit2')">
                                            <DataBinding/>
                                        </Dict>
                                        <Dict Key="RO_UserFieldValue1CurrencyID__mirror1" X="1" Y="5" Visible="GetDictValue('PM_DefineUserField',RO_DefineUserFieldID,'DefineUserFieldValue1') != &quot;&quot;" ItemKey="Currency" BindingCellKey="RO_UserFieldValue1CurrencyID" FormulaCaption="GetDictValue('PM_DefineUserField',RO_DefineUserFieldID,'DefineUserFieldCurrency1')">
                                            <DataBinding/>
                                        </Dict>
                                        <Dict Key="RO_UserFieldValue2CurrencyID__mirror2" X="1" Y="6" Visible="GetDictValue('PM_DefineUserField',RO_DefineUserFieldID,'DefineUserFieldValue2') != &quot;&quot;" ItemKey="Currency" BindingCellKey="RO_UserFieldValue2CurrencyID" FormulaCaption="GetDictValue('PM_DefineUserField',RO_DefineUserFieldID,'DefineUserFieldCurrency2')">
                                            <DataBinding/>
                                        </Dict>
                                        <CheckBox Key="RO_IsUserFieldCheckBox1__mirror1" X="2" Y="5" Visible="GetDictValue('PM_DefineUserField',RO_DefineUserFieldID,'DefineUserFieldCheckBox1') != &quot;&quot;" BindingCellKey="RO_IsUserFieldCheckBox1">
                                            <DataBinding/>
                                        </CheckBox>
                                        <Label Key="Inner_IsO_CheckBox1_mirror" Caption="IsO_CheckBox1" X="3" Y="5" Visible="GetDictValue('PM_DefineUserField',RO_DefineUserFieldID,'DefineUserFieldCheckBox1') != &quot;&quot;">
                                            <DataBinding>
                                                <DefaultFormulaValue>
                                                    <![CDATA[GetDictValue('PM_DefineUserField',RO_DefineUserFieldID,'DefineUserFieldCheckBox1')]]>
                                                </DefaultFormulaValue>
                                            </DataBinding>
                                        </Label>
                                        <CheckBox Key="RO_IsUserFieldCheckBox2__mirror2" X="2" Y="6" Visible="GetDictValue('PM_DefineUserField',RO_DefineUserFieldID,'DefineUserFieldCheckBox2') != &quot;&quot;" BindingCellKey="RO_IsUserFieldCheckBox2">
                                            <DataBinding/>
                                        </CheckBox>
                                        <Label Key="Inner_IsO_CheckBox2_mirror" Caption="IsO_CheckBox2" X="3" Y="6" Visible="GetDictValue('PM_DefineUserField',RO_DefineUserFieldID,'DefineUserFieldCheckBox1') != &quot;&quot;">
                                            <DataBinding>
                                                <DefaultFormulaValue>
                                                    <![CDATA[GetDictValue('PM_DefineUserField',RO_DefineUserFieldID,'DefineUserFieldCheckBox2')]]>
                                                </DefaultFormulaValue>
                                            </DataBinding>
                                        </Label>
                                        <RowDefCollection RowHeight="30" RowGap="24">
                                            <RowDef Height="32px"/>
                                            <RowDef Height="32px"/>
                                            <RowDef Height="32px"/>
                                            <RowDef Height="32px"/>
                                            <RowDef Height="32px"/>
                                            <RowDef Height="32px"/>
                                            <RowDef Height="32px"/>
                                            <RowDef Height="32px"/>
                                        </RowDefCollection>
                                        <ColumnDefCollection ColumnGap="16">
                                            <ColumnDef Width="300px"/>
                                            <ColumnDef Width="70px"/>
                                            <ColumnDef Width="15px"/>
                                            <ColumnDef Width="300px"/>
                                            <ColumnDef Width="150px"/>
                                        </ColumnDefCollection>
                                    </GridLayoutPanel>
                                </SubDetail>
                            </TabPanel>
                            <SplitSize Size="50%"/>
                            <SplitSize Size="50%"/>
                        </SplitPanel>
                        <SplitPanel Key="ComponentSplitPanel" Caption="组件" Orientation="Vertical" Visible="true">
                            <Grid Key="ComponentGrid" Caption="组件" SerialSeq="true" DisabledOption="sum,groupSum" Padding="8px">
                                <GridColumnCollection>
                                    <GridColumn Key="BO_IsSelect" Width="32px"/>
                                    <GridColumn Key="BO_OID" Caption="BO_OID" Visible="Macro_DebugMode()" Width="80px" Sortable="true"/>
                                    <GridColumn Key="BO_ProcessNo" Caption="项目" LabelType="H" Width="80px" Sortable="true"/>
                                    <GridColumn Key="BO_MaterialID" Caption="组件" Width="80px" Sortable="true"/>
                                    <GridColumn Key="BO_ShortText" Caption="短文本" LabelType="H" Enable="!ReadOnly() &amp;&amp; BO_MaterialID &lt;= 0" Width="80px" Sortable="true"/>
                                    <GridColumn Key="BO_ParentMaintOrderRoutingOID" Caption="BO_ParentMaintOrderRoutingOID" Visible="Macro_DebugMode()" Width="80px" Sortable="true"/>
                                    <GridColumn Key="BO_RefProcessNo_Btn" Caption="对应的工序" Width="100px" Sortable="true"/>
                                    <GridColumn Key="BO_RequirementQuantity" Caption="需求数量" Width="100px" Sortable="true"/>
                                    <GridColumn Key="BO_BaseQuantity" Caption="需求基本数量" Visible="false" Width="120px" Sortable="true"/>
                                    <GridColumn Key="BO_Order2BaseNumerator" Caption="订单到基本单位-分子" LabelType="H" Visible="false" Width="80px" Sortable="true"/>
                                    <GridColumn Key="BO_Order2BaseDenominator" Caption="订单到基本单位-分母" LabelType="M" Visible="false" Width="80px" Sortable="true"/>
                                    <GridColumn Key="BO_ItemCategoryID" Caption="项目类别" LabelType="M" Width="80px" Sortable="true"/>
                                    <GridColumn Key="BO_RequirementDate" Caption="需求日期" LabelType="H" Width="100px" Sortable="true"/>
                                    <GridColumn Key="BO_RequirementTime" Caption="需求时间" LabelType="H" Width="80px" Sortable="true"/>
                                    <GridColumn Key="BO_OffsetPos" Caption="偏置" LabelType="M" Width="80px" Sortable="true"/>
                                    <GridColumn Key="BO_OffsetUnitID" Caption="偏置单位" LabelType="M" Width="80px" Sortable="true"/>
                                    <GridColumn Key="BO_IsManualReqDateIndicator" Caption="手工需求日期" LabelType="M" Width="120px" Sortable="true"/>
                                    <GridColumn Key="BO_ReservationSOID" Caption="预留" LabelType="M" Width="80px" Sortable="true"/>
                                    <GridColumn Key="BO_ReservationDtlOID" Caption="预留明细号" Visible="Macro_DebugMode()" Width="100px" Sortable="true"/>
                                    <GridColumn Key="BO_ReservationItem" Caption="预留项目" LabelType="H" Width="80px" Sortable="true"/>
                                    <GridColumn Key="BO_MoveTypeID" Caption="移动类型" LabelType="M" Width="80px" Sortable="true"/>
                                    <GridColumn Key="BO_CommittedQuantity" Caption="允许数量" LabelType="H" Width="100px" Sortable="true"/>
                                    <GridColumn Key="BO_RequisiteQuantity" Caption="领料数量" Width="100px" Sortable="true"/>
                                    <GridColumn Key="BO_BaseUnitID" Caption="基本单位" LabelType="M" Visible="false" Width="80px" Sortable="true"/>
                                    <GridColumn Key="BO_UnitID" Caption="单位" LabelType="H" Width="80px" Sortable="true"/>
                                    <GridColumn Key="BO_DivisionID" Caption="产品部门" LabelType="H" Width="80px" Sortable="true"/>
                                    <GridColumn Key="BO_IsFixedQuantity" Caption="数量固定" LabelType="L" Width="80px" Sortable="true"/>
                                    <GridColumn Key="BO_IsFinalDelivery" Caption="最后的发货" Width="100px" Sortable="true"/>
                                    <GridColumn Key="BO_PlantID" Caption="工厂" LabelType="H" Width="80px" Sortable="true"/>
                                    <GridColumn Key="BO_StorageLocationID" Caption="库存地点" LabelType="M" Width="80px" Sortable="true"/>
                                    <GridColumn Key="BO_BatchCode" Caption="批次" LabelType="H" Width="80px" Sortable="true"/>
                                    <GridColumn Key="BO_StatusItem" Caption="项目状态" LabelType="H" Width="80px" Sortable="true"/>
                                    <GridColumn Key="BO_IsBulkMaterial" Caption="散装物料" LabelType="M" Width="80px" Sortable="true"/>
                                    <GridColumn Key="BO_IsBackFlush" Caption="反冲" LabelType="M" Width="80px" Sortable="true"/>
                                    <GridColumn Key="BO_IsAllowedMovment" Caption="允许的货物移动" Width="80px" Sortable="true"/>
                                    <GridColumn Key="BO_RequisitionCreationControl" Caption="预留/采购申请" LabelType="M" Width="80px" Sortable="true"/>
                                    <GridColumn Key="BO_RelevancyToCostingID" Caption="成本核算相关" LabelType="H" Width="120px" Sortable="true"/>
                                    <GridColumn Key="BO_ProvisionIndicator" Caption="物料供应标识" LabelType="M" Width="120px" Sortable="true"/>
                                    <GridColumn Key="BO_AccountAssignmentCategoryID" Caption="科目分配类别" LabelType="M" Width="120px" Sortable="true"/>
                                    <GridColumn Key="BO_SpecialIdentity" Caption="特殊库存标识" LabelType="M" Visible="OrgWBSElementID&gt;0 || OrgSaleOrderDtlOID&gt;0" Width="120px" Sortable="true"/>
                                    <GridColumn Key="BO_DynIdentityID" Caption="特殊库存" LabelType="H" Width="80px" Sortable="true"/>
                                    <GridColumn Key="BO_DynIdentityIDDEKey" Caption="特殊库存字典Key" LabelType="H" Visible="false" Width="80px" Sortable="true"/>
                                    <GridColumn Key="BO_ValuationSpecialStock" Caption="评估" LabelType="M" Width="80px" Sortable="true"/>
                                    <GridColumn Key="BO_ConsumptionIndicator" Caption="消耗过账" LabelType="M" Width="80px" Sortable="true"/>
                                    <GridColumn Key="BO_PlannedDeliveryDay" Caption="计划交货时间(天)" LabelType="M" Width="80px" Sortable="true"/>
                                    <GridColumn Key="BO_NetPriceQuantity" Caption="价格数量" LabelType="H" Width="100px" Sortable="true"/>
                                    <GridColumn Key="BO_NetPrice" Caption="净价" Width="80px" Sortable="true"/>
                                    <GridColumn Key="BO_Money" Caption="金额" LabelType="H" Visible="false" Width="100px"/>
                                    <GridColumn Key="BO_NetPriceCurrencyID" Caption="币种" LabelType="M" Visible="false" Width="80px" Sortable="true"/>
                                    <GridColumn Key="BO_PurchasingOrganizationID" Caption="采购组织" LabelType="M" Width="80px" Sortable="true"/>
                                    <GridColumn Key="BO_PurchaseInfoRecordID" Caption="采购信息记录" LabelType="L" Width="120px" Sortable="true"/>
                                    <GridColumn Key="BO_PurchasingGroupID" Caption="采购组" LabelType="M" Width="80px" Sortable="true"/>
                                    <GridColumn Key="BO_PurchaseReqSOID" Caption="采购申请" LabelType="H" Width="80px" Sortable="true"/>
                                    <GridColumn Key="BO_PurchaseRequisitioItem" Caption="行号" LabelType="H" Width="80px" Sortable="true"/>
                                    <GridColumn Key="BO_PurchaseRequisitionDtlOID" Caption="采购订单明细行OID" Visible="false" Width="80px"/>
                                    <GridColumn Key="BO_SortTerm" Caption="排序字符串" LabelType="H" Visible="false" Width="100px" Sortable="true"/>
                                    <GridColumn Key="BO_CostElementID" Caption="总账科目" Width="80px" Sortable="true"/>
                                    <GridColumn Key="BO_ValueTypeID" Caption="数值种类" LabelType="H" Width="80px"/>
                                    <GridColumn Key="BO_MaterialGroupID" Caption="物料组" LabelType="H" Width="80px" Sortable="true"/>
                                    <GridColumn Key="BO_VendorID" Caption="供应商" LabelType="H" Width="80px" Sortable="true"/>
                                    <GridColumn Key="BO_ReceiptProcessDay" Caption="收货处理时间" LabelType="M" Width="120px" Sortable="true"/>
                                    <GridColumn Key="BO_SOID" Caption="BO_SOID" Visible="Macro_DebugMode()" Width="80px" Sortable="true"/>
                                    <GridColumn Key="BO_IsRefurbishment" Caption="刷新物料" Visible="Macro_DebugMode()" Width="80px" Sortable="true"/>
                                    <GridColumn Key="BO_WorkCenterID" Caption="工作中心" LabelType="H" Visible="false" Width="80px" Sortable="true"/>
                                    <GridColumn Key="BO_IsChecked" Caption="已检查" LabelType="H" Visible="Macro_DebugMode()" Width="80px"/>
                                    <GridColumn Key="BO_RequisiteUnitID" Caption="接收单位" LabelType="H" Width="80px"/>
                                </GridColumnCollection>
                                <GridRowCollection>
                                    <GridRow Key="ComponentGridRow" TableKey="EPM_MaintenanceOrder_BOM">
                                        <GridCell Key="BO_IsSelect" Caption="选择" CellType="CheckBox" IsSelect="true"/>
                                        <GridCell Key="BO_OID" Caption="BO_OID" CellType="NumberEditor" Scale="0">
                                            <DataBinding ColumnKey="OID"/>
                                        </GridCell>
                                        <GridCell Key="BO_ProcessNo" Caption="项目" CellType="TextEditor" MaxLength="4" Trim="true">
                                            <DataBinding ColumnKey="ProcessNo"/>
                                        </GridCell>
                                        <GridCell Key="BO_MaterialID" Caption="组件" CellType="Dict" Enable="!ReadOnly() &amp;&amp; BO_MaterialID &lt;= 0 &amp;&amp; IIF(BO_ItemCategoryID &lt;= 0, true, GetDictValue('PP_ItemCategory', BO_ItemCategoryID, 'IsMaterial') &gt; 0)" ItemKey="Material">
                                            <DataBinding ColumnKey="MaterialID">
                                                <ValueChanged>
                                                    <![CDATA[Macro_CheckIfPipeMaterial();IIF(Length(BO_ProcessNo) == 0, SetValue('BO_ProcessNo',Right('0000'&((GetRowCount('ComponentGrid'))*10), 4)),true);SetValue('BO_IsBackFlush', com.bokesoft.erp.pm.function.MaintenanceOrderFormula.getBackFlush());]]>
                                                </ValueChanged>
                                                <CheckRule>
                                                    <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.checkMaterialInput(BO_PlantID, BO_MaterialID, BO_ItemCategoryID, BasicStartDate);]]>
                                                </CheckRule>
                                            </DataBinding>
                                            <ItemFilter>
                                                <Filter Key="Filter" Impl="com.bokesoft.yes.erp.condition.Filter" Type="Custom">
                                                    <FilterValue Index="1" ParaValue="IIF(PlanningPlantID&gt;0, 'OID IN ( Select BK_Material.OID FROM BK_Material  left join EGS_Material_Plant on BK_Material.SOID = EGS_Material_Plant.SOID  where  EGS_Material_Plant.PlantID='&amp;SqlPara(PlanningPlantID)&amp;' and EGS_Material_Plant.Status_Plant&lt;&gt;'&amp;SqlPara(2)&amp;' )', '1=2')"/>
                                                </Filter>
                                            </ItemFilter>
                                        </GridCell>
                                        <GridCell Key="BO_ShortText" Caption="短文本" CellType="TextEditor" Trim="true">
                                            <DataBinding ColumnKey="ShortText" DefaultFormulaValue="GetDictValue('Material', BO_MaterialID, 'Name')">
                                                <ValueChanged>
                                                    <![CDATA[IIF(Length(BO_ProcessNo) == 0,SetValue('BO_ProcessNo',Right('0000'&((GetPara('ProcessNum')+1)*10), 4)),true);]]>
                                                </ValueChanged>
                                            </DataBinding>
                                        </GridCell>
                                        <GridCell Key="BO_ParentMaintOrderRoutingOID" Caption="BO_ParentMaintOrderRoutingOID" CellType="NumberEditor" Scale="0" UseGroupingSeparator="false">
                                            <DataBinding ColumnKey="ParentMaintOrderRoutingOID"/>
                                        </GridCell>
                                        <GridCell Key="BO_RefProcessNo_Btn" Caption="对应的工序" CellType="TextButton" MaxLength="4" Trim="true">
                                            <DataBinding ColumnKey="RefProcessNo" Required="true">
                                                <ValueChanged>
                                                    <![CDATA[SetValue('BO_ParentMaintOrderRoutingOID', com.bokesoft.erp.pm.function.MaintenanceOrderFormula.getRefOperationDtlID(BO_RefProcessNo_Btn),false);Macro_RefreshIsComponent()]]>
                                                </ValueChanged>
                                            </DataBinding>
                                            <OnClick>
                                                <![CDATA[ERPShowModal('PM_ProductProcessSelect')]]>
                                            </OnClick>
                                        </GridCell>
                                        <GridCell Key="BO_RequirementQuantity" Caption="需求数量" CellType="NumberEditor" Enable="!ReadOnly()&amp;&amp;BO_IsRefurbishment==0" Scale="3">
                                            <DataBinding ColumnKey="RequirementQuantity" Required="true">
                                                <CheckRule>
                                                    <![CDATA[IIF(BO_ItemCategoryID > 0, Macro_CheckDemandQty(BO_ItemCategoryID, BO_RequirementQuantity, false, true), true);]]>
                                                </CheckRule>
                                            </DataBinding>
                                            <CellFormat HAlign="Right"/>
                                        </GridCell>
                                        <GridCell Key="BO_BaseQuantity" Caption="基本数量" CellType="NumberEditor" Enable="false" Scale="3">
                                            <DataBinding ColumnKey="BaseQuantity" Required="true">
                                                <DefaultFormulaValue>
                                                    <![CDATA[IIF(BO_MaterialID>0&&BO_BaseUnitID>0&&BO_UnitID>0,Macro_SetScaleByUnit(BO_RequirementQuantity*BO_Order2BaseNumerator/BO_Order2BaseDenominator,BO_BaseUnitID,0),BO_RequirementQuantity)]]>
                                                </DefaultFormulaValue>
                                            </DataBinding>
                                            <CellFormat HAlign="Right"/>
                                        </GridCell>
                                        <GridCell Key="BO_Order2BaseNumerator" Caption="订单到基本单位-分子" CellType="NumberEditor" Precision="9" Scale="0" UseGroupingSeparator="false">
                                            <DataBinding ColumnKey="Order2BaseNumerator">
                                                <DefaultFormulaValue>
                                                    <![CDATA[IIF(!isWFMapping(),IIF(BO_MaterialID>0&&BO_BaseUnitID>0&&BO_UnitID>0,com.bokesoft.erp.basis.unit.UnitFormula.getNume4MaTunit(BO_UnitID,BO_BaseUnitID,BO_MaterialID),1),BO_Order2BaseNumerator)]]>
                                                </DefaultFormulaValue>
                                            </DataBinding>
                                        </GridCell>
                                        <GridCell Key="BO_Order2BaseDenominator" Caption="订单到基本单位-分母" CellType="NumberEditor" Precision="9" Scale="0" UseGroupingSeparator="false">
                                            <DataBinding ColumnKey="Order2BaseDenominator">
                                                <DefaultFormulaValue>
                                                    <![CDATA[IIF(!isWFMapping(),IIF(BO_MaterialID>0&&BO_BaseUnitID>0&&BO_UnitID>0,com.bokesoft.erp.basis.unit.UnitFormula.getDeno4MaTunit(BO_UnitID,BO_BaseUnitID,BO_MaterialID),1),BO_Order2BaseDenominator)]]>
                                                </DefaultFormulaValue>
                                            </DataBinding>
                                        </GridCell>
                                        <GridCell Key="BO_ItemCategoryID" Caption="项目类别" CellType="Dict" Enable="BO_ItemCategoryID&lt;=0" ItemKey="PP_ItemCategory">
                                            <DataBinding ColumnKey="ItemCategoryID" Required="true">
                                                <ValueChanged>
                                                    <![CDATA[Macro_CheckIfPipeMaterial();IIF(GetDictValue('PP_ItemCategory', BO_ItemCategoryID, 'IsMaterial') == 0, SetValue('BO_MaterialID', 0, true), true);]]>
                                                </ValueChanged>
                                                <DefaultFormulaValue>
                                                    <![CDATA[IIF(BO_ItemCategoryID>0,BO_ItemCategoryID,com.bokesoft.erp.pm.function.MaintenanceOrderFormula.getAssemblyTypeID(BO_MaterialID,PlanningPlantID))]]>
                                                </DefaultFormulaValue>
                                            </DataBinding>
                                        </GridCell>
                                        <GridCell Key="BO_RequirementDate" Caption="需求日期" CellType="UTCDatePicker" Format="yyyy-MM-dd">
                                            <DataBinding ColumnKey="RequirementDate" ValueChangeAction="SetValue('BO_IsManualReqDateIndicator',1)">
                                                <DefaultFormulaValue>
                                                    <![CDATA[IIF(BO_IsManualReqDateIndicator,BO_RequirementDate,BasicStartDate)]]>
                                                </DefaultFormulaValue>
                                            </DataBinding>
                                        </GridCell>
                                        <GridCell Key="BO_RequirementTime" Caption="需求时间" CellType="TimePicker" Second="true">
                                            <DataBinding ColumnKey="RequirementTime" DefaultFormulaValue="GetValue(&quot;BasicStartTime&quot;)"/>
                                        </GridCell>
                                        <GridCell Key="BO_OffsetPos" Caption="偏置" CellType="NumberEditor" Precision="9" Scale="0" UseGroupingSeparator="false">
                                            <DataBinding ColumnKey="OffsetPos"/>
                                        </GridCell>
                                        <GridCell Key="BO_OffsetUnitID" Caption="偏置单位" CellType="Dict" ItemKey="Unit">
                                            <DataBinding ColumnKey="OffsetUnitID"/>
                                        </GridCell>
                                        <GridCell Key="BO_IsManualReqDateIndicator" Caption="手工需求日期" CellType="CheckBox">
                                            <DataBinding ColumnKey="IsManualReqDateIndicator"/>
                                        </GridCell>
                                        <GridCell Key="BO_ReservationSOID" Caption="预留" CellType="Dict" Enable="false" ItemKey="MM_Reservation__Dic" StateMask="Enable|Disable|Discard">
                                            <DataBinding ColumnKey="ReservationSOID"/>
                                        </GridCell>
                                        <GridCell Key="BO_ReservationDtlOID" Caption="预留明细号" CellType="NumberEditor" Scale="0" UseGroupingSeparator="false">
                                            <DataBinding ColumnKey="ReservationDtlOID"/>
                                        </GridCell>
                                        <GridCell Key="BO_ReservationItem" Caption="预留项目" CellType="NumberEditor" Enable="false" IntegerValue="true" Precision="9">
                                            <DataBinding ColumnKey="ReservationItem"/>
                                        </GridCell>
                                        <GridCell Key="BO_MoveTypeID" Caption="移动类型" CellType="Dict" Enable="false" ItemKey="MoveType">
                                            <DataBinding ColumnKey="MoveTypeID" ValueDependency="BO_ProcessNo, RO_IsSubcontract, RO_ControlCodeID">
                                                <DefaultFormulaValue>
                                                    <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.getMoveTypeIDByProcess(BO_RefProcessNo_Btn, BO_BaseQuantity, BO_ItemCategoryID)]]>
                                                </DefaultFormulaValue>
                                            </DataBinding>
                                        </GridCell>
                                        <GridCell Key="BO_CommittedQuantity" Caption="允许数量" CellType="NumberEditor" Enable="false" Scale="3">
                                            <DataBinding ColumnKey="CommittedQuantity"/>
                                            <CellFormat HAlign="Right"/>
                                        </GridCell>
                                        <GridCell Key="BO_RequisiteQuantity" Caption="领料数量" CellType="NumberEditor" Enable="false" Scale="3">
                                            <DataBinding ColumnKey="RequisiteQuantity"/>
                                            <CellFormat HAlign="Right"/>
                                        </GridCell>
                                        <GridCell Key="BO_BaseUnitID" Caption="基本单位" CellType="Dict" Enable="false" ItemKey="Unit">
                                            <DataBinding ColumnKey="BaseUnitID">
                                                <DefaultFormulaValue>
                                                    <![CDATA[IIF(BO_MaterialID > 0,GetDictValue('Material', BO_MaterialID, 'BaseUnitID'),BO_UnitID)]]>
                                                </DefaultFormulaValue>
                                            </DataBinding>
                                        </GridCell>
                                        <GridCell Key="BO_UnitID" Caption="单位" CellType="Dict" Enable="!ReadOnly()&amp;&amp;BO_IsRefurbishment==0" ItemKey="Unit">
                                            <DataBinding ColumnKey="UnitID" Required="true">
                                                <DefaultFormulaValue>
                                                    <![CDATA[IIF(BO_MaterialID > 0,GetDictValue('Material', BO_MaterialID, 'BaseUnitID'))]]>
                                                </DefaultFormulaValue>
                                            </DataBinding>
                                            <ItemFilter ItemKey="Unit">
                                                <Filter Key="Filter" Impl="com.bokesoft.yes.erp.condition.Filter" Type="Custom">
                                                    <FilterValue Index="1" ParaValue="IIF(BO_MaterialID&gt;0,'soid in ('&amp;com.bokesoft.erp.basis.unit.UnitFormula.getUnitFmMaterial(BO_MaterialID)&amp;')','1=1')"/>
                                                </Filter>
                                            </ItemFilter>
                                        </GridCell>
                                        <GridCell Key="BO_DivisionID" Caption="产品部门" CellType="Dict" ItemKey="Division">
                                            <DataBinding ColumnKey="DivisionID">
                                                <DefaultFormulaValue>
                                                    <![CDATA[GetDictValue('Material', BO_MaterialID, 'DivisionID')]]>
                                                </DefaultFormulaValue>
                                            </DataBinding>
                                        </GridCell>
                                        <GridCell Key="BO_IsFixedQuantity" Caption="数量固定" CellType="CheckBox">
                                            <DataBinding ColumnKey="IsFixedQuantity"/>
                                        </GridCell>
                                        <GridCell Key="BO_IsFinalDelivery" Caption="最后的发货" CellType="CheckBox" Enable="false">
                                            <DataBinding ColumnKey="IsFinalDelivery"/>
                                        </GridCell>
                                        <GridCell Key="BO_PlantID" Caption="工厂" CellType="Dict" ItemKey="Plant">
                                            <DataBinding ColumnKey="PlantID" DefaultFormulaValue="PlanningPlantID">
                                                <ValueChanged>
                                                    <![CDATA[IIF(BO_IsRefurbishment==1,SetValue('FromPlantID', BO_PlantID),true);]]>
                                                </ValueChanged>
                                                <CheckRule>
                                                    <![CDATA[IIFS(BO_PlantID>0&&GetDictValue('Plant', BO_PlantID, 'CompanyCodeID')!=GetDictValue('Plant', PlanningPlantID, 'CompanyCodeID'),MessageFacade('IW038','计划工厂的成本结算区域与物料工厂不是同一个'),BO_PlantID<=0, MessageFacade('PM_MAINTENANCEORDER008','请输入工厂'),true,true)]]>
                                                </CheckRule>
                                            </DataBinding>
                                        </GridCell>
                                        <GridCell Key="BO_StorageLocationID" Caption="库存地点" CellType="Dict" ItemKey="StorageLocation">
                                            <DataBinding ColumnKey="StorageLocationID"/>
                                            <ItemFilter ItemKey="StorageLocation">
                                                <Filter Key="Filter" Impl="com.bokesoft.yes.erp.condition.Filter" Type="Custom">
                                                    <FilterValue Index="1" ParaValue="'PlantID='&amp;SqlPara(BO_PlantID)"/>
                                                </Filter>
                                            </ItemFilter>
                                        </GridCell>
                                        <GridCell Key="BO_BatchCode" Caption="批次" CellType="TextEditor" Enable="!ReadOnly()&amp;&amp;Macro_MaterialIsBatchManagement(BO_PlantID,BO_MaterialID)" Case="Upper" MaxLength="30" Trim="true">
                                            <DataBinding ColumnKey="BatchCode" DefaultValue="_"/>
                                        </GridCell>
                                        <GridCell Key="BO_StatusItem" Caption="项目状态" CellType="ComboBox" Enable="false" IntegerValue="true">
                                            <DataBinding ColumnKey="StatusItem" DefaultFormulaValue="0"/>
                                            <Item Key="0" Value="0"/>
                                            <Item Key="1" Caption="删除" Value="1"/>
                                        </GridCell>
                                        <GridCell Key="BO_IsBulkMaterial" Caption="散装物料" CellType="CheckBox">
                                            <DataBinding ColumnKey="IsBulkMaterial"/>
                                        </GridCell>
                                        <GridCell Key="BO_IsBackFlush" Caption="反冲" CellType="CheckBox">
                                            <DataBinding ColumnKey="IsBackFlush"/>
                                        </GridCell>
                                        <GridCell Key="BO_IsAllowedMovment" Caption="允许的货物移动" CellType="CheckBox" Enable="false">
                                            <DataBinding ColumnKey="IsAllowedMovment">
                                                <DefaultFormulaValue>
                                                    <![CDATA[IIF(BO_ItemCategoryID > 0, Macro_IsREL() && GetDictValue('PP_ItemCategory', BO_ItemCategoryID, 'IsTextProject')==0 && GetDictValue('PP_ItemCategory', BO_ItemCategoryID, 'Code')!='N' && BO_MaterialID > 0 &&  BO_RequisitionCreationControl != 1, BO_IsAllowedMovment)]]>
                                                </DefaultFormulaValue>
                                            </DataBinding>
                                        </GridCell>
                                        <GridCell Key="BO_RequisitionCreationControl" Caption="预留/采购申请" CellType="ComboBox" IntegerValue="true" GroupKey="GenerateControl" SourceType="ParaGroup">
                                            <DataBinding ColumnKey="RequisitionCreationControl">
                                                <ValueChanged>
                                                    <![CDATA[IIF(Macro_IsREL() && BO_RequisitionCreationControl == 2,  Macro_RevertResPurReq('BO_RequisitionCreationControl'), true);]]>
                                                </ValueChanged>
                                                <DefaultFormulaValue>
                                                    <![CDATA[IIF(Macro_IsREL() && BO_RequisitionCreationControl == 2, 3, IIF(BO_RequisitionCreationControl < 1 && RequisitionCreationControl > 0, RequisitionCreationControl, BO_RequisitionCreationControl))]]>
                                                </DefaultFormulaValue>
                                            </DataBinding>
                                        </GridCell>
                                        <GridCell Key="BO_RelevancyToCostingID" Caption="成本核算相关" CellType="Dict" ItemKey="PP_RelevancyToCosting">
                                            <DataBinding ColumnKey="RelevancyToCostingID"/>
                                        </GridCell>
                                        <GridCell Key="BO_ProvisionIndicator" Caption="物料供应标识" CellType="ComboBox" GroupKey="MaterialSupplyIdentification" SourceType="ParaGroup">
                                            <DataBinding ColumnKey="ProvisionIndicator"/>
                                        </GridCell>
                                        <GridCell Key="BO_AccountAssignmentCategoryID" Caption="科目分配类别" CellType="Dict" ItemKey="AccountAssignmentCategory">
                                            <DataBinding ColumnKey="AccountAssignmentCategoryID"/>
                                        </GridCell>
                                        <GridCell Key="BO_SpecialIdentity" Caption="特殊库存标识" CellType="ComboBox" SourceType="ParaGroup" GroupKey="SpecialIdentity">
                                            <DataBinding ColumnKey="SpecialIdentity">
                                                <DefaultFormulaValue>
                                                    <![CDATA[IIF(BO_AccountAssignmentCategoryID>0,GetDictValue('AccountAssignmentCategory', BO_AccountAssignmentCategoryID, 'SpecialIdentity'),'_')]]>
                                                </DefaultFormulaValue>
                                            </DataBinding>
                                        </GridCell>
                                        <GridCell Key="BO_DynIdentityID" Caption="特殊库存" CellType="DynamicDict" Enable="false" IsDynamic="true" RefDataElementKey="BO_DynIdentityIDDEKey">
                                            <DataBinding ColumnKey="DynIdentityID">
                                                <CheckRule>
                                                    <![CDATA[IIFS(BO_SpecialIdentity=='_', true, BO_SpecialIdentity=='E'&&BO_DynIdentityID<=0, MessageFacade('CO714','请输入订单'), BO_SpecialIdentity=='K'&&BO_DynIdentityID<=0, '请输入(寄售)供应商', BO_SpecialIdentity=='O'&&BO_DynIdentityID<=0, MessageFacade('PM_MAINTENANCEORDER013','请输入分包供应商'), BO_SpecialIdentity=='Q'&&BO_DynIdentityID<=0, MessageFacade('PM_MAINTENANCEORDER014','请输入项目库存'), BO_SpecialIdentity=='W'&&BO_DynIdentityID<=0, MessageFacade('PM_MAINTENANCEORDER015','请输入(寄售)客户'), BO_SpecialIdentity=='V'&&BO_DynIdentityID<=0, MessageFacade('PM_MAINTENANCEORDER016','请输入(可回收包装物)客户'), true, true)]]>
                                                </CheckRule>
                                                <DefaultFormulaValue>
                                                    <![CDATA[IIF(BO_SpecialIdentity=='E'&&BO_MaterialID>0&&BO_PlantID>0&&Macro_GetOrgProp('BO_MaterialID', 'IndividualOrCollective', BO_PlantID)!=2,IIFS(BO_SpecialIdentity=='E', SaleOrderDtlOID, BO_SpecialIdentity=='Q', WBSElementID, true, 0),0)]]>
                                                </DefaultFormulaValue>
                                            </DataBinding>
                                        </GridCell>
                                        <GridCell Key="BO_DynIdentityIDDEKey" Caption="特殊库存字典Key" CellType="TextEditor">
                                            <DataBinding ColumnKey="DynIdentityIDDEKey" DefaultFormulaValue="Macro_GetIdentityDataElementKey(SpecialIdentity)"/>
                                        </GridCell>
                                        <GridCell Key="BO_ValuationSpecialStock" Caption="评估" CellType="ComboBox" GroupKey="Assessment" SourceType="ParaGroup">
                                            <DataBinding ColumnKey="ValuationSpecialStock"/>
                                        </GridCell>
                                        <GridCell Key="BO_ConsumptionIndicator" Caption="消耗过账" CellType="ComboBox" GroupKey="ConsumptionIndicator" SourceType="ParaGroup">
                                            <DataBinding ColumnKey="ConsumptionIndicator"/>
                                        </GridCell>
                                        <GridCell Key="BO_PlannedDeliveryDay" Caption="计划交货时间(天)" CellType="NumberEditor" Precision="9" Scale="0" UseGroupingSeparator="false">
                                            <DataBinding ColumnKey="PlannedDeliveryDay"/>
                                        </GridCell>
                                        <GridCell Key="BO_NetPriceQuantity" Caption="价格数量" CellType="NumberEditor" Scale="3">
                                            <DataBinding ColumnKey="NetPriceQuantity" DefaultFormulaValue="1"/>
                                            <CellFormat HAlign="Right"/>
                                        </GridCell>
                                        <GridCell Key="BO_NetPrice" Caption="净价" CellType="NumberEditor" Scale="6">
                                            <DataBinding ColumnKey="NetPrice"/>
                                            <CellFormat HAlign="Right"/>
                                        </GridCell>
                                        <GridCell Key="BO_Money" Caption="金额" CellType="NumberEditor" Enable="false">
                                            <DataBinding ColumnKey="Money"/>
                                            <CellFormat HAlign="Right"/>
                                        </GridCell>
                                        <GridCell Key="BO_NetPriceCurrencyID" Caption="币种" CellType="Dict" Enable="false" ItemKey="Currency">
                                            <DataBinding ColumnKey="NetPriceCurrencyID">
                                                <DefaultFormulaValue>
                                                    <![CDATA[GetDictValue('CompanyCode', GetDictValue('Plant', RO_PlantID, 'CompanyCodeID'), 'CurrencyID')]]>
                                                </DefaultFormulaValue>
                                            </DataBinding>
                                        </GridCell>
                                        <GridCell Key="BO_PurchasingOrganizationID" Caption="采购组织" CellType="Dict" ItemKey="PurchasingOrganization">
                                            <DataBinding ColumnKey="PurchasingOrganizationID"/>
                                        </GridCell>
                                        <GridCell Key="BO_PurchaseInfoRecordID" Caption="采购信息记录" CellType="Dict" ItemKey="MM_PurchaseInfoRecord">
                                            <DataBinding ColumnKey="PurchaseInfoRecordID"/>
                                        </GridCell>
                                        <GridCell Key="BO_PurchasingGroupID" Caption="采购组" CellType="Dict" ItemKey="PurchasingGroup">
                                            <DataBinding ColumnKey="PurchasingGroupID">
                                                <CheckRule>
                                                    <![CDATA[IIF(GetDictValue('PP_ItemCategory', BO_ItemCategoryID, 'Code')!='N'||(GetDictValue('PP_ItemCategory', BO_ItemCategoryID, 'Code')=='N'&&BO_PurchasingGroupID>0),true,MessageFacade('SE192','非库存项目请输入采购组'))]]>
                                                </CheckRule>
                                            </DataBinding>
                                        </GridCell>
                                        <GridCell Key="BO_PurchaseReqSOID" Caption="采购申请" CellType="Dict" Enable="false" ItemKey="MM_PurchaseRequisition__Dic" StateMask="Enable|Disable|Discard">
                                            <DataBinding ColumnKey="PurchaseReqSOID"/>
                                        </GridCell>
                                        <GridCell Key="BO_PurchaseRequisitioItem" Caption="行号" CellType="TextEditor" Enable="false" MaxLength="100" Trim="true">
                                            <DataBinding ColumnKey="PurchaseRequisitioItem"/>
                                        </GridCell>
                                        <GridCell Key="BO_PurchaseRequisitionDtlOID" Caption="采购订单明细行OID" CellType="NumberEditor" Enable="false" Scale="0">
                                            <DataBinding ColumnKey="PurchaseRequisitionDtlOID"/>
                                            <CellFormat HAlign="Right"/>
                                        </GridCell>
                                        <GridCell Key="BO_SortTerm" Caption="排序字符串" CellType="TextEditor" MaxLength="100" Trim="true">
                                            <DataBinding ColumnKey="SortTerm"/>
                                        </GridCell>
                                        <GridCell Key="BO_CostElementID" Caption="总账科目" CellType="Dict" Enable="!ReadOnly()&amp;&amp;GetDictValue('PP_ItemCategory', BO_ItemCategoryID, 'Code')=='N'" ItemKey="CO_CostElement">
                                            <DataBinding ColumnKey="CostElementID">
                                                <CheckRule>
                                                    <![CDATA[IIF(GetDictValue('PP_ItemCategory', BO_ItemCategoryID, 'Code')!='N'||(GetDictValue('PP_ItemCategory', BO_ItemCategoryID, 'Code')=='N'&&BO_CostElementID>0),true,MessageFacade('SE121','非库存项目请输入成本要素'))]]>
                                                </CheckRule>
                                                <DefaultFormulaValue>
                                                    <![CDATA[IIF(BO_MaterialID > 0 && BO_MoveTypeID > 0 && OrgControllingAreaID > 0 && BO_PlantID > 0 && (GetDictValue('PP_ItemCategory', BO_ItemCategoryID, 'Code')=='N'),com.bokesoft.erp.co.formula.PMOrderCostFormula.getCostElementIDByMaterial(BO_MoveTypeID,BO_SpecialIdentity,OrgControllingAreaID,BO_PlantID,BO_MaterialID,BO_BaseQuantity), BO_CostElementID)]]>
                                                </DefaultFormulaValue>
                                            </DataBinding>
                                            <ItemFilter>
                                                <Filter Key="Filter" Impl="com.bokesoft.yes.erp.condition.Filter" Type="Custom">
                                                    <FilterValue Index="1" ParaValue="IIF(BO_PlantID&gt;0, &quot;ControllingAreaID = (select ControllingAreaID from EGS_COACAssignCpyCodeDtl where CompanyCodeID = (select CompanyCodeID from bk_plant where oid = &quot;&amp;SqlPara(BO_PlantID)&amp;&quot;)) and IsPrimaryCostEle=&quot;&amp;SqlPara(1), &quot;1=2&quot;);"/>
                                                </Filter>
                                            </ItemFilter>
                                        </GridCell>
                                        <GridCell Key="BO_ValueTypeID" Caption="数值种类" CellType="Dict" Enable="false" ItemKey="CO_ValueType">
                                            <DataBinding ColumnKey="ValueTypeID">
                                                <DefaultFormulaValue>
                                                    <![CDATA[com.bokesoft.erp.co.formula.PMOrderCostFormula.getValueTypeByCostElement('PM',OrgControllingAreaID,BO_CostElementID)]]>
                                                </DefaultFormulaValue>
                                            </DataBinding>
                                        </GridCell>
                                        <GridCell Key="BO_MaterialGroupID" Caption="物料组" CellType="Dict" ItemKey="MaterialGroup">
                                            <DataBinding ColumnKey="MaterialGroupID">
                                                <CheckRule>
                                                    <![CDATA[IIF(GetDictValue('PP_ItemCategory', BO_ItemCategoryID, 'Code')!='N'||(GetDictValue('PP_ItemCategory', BO_ItemCategoryID, 'Code')=='N'&&BO_MaterialGroupID>0),true,MessageFacade('SE193','非库存项目请输入物料组'))]]>
                                                </CheckRule>
                                                <DefaultFormulaValue>
                                                    <![CDATA[GetDictValue('MM_PurchaseInfoRecord', BO_PurchaseInfoRecordID, 'MaterialGroupID')]]>
                                                </DefaultFormulaValue>
                                            </DataBinding>
                                        </GridCell>
                                        <GridCell Key="BO_VendorID" Caption="供应商" CellType="Dict" ItemKey="Vendor">
                                            <DataBinding ColumnKey="VendorID">
                                                <DefaultFormulaValue>
                                                    <![CDATA[GetDictValue('MM_PurchaseInfoRecord', BO_PurchaseInfoRecordID, 'VendorID')]]>
                                                </DefaultFormulaValue>
                                            </DataBinding>
                                        </GridCell>
                                        <GridCell Key="BO_ReceiptProcessDay" Caption="收货处理时间" CellType="NumberEditor" Precision="9" Scale="0" UseGroupingSeparator="false">
                                            <DataBinding ColumnKey="ReceiptProcessDay"/>
                                        </GridCell>
                                        <GridCell Key="BO_SOID" Caption="BO_SOID" CellType="NumberEditor" Scale="0">
                                            <DataBinding ColumnKey="SOID"/>
                                        </GridCell>
                                        <GridCell Key="BO_IsRefurbishment" Caption="刷新物料" CellType="CheckBox" Enable="false">
                                            <DataBinding ColumnKey="IsRefurbishment"/>
                                        </GridCell>
                                        <GridCell Key="BO_WorkCenterID" Caption="工作中心" CellType="Dict" ItemKey="WorkCenter">
                                            <DataBinding ColumnKey="WorkCenterID">
                                                <DefaultFormulaValue>
                                                    <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.getWorkCenterIDByProcessNo(BO_RefProcessNo_Btn)]]>
                                                </DefaultFormulaValue>
                                            </DataBinding>
                                        </GridCell>
                                        <GridCell Key="BO_IsChecked" Caption="已检查" CellType="CheckBox">
                                            <DataBinding ColumnKey="BO_IsChecked"/>
                                        </GridCell>
                                        <GridCell Key="BO_RequisiteUnitID" Caption="接收单位" CellType="Dict" ItemKey="Unit">
                                            <DataBinding ColumnKey="RequisiteUnitID"/>
                                        </GridCell>
                                    </GridRow>
                                </GridRowCollection>
                                <RowClick>
                                    <![CDATA[SetPara('ProcessNum', GetFocusRow('ComponentGrid'))]]>
                                </RowClick>
                                <OnRowDelete>
                                    <![CDATA[if (BO_IsRefurbishment==1) {RaiseErrMsg('IW823', '对待修理的元件的删除不在计划中');} else {if(IsReleased&&!IsNewDtl()){SetValue('BO_StatusItem',1);}else{DeleteRow();Macro_ReSetProcessNo('BO_ProcessNo')}};]]>
                                </OnRowDelete>
                                <GridFilter Op="OR">
                                    <FilterValue Index="1" FieldKey="BO_StatusItem" RefValue="ToBool(GetPara('_IsDisplayDeletions'))" DataType="Integer"/>
                                    <FilterValue Index="2" FieldKey="BO_StatusItem" RefValue="0" DataType="Integer"/>
                                </GridFilter>
                            </Grid>
                            <TabPanel Key="ComponentMirrorTabPanel">
                                <SubDetail Key="ComponentMirrorGeneralDataSubDetail" Caption="一般数据" BindingGridKey="ComponentGrid">
                                    <GridLayoutPanel Key="ComponentMirrorGeneralDataGridLayoutPanel" Caption="一般数据" Padding="8px" OverflowY="Auto">
                                        <Dict Key="BO_PlantID__mirror" Caption="工厂" X="0" Y="1" Visible="true" BindingCellKey="BO_PlantID" ItemKey="Plant"/>
                                        <Dict Key="BO_StorageLocationID__mirror" Caption="库存地点" X="0" Y="2" Visible="true" BindingCellKey="BO_StorageLocationID" ItemKey="StorageLocation"/>
                                        <TextEditor Key="BO_BatchCode__mirror" Caption="批次" X="0" Y="3" Visible="true" BindingCellKey="BO_BatchCode" MaxLength="30" Trim="true"/>
                                        <Label Key="ComponentLab" Caption="组件" X="0" Y="0" Visible="true" Enable="false" Class="erp-group-title" XSpan="3"/>
                                        <UTCDatePicker Key="BO_RequirementDate__mirror" Caption="需求日期" X="1" Y="1" Visible="true" BindingCellKey="BO_RequirementDate" Format="yyyy-MM-dd"/>
                                        <TimePicker Key="BO_RequirementTime__mirror" Caption="需求时间" BindingCellKey="BO_RequirementTime" Second="true" Visible="true" X="2" Y="1"/>
                                        <NumberEditor Key="BO_OffsetPos__mirror" Caption="偏置" X="1" Y="3" Visible="true" BindingCellKey="BO_OffsetPos" IntegerValue="true" Scale="0" UseGroupingSeparator="false"/>
                                        <Dict Key="BO_OffsetUnitID__mirror" Caption="偏置单位" X="2" Y="3" Visible="true" BindingCellKey="BO_OffsetUnitID" ItemKey="Unit"/>
                                        <CheckBox Key="BO_IsManualReqDateIndicator__mirror" Caption="手工需求日期" X="2" Y="2" Visible="true" BindingCellKey="BO_IsManualReqDateIndicator"/>
                                        <Dict Key="BO_ReservationSOID__mirror" Caption="预留" X="0" Y="4" Visible="true" Enable="false" BindingCellKey="BO_ReservationSOID" ItemKey="MM_Reservation__Dic" StateMask="Enable|Disable|Discard"/>
                                        <NumberEditor Key="BO_ReservationItem__mirror" Caption="预留项目" X="1" Y="4" Visible="true" Enable="false" BindingCellKey="BO_ReservationItem" IntegerValue="true" Precision="9"/>
                                        <Dict Key="BO_MoveTypeID__mirror" Caption="移动类型" X="2" Y="4" Visible="true" Enable="false" BindingCellKey="BO_MoveTypeID" ItemKey="MoveType"/>
                                        <Label Key="Shuliang" Caption="数量" X="3" Y="0" Visible="true" Enable="false" Class="erp-group-title" XSpan="2"/>
                                        <NumberEditor Key="BO_RequirementQuantity__mirror" Caption="需求数量" X="3" Y="1" Visible="true" BindingCellKey="BO_RequirementQuantity" Scale="3"/>
                                        <NumberEditor Key="BO_CommittedQuantity__mirror" Caption="允许数量" X="3" Y="2" Visible="true" Enable="false" BindingCellKey="BO_CommittedQuantity" Scale="3"/>
                                        <NumberEditor Key="BO_RequisiteQuantity__mirror" Caption="领料数量" X="3" Y="3" Visible="true" Enable="false" BindingCellKey="BO_RequisiteQuantity" Scale="3"/>
                                        <Dict Key="BO_BaseUnitID__mirror" Caption="基本单位" X="4" Y="4" Visible="true" BindingCellKey="BO_BaseUnitID" ItemKey="Unit"/>
                                        <CheckBox Key="BO_IsFixedQuantity__mirror" Caption="数量固定" X="4" Y="2" Visible="true" BindingCellKey="BO_IsFixedQuantity"/>
                                        <CheckBox Key="BO_IsFinalDelivery__mirror" Caption="最后的发货" X="4" Y="3" Visible="true" Enable="false" BindingCellKey="BO_IsFinalDelivery"/>
                                        <Label Key="GeneralIndicatorLab" Caption="一般标识" X="5" Y="0" Visible="true" Enable="false" Class="erp-group-title" XSpan="2"/>
                                        <CheckBox Key="BO_IsBackFlush__mirror" Caption="反冲" X="5" Y="1" Visible="true" BindingCellKey="BO_IsBackFlush"/>
                                        <ComboBox Key="BO_RequisitionCreationControl__mirror" Caption="预留/采购申请" X="6" Y="1" Visible="true" SourceType="ParaGroup" BindingCellKey="BO_RequisitionCreationControl" IntegerValue="true" GroupKey="GenerateControl"/>
                                        <CheckBox Key="BO_IsBulkMaterial__mirror" Caption="散装物料" X="5" Y="2" Visible="true" BindingCellKey="BO_IsBulkMaterial"/>
                                        <Dict Key="BO_RelevancyToCostingID__mirror" Caption="成本核算相关" X="5" Y="4" Visible="true" BindingCellKey="BO_RelevancyToCostingID" ItemKey="PP_RelevancyToCosting" XSpan="2"/>
                                        <CheckBox Key="BO_IsAllowedMovment__mirror" Caption="允许的移动" X="5" Y="3" Visible="true" BindingCellKey="BO_IsAllowedMovment"/>
                                        <ComboBox Key="BO_ProvisionIndicator__mirror" Caption="物料供应标识" X="6" Y="3" Visible="true" Enable="false" SourceType="ParaGroup" BindingCellKey="BO_ProvisionIndicator" GroupKey="MaterialSupplyIdentification">
                                            <DataBinding DefaultValue="_"/>
                                        </ComboBox>
                                        <Dict Key="BO_AccountAssignmentCategoryID__mirror" Caption="科目分配类别" X="5" Y="5" Visible="true" BindingCellKey="BO_AccountAssignmentCategoryID" ItemKey="AccountAssignmentCategory"/>
                                        <ComboBox Key="BO_SpecialIdentity__mirror" Caption="特殊库存" X="6" Y="5" Visible="true" SourceType="Formula" BindingCellKey="BO_SpecialIdentity">
                                            <FormulaItems>
                                                <![CDATA[Macro_GetAllSpecialIdentity()]]>
                                            </FormulaItems>
                                        </ComboBox>
                                        <NumberEditor Key="BO_BaseQuantity__mirror" Caption="基本数量" X="3" Y="4" Visible="true" BindingCellKey="BO_BaseQuantity" Scale="3">
                                            <DataBinding/>
                                            <Format HAlign="Right"/>
                                        </NumberEditor>
                                        <Dict Key="BO_UnitID__mirror" Caption="单位" X="4" Y="1" BindingCellKey="BO_UnitID" ItemKey="Unit">
                                            <DataBinding/>
                                        </Dict>
                                        <RowDefCollection RowGap="24">
                                            <RowDef Height="32px"/>
                                            <RowDef Height="32px"/>
                                            <RowDef Height="32px"/>
                                            <RowDef Height="32px"/>
                                            <RowDef Height="32px"/>
                                            <RowDef Height="32px"/>
                                        </RowDefCollection>
                                        <ColumnDefCollection ColumnGap="16">
                                            <ColumnDef Width="15%"/>
                                            <ColumnDef Width="14%"/>
                                            <ColumnDef Width="14%"/>
                                            <ColumnDef Width="14%"/>
                                            <ColumnDef Width="14%"/>
                                            <ColumnDef Width="14%"/>
                                            <ColumnDef Width="15%"/>
                                        </ColumnDefCollection>
                                    </GridLayoutPanel>
                                </SubDetail>
                                <SubDetail Key="ComponentMirrorTabPurchasingDataSubDetail" Caption="采购数据" BindingGridKey="ComponentGrid">
                                    <GridLayoutPanel Key="ComponentMirrorTabPurchasingDataGridLayoutPanel" Caption="采购数据" Padding="8px" OverflowY="Auto" TopPadding="24px" Visible="GetDictValue('PP_ItemCategory', BO_ItemCategoryID, 'Code') == 'N'">
                                        <NumberEditor Key="BO_RequirementQuantity__mirror1" Caption="需求数量" X="0" Y="0" Visible="true" BindingCellKey="BO_RequirementQuantity" Scale="3"/>
                                        <Dict Key="BO_BaseUnitID__mirror1" Caption="计量单位" X="1" Y="0" Visible="true" BindingCellKey="BO_BaseUnitID" ItemKey="Unit"/>
                                        <NumberEditor Key="BO_NetPrice__mirror" Caption="价格" X="0" Y="1" Visible="true" BindingCellKey="BO_NetPrice" Scale="3">
                                            <DataBinding/>
                                        </NumberEditor>
                                        <Dict Key="BO_NetPriceCurrencyID__mirror" Caption="币种" X="1" Y="1" Visible="true" BindingCellKey="BO_NetPriceCurrencyID" ItemKey="Currency"/>
                                        <NumberEditor Key="BO_NetPriceQuantity__mirror" Caption="价格数量" X="0" Y="2" Visible="true" BindingCellKey="BO_NetPriceQuantity" Scale="3"/>
                                        <Dict Key="BO_BaseUnitID__mirror2" Caption="计量单位" X="1" Y="2" Visible="true" BindingCellKey="BO_BaseUnitID" ItemKey="Unit"/>
                                        <Dict Key="BO_MaterialGroupID__mirror" Caption="物料组" X="2" Y="0" Visible="true" BindingCellKey="BO_MaterialGroupID" ItemKey="MaterialGroup" XSpan="2"/>
                                        <Dict Key="BO_PurchasingGroupID__mirror" Caption="采购组" X="2" Y="1" Visible="true" BindingCellKey="BO_PurchasingGroupID" ItemKey="PurchasingGroup" XSpan="2"/>
                                        <Dict Key="BO_PurchasingOrganizationID__mirror" Caption="采购组织" X="4" Y="1" Visible="true" BindingCellKey="BO_PurchasingOrganizationID" ItemKey="PurchasingOrganization"/>
                                        <Dict Key="BO_CostElementID__mirror" Caption="总账科目" X="4" Y="0" Visible="true" BindingCellKey="BO_CostElementID" ItemKey="CO_CostElement"/>
                                        <Dict Key="BO_VendorID__mirror" Caption="供应商" X="2" Y="2" Visible="true" BindingCellKey="BO_VendorID" ItemKey="Vendor" XSpan="2"/>
                                        <Dict Key="BO_PurchaseInfoRecordID__mirror" Caption="信息记录" X="4" Y="2" Visible="true" BindingCellKey="BO_PurchaseInfoRecordID" ItemKey="MM_PurchaseInfoRecord"/>
                                        <NumberEditor Key="BO_ReceiptProcessDay__mirror" Caption="收货处理时间" X="5" Y="1" Visible="true" BindingCellKey="BO_ReceiptProcessDay" IntegerValue="true" Scale="0" UseGroupingSeparator="false"/>
                                        <NumberEditor Key="BO_PlannedDeliveryDay__mirror" Caption="计划交货时间(天)" X="5" Y="0" Visible="true" BindingCellKey="BO_PlannedDeliveryDay" IntegerValue="true" Scale="0" UseGroupingSeparator="false"/>
                                        <Dict Key="BO_PurchaseReqSOID__mirror" Caption="采购申请" X="0" Y="4" Visible="true" Enable="false" BindingCellKey="BO_PurchaseReqSOID" ItemKey="MM_PurchaseRequisition__Dic" StateMask="Enable|Disable|Discard"/>
                                        <TextEditor Key="BO_PurchaseRequisitioItem__mirror" Caption="采购申请项目" X="1" Y="4" Visible="true" Enable="false" BindingCellKey="BO_PurchaseRequisitioItem" MaxLength="100" Trim="true"/>
                                        <Label Key="BOMActualDataLab" Caption="实际数据" X="0" Y="3" Class="erp-group-title" XSpan="6">
                                            <DataBinding/>
                                        </Label>
                                        <NumberEditor Key="BO_ReceivedQuantity__mirror" Caption="已接收" X="2" Y="4" Enable="false" BindingCellKey="BO_RequisiteQuantity">
                                            <DataBinding/>
                                            <Format HAlign="Right"/>
                                        </NumberEditor>
                                        <Dict Key="BO_RequisiteUnitID__mirror" Caption="接收单位" X="3" Y="4" Enable="false" BindingCellKey="BO_RequisiteUnitID" ItemKey="Unit">
                                            <DataBinding/>
                                        </Dict>
                                        <RowDefCollection RowGap="24">
                                            <RowDef Height="32px"/>
                                            <RowDef Height="32px"/>
                                            <RowDef Height="32px"/>
                                            <RowDef Height="32px"/>
                                            <RowDef Height="32px"/>
                                        </RowDefCollection>
                                        <ColumnDefCollection ColumnGap="16">
                                            <ColumnDef Width="16%"/>
                                            <ColumnDef Width="16%"/>
                                            <ColumnDef Width="17%"/>
                                            <ColumnDef Width="17%"/>
                                            <ColumnDef Width="17%"/>
                                            <ColumnDef Width="17%"/>
                                        </ColumnDefCollection>
                                    </GridLayoutPanel>
                                </SubDetail>
                            </TabPanel>
                            <SplitSize Size="38%"/>
                            <SplitSize Size="62%"/>
                        </SplitPanel>
                        <GridLayoutPanel Key="MissingConponentsGridLayoutPanel" Caption="短缺件总览" Padding="8px" OverflowY="Auto" Visible="ATPStatus != 0">
                            <CheckBox Key="IsAllComponents" Caption="全部组件" LabelType="M" X="1" Y="0" Visible="true" Enable="!ReadOnly() &amp;&amp; IsAllComponents == 0">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="IsAllComponents">
                                    <ValueChanged>
                                        <![CDATA[IIF(IsAllComponents==1,SetValue('IsMissingPartsOnly', 0, false),true)]]>
                                    </ValueChanged>
                                </DataBinding>
                            </CheckBox>
                            <CheckBox Key="IsMissingPartsOnly" Caption="仅遗失部分" LabelType="M" X="2" Y="0" Visible="true" Enable="!ReadOnly() &amp;&amp; IsMissingPartsOnly == 0" XSpan="2">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="IsMissingPartsOnly" DefaultValue="1">
                                    <ValueChanged>
                                        <![CDATA[IIF(IsMissingPartsOnly==1,SetValue('IsAllComponents', 0, false), true)]]>
                                    </ValueChanged>
                                </DataBinding>
                            </CheckBox>
                            <Grid Key="MissingConponentsGrid" Caption="短缺件总览" NewEmptyRow="false" SerialSeq="true" X="0" XSpan="16" Y="1" DisabledOption="insert,delete,sum,groupSum">
                                <GridColumnCollection>
                                    <GridColumn Key="IsSelect_miss_grid" Width="32px"/>
                                    <GridColumn Key="RelationBillDtlID" Caption="RelationBillDtlID" Visible="Macro_DebugMode()" Width="80px"/>
                                    <GridColumn Key="ATPPlantID" Caption="工厂" LabelType="H" Width="80px"/>
                                    <GridColumn Key="ATPMaterialID" Caption="物料" LabelType="H" Width="80px"/>
                                    <GridColumn Key="ATPRequirementDate" Caption="需求日期" LabelType="H" Width="100px"/>
                                    <GridColumn Key="ATPRequirementQuantity" Caption="需求数量" LabelType="H" Width="100px"/>
                                    <GridColumn Key="ATPBaseUnitID" Caption="基本计量单位" Width="120px"/>
                                    <GridColumn Key="ATPBatchCode" Caption="批次" LabelType="H" Width="80px"/>
                                    <GridColumn Key="ATPStorageLocationID" Caption="库存地点" LabelType="M" Width="80px"/>
                                    <GridColumn Key="ATPCommittedQuantity" Caption="已确认数量" Width="100px"/>
                                    <GridColumn Key="ATPQuantity" Caption="ATP数量" LabelType="H" Width="100px"/>
                                    <GridColumn Key="POID" Caption="POID" Visible="Macro_DebugMode()" Width="80px" Sortable="true"/>
                                    <GridColumn Key="CheckingGroupID" Caption="检查组" LabelType="H" Visible="Macro_DebugMode()" Width="80px"/>
                                    <GridColumn Key="IsATPChecked" Caption="已检查" LabelType="H" Width="120px"/>
                                </GridColumnCollection>
                                <GridRowCollection>
                                    <GridRow Key="MissingConponentsGridRow" TableKey="EPM_MissingConponentsGrid">
                                        <GridCell Key="IsSelect_miss_grid" Caption="选择" CellType="CheckBox" IsSelect="true"/>
                                        <GridCell Key="RelationBillDtlID" Caption="RelationBillDtlID" CellType="NumberEditor" Scale="0" UseGroupingSeparator="false">
                                            <DataBinding ColumnKey="RelationBillDtlID"/>
                                            <CellFormat HAlign="Right"/>
                                        </GridCell>
                                        <GridCell Key="ATPPlantID" Caption="工厂" CellType="Dict" Enable="false" ItemKey="Plant">
                                            <DataBinding ColumnKey="ATPPlantID"/>
                                        </GridCell>
                                        <GridCell Key="ATPMaterialID" Caption="物料" CellType="Dict" Enable="false" ItemKey="Material">
                                            <DataBinding ColumnKey="ATPMaterialID"/>
                                        </GridCell>
                                        <GridCell Key="ATPRequirementDate" Caption="需求日期" CellType="UTCDatePicker" Enable="false" Format="yyyy-MM-dd">
                                            <DataBinding ColumnKey="ATPRequirementDate"/>
                                        </GridCell>
                                        <GridCell Key="ATPRequirementQuantity" Caption="需求数量" CellType="NumberEditor" Enable="false" Scale="3">
                                            <DataBinding ColumnKey="ATPRequirementQuantity"/>
                                            <CellFormat HAlign="Right"/>
                                        </GridCell>
                                        <GridCell Key="ATPBaseUnitID" Caption="基本计量单位" CellType="Dict" Enable="false" ItemKey="Unit">
                                            <DataBinding ColumnKey="ATPBaseUnitID"/>
                                        </GridCell>
                                        <GridCell Key="ATPBatchCode" Caption="批次" CellType="TextEditor" Enable="false" Case="Upper" MaxLength="30" Trim="true">
                                            <DataBinding ColumnKey="ATPBatchCode" DefaultValue="_"/>
                                        </GridCell>
                                        <GridCell Key="ATPStorageLocationID" Caption="库存地点" CellType="Dict" Enable="false" ItemKey="StorageLocation">
                                            <DataBinding ColumnKey="ATPStorageLocationID"/>
                                        </GridCell>
                                        <GridCell Key="ATPCommittedQuantity" Caption="已确认数量" CellType="NumberEditor" Enable="false" Scale="3">
                                            <DataBinding ColumnKey="ATPCommittedQuantity"/>
                                            <CellFormat HAlign="Right"/>
                                        </GridCell>
                                        <GridCell Key="ATPQuantity" Caption="ATP数量" CellType="NumberEditor" Enable="false" Scale="3">
                                            <DataBinding ColumnKey="ATPQuantity"/>
                                            <CellFormat HAlign="Right"/>
                                        </GridCell>
                                        <GridCell Key="POID" Caption="POID" CellType="NumberEditor">
                                            <CellFormat HAlign="Right"/>
                                        </GridCell>
                                        <GridCell Key="CheckingGroupID" Caption="检查组" CellType="NumberEditor" Scale="0">
                                            <DataBinding ColumnKey="CheckingGroupID">
                                                <DefaultFormulaValue>
                                                    <![CDATA[IIF(ATPMaterialID > 0, Macro_GetOrgProp('MaterialID', 'SD_CheckingGroupsID', PlanningPlantID), 0);]]>
                                                </DefaultFormulaValue>
                                            </DataBinding>
                                            <CellFormat HAlign="Right"/>
                                        </GridCell>
                                        <GridCell Key="IsATPChecked" Caption="已检查" CellType="CheckBox" Enable="false">
                                            <DataBinding ColumnKey="IsATPChecked"/>
                                        </GridCell>
                                    </GridRow>
                                </GridRowCollection>
                                <RowDblClick>
                                    <![CDATA[if(!ReadOnly() && Macro_IsATPCheck()) {
                                        var var_CheckRuleID = 0;
                                        if (OrderTypeID > 0 && PlanningPlantID > 0) {
                                            var var_IsReleased = IIF(IsNew(), false, Macro_IsREL());
                                            var_CheckRuleID = Macro_GetCheckRuleID(var_IsReleased);
                                        }
                                        ERPShowModal('MM_ATPOverView_Rpt','Macro_PP_MaintenanceOrder_ShowEvent('&'"'&ATPPlantID&'","'&ATPMaterialID&'","'&OrderTypeID&'","'&PlanningPlantID&'","'&PlanningPlantID&'","'&MaterialID&'","'&CheckingGroupID&'","'&var_CheckRuleID&'","'&ATPRequirementDate&'","'&ATPRequirementQuantity&'","'&ATPStorageLocationID&'","'&RelationBillDtlID&'","'&SOID&'","",0)');
                                    }]]>
                                </RowDblClick>
                                <GridFilter FilterDependency="IsMissingPartsOnly">
                                    <FilterValue Index="1" FieldKey="ATPRequirementQuantity" RefValue="IIFS(IsMissingPartsOnly == 1, ATPCommittedQuantity, 0)" Type="Field" CondSign="&gt;="/>
                                    <FilterValue Index="2" FieldKey="IsATPChecked" RefValue="IIFS(IsMissingPartsOnly == 1, 1, 0)" Type="Field" CondSign="&gt;="/>
                                </GridFilter>
                            </Grid>
                            <RowDefCollection RowGap="24">
                                <RowDef Height="32px"/>
                                <RowDef Height="100%"/>
                            </RowDefCollection>
                            <ColumnDefCollection ColumnGap="16">
                                <ColumnDef Width="8px"/>
                                <ColumnDef Width="100px"/>
                                <ColumnDef Width="79px"/>
                                <ColumnDef Width="50px"/>
                                <ColumnDef Width="80px"/>
                                <ColumnDef Width="100px"/>
                                <ColumnDef Width="100px"/>
                                <ColumnDef Width="34%"/>
                                <ColumnDef Width="80px"/>
                                <ColumnDef Width="100px"/>
                                <ColumnDef Width="100px"/>
                                <ColumnDef Width="33%"/>
                                <ColumnDef Width="40px"/>
                                <ColumnDef Width="20px"/>
                                <ColumnDef Width="8px"/>
                                <ColumnDef Width="33%"/>
                            </ColumnDefCollection>
                        </GridLayoutPanel>
                        <SplitPanel Key="CostSplitPanel" Caption="成本" Orientation="Vertical">
                            <GridLayoutPanel Key="CostHeadGridLayoutPanel" Caption="成本信息" Height="pref" Padding="8px" TopPadding="24px">
                                <NumberEditor Key="TotalEstimatedCost" Caption="估算成本" LabelType="M" X="0" Y="0" Enable="!ReadOnly() &amp;&amp; EstimInputControl != 'Dtl' &amp;&amp; Macro_HasSystemStatus('ORI','I0001')">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="TotalEstimatedCost" DefaultFormulaValue="Sum('CO_EstimatedCost')" ValueDependency="CO_EstimatedCost">
                                        <ValueChanged>
                                            <![CDATA[IIF(EstimInputControl=='_',SetValue('EstimInputControl','Total'),'')]]>
                                        </ValueChanged>
                                    </DataBinding>
                                    <Format HAlign="Right"/>
                                </NumberEditor>
                                <Button Key="PlannedActualRepBtn" Caption="计划/实际报表" X="0" Y="1" Enable="true" Type="Normal">
                                    <OnClick>
                                        <![CDATA[ERPShowModal('CO_PMOrderPlannedActual_Rpt', GetCallFormula('Macro_SetParam',GetOID(),OrderTypeID,PlanningPlantID,OrgControllingAreaID))]]>
                                    </OnClick>
                                </Button>
                                <RowDefCollection RowHeight="30" RowGap="24">
                                    <RowDef Height="32px"/>
                                    <RowDef Height="32px"/>
                                </RowDefCollection>
                                <ColumnDefCollection ColumnGap="16">
                                    <ColumnDef Width="206px"/>
                                    <ColumnDef Width="60px"/>
                                    <ColumnDef Width="206px"/>
                                </ColumnDefCollection>
                            </GridLayoutPanel>
                            <TabPanel Key="CostOverviewTabPanel" Caption="TempTabPanel1">
                                <Grid Key="CostOverviewGrid" Caption="概览" Enable="false" DefaultFitWidth="true" SerialSeq="true" Padding="8px">
                                    <GridColumnCollection>
                                        <GridColumn Key="CV_ValueTypeID" Caption="数值种类" LabelType="H" Enable="false" Width="80px"/>
                                        <GridColumn Key="CV_EstimatedCost" Caption="估算成本" LabelType="H" Enable="false" Width="80px"/>
                                        <GridColumn Key="CV_PlannedCost" Caption="计划成本" LabelType="H" Enable="false" Width="80px"/>
                                        <GridColumn Key="CV_ActualCost" Caption="实际成本" LabelType="H" Enable="false" Width="80px"/>
                                    </GridColumnCollection>
                                    <GridRowCollection>
                                        <GridRow Key="CostOverviewGridRow" TableKey="EPM_CostOverview">
                                            <GridCell Key="CV_ValueTypeID" Caption="数值种类" CellType="Dict" ItemKey="CO_ValueType">
                                                <DataBinding ColumnKey="ValueTypeID"/>
                                            </GridCell>
                                            <GridCell Key="CV_EstimatedCost" Caption="估算成本" CellType="NumberEditor">
                                                <DataBinding ColumnKey="EstimatedCost"/>
                                                <CellFormat HAlign="Right"/>
                                            </GridCell>
                                            <GridCell Key="CV_PlannedCost" Caption="计划成本" CellType="NumberEditor">
                                                <DataBinding ColumnKey="PlannedCost"/>
                                                <CellFormat HAlign="Right"/>
                                            </GridCell>
                                            <GridCell Key="CV_ActualCost" Caption="实际成本" CellType="NumberEditor">
                                                <DataBinding ColumnKey="ActualCost"/>
                                                <CellFormat HAlign="Right"/>
                                            </GridCell>
                                        </GridRow>
                                    </GridRowCollection>
                                </Grid>
                                <Grid Key="CostGrid" Caption="成本" NewEmptyRow="false" CopyNew="false" DefaultFitWidth="true" SerialSeq="true" X="0" XSpan="2" Y="1" DisabledOption="insert,shift,delete" Padding="8px">
                                    <GridColumnCollection>
                                        <GridColumn Key="CO_ValueTypeID" Caption="数值种类" LabelType="H" Width="80px"/>
                                        <GridColumn Key="CO_EstimatedCost" Caption="已估计成本" Width="100px"/>
                                        <GridColumn Key="CO_PlannedCost" Caption="计划成本" LabelType="H" Width="80px"/>
                                        <GridColumn Key="CO_ActualCost" Caption="实际成本" LabelType="H" Width="80px"/>
                                    </GridColumnCollection>
                                    <GridRowCollection>
                                        <GridRow Key="CostGridRow" TableKey="EPM_Cost">
                                            <GridCell Key="CO_ValueTypeID" Caption="数值种类" CellType="Dict" Enable="false" ItemKey="CO_ValueType">
                                                <DataBinding ColumnKey="ValueTypeID"/>
                                            </GridCell>
                                            <GridCell Key="CO_EstimatedCost" Caption="已估计成本" CellType="NumberEditor" Enable="!ReadOnly() &amp;&amp; EstimInputControl !='Total' &amp;&amp; Macro_HasSystemStatus('ORI','I0001')" EnableDependency="CO_EstimatedCost">
                                                <DataBinding ColumnKey="EstimatedCost">
                                                    <ValueChanged>
                                                        <![CDATA[IIF(EstimInputControl=='_',SetValue('EstimInputControl','Dtl'),'');SetPara('IsEstimatedCostChange',true);Macro_UpdateEstimateStatus();]]>
                                                    </ValueChanged>
                                                </DataBinding>
                                                <CellFormat HAlign="Right"/>
                                            </GridCell>
                                            <GridCell Key="CO_PlannedCost" Caption="计划成本" CellType="NumberEditor" Enable="false">
                                                <DataBinding ColumnKey="PlannedCost"/>
                                                <CellFormat HAlign="Right"/>
                                            </GridCell>
                                            <GridCell Key="CO_ActualCost" Caption="实际成本" CellType="NumberEditor" Enable="false">
                                                <DataBinding ColumnKey="ActualCost"/>
                                                <CellFormat HAlign="Right"/>
                                            </GridCell>
                                        </GridRow>
                                    </GridRowCollection>
                                </Grid>
                            </TabPanel>
                            <SplitSize Size="110px"/>
                            <SplitSize Size="100%"/>
                        </SplitPanel>
                        <Grid Key="ObjectGrid" Caption="对象" SerialSeq="true" DisabledOption="sum,groupSum" Padding="8px">
                            <GridColumnCollection>
                                <GridColumn Key="OJ_IsSelect" Width="32px"/>
                                <GridColumn Key="OJ_IsProcessingIndicator" Caption="处理标识" LabelType="M" Width="80px" Sortable="true"/>
                                <GridColumn Key="OJ_UII" Caption="唯一项目标识" LabelType="M" Width="120px" Sortable="true"/>
                                <GridColumn Key="OJ_SerialNumber" Caption="序列号" LabelType="H" Width="80px" Sortable="true"/>
                                <GridColumn Key="OJ_MaterialID" Caption="物料" LabelType="H" Width="80px" Sortable="true"/>
                                <GridColumn Key="OJ_MaterialText" Caption="物料描述" LabelType="H" Width="80px" Sortable="true"/>
                                <GridColumn Key="OJ_EquipmentSOID" Caption="设备" LabelType="H" Width="80px" Sortable="true"/>
                                <GridColumn Key="OJ_EquipmentText" Caption="设备描述" LabelType="H" Width="80px" Sortable="true"/>
                                <GridColumn Key="OJ_FunctionalLocationSOID" Caption="功能位置" LabelType="H" Width="80px" Sortable="true"/>
                                <GridColumn Key="OJ_FunctionalLocationText" Caption="功能位置描述" LabelType="H" Width="120px" Sortable="true"/>
                                <GridColumn Key="OJ_NotificationSOID" Caption="通知单" LabelType="H" Width="80px" Sortable="true"/>
                                <GridColumn Key="OJ_OID" Visible="false" Width="80px" Sortable="true"/>
                                <GridColumn Key="OJ_SOID" Visible="false" Width="80px" Sortable="true"/>
                            </GridColumnCollection>
                            <GridRowCollection>
                                <GridRow Key="ObjectGridRow" TableKey="EPM_MaintenanceOrderObjects">
                                    <GridCell Key="OJ_IsSelect" Caption="选择" CellType="CheckBox" IsSelect="true"/>
                                    <GridCell Key="OJ_IsProcessingIndicator" Caption="处理标识" CellType="CheckBox" Enable="!ReadOnly()&amp;&amp;(OJ_MaterialID&lt;=0&amp;&amp;OJ_EquipmentSOID&lt;=0&amp;&amp;OJ_FunctionalLocationSOID&lt;=0)">
                                        <DataBinding ColumnKey="IsProcessingIndicator"/>
                                    </GridCell>
                                    <GridCell Key="OJ_UII" Caption="唯一项目标识" CellType="TextEditor" Enable="!ReadOnly()&amp;&amp;(OJ_MaterialID&lt;=0&amp;&amp;OJ_EquipmentSOID&lt;=0&amp;&amp;OJ_FunctionalLocationSOID&lt;=0)" MaxLength="100" Trim="true">
                                        <DataBinding ColumnKey="UII">
                                            <DefaultFormulaValue>
                                                <![CDATA[GetDictValue('PM_Equipment__Dic', OJ_EquipmentSOID, 'UII')]]>
                                            </DefaultFormulaValue>
                                        </DataBinding>
                                    </GridCell>
                                    <GridCell Key="OJ_SerialNumber" Caption="序列号" CellType="TextEditor" Enable="!ReadOnly()&amp;&amp;(OJ_MaterialID&lt;=0&amp;&amp;OJ_EquipmentSOID&lt;=0&amp;&amp;OJ_FunctionalLocationSOID&lt;=0)" MaxLength="100" Trim="true">
                                        <DataBinding ColumnKey="SerialNumber">
                                            <DefaultFormulaValue>
                                                <![CDATA[GetDictValue('PM_Equipment__Dic', OJ_EquipmentSOID, 'SerialNumber')]]>
                                            </DefaultFormulaValue>
                                        </DataBinding>
                                    </GridCell>
                                    <GridCell Key="OJ_MaterialID" Caption="物料" CellType="Dict" Enable="!ReadOnly()&amp;&amp;(OJ_MaterialID&lt;=0&amp;&amp;OJ_EquipmentSOID&lt;=0&amp;&amp;OJ_FunctionalLocationSOID&lt;=0 &amp;&amp; OJ_NotificationSOID &lt;=0)" ItemKey="Material">
                                        <DataBinding ColumnKey="MaterialID">
                                            <ValueChanged>
                                                <![CDATA[SetValue('OJ_EquipmentSOID', com.bokesoft.erp.pm.function.EquipmentFormula.getEquipmentIDBySNNumber(OJ_MaterialID,OJ_SerialNumber));]]>
                                            </ValueChanged>
                                            <CheckRule>
                                                <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.checkMaintenanceItemList(OJ_SerialNumber,OJ_MaterialID,OJ_EquipmentSOID,OJ_FunctionalLocationSOID)]]>
                                            </CheckRule>
                                            <DefaultFormulaValue>
                                                <![CDATA[GetDictValue('PM_Equipment__Dic', OJ_EquipmentSOID, 'MaterialID')]]>
                                            </DefaultFormulaValue>
                                        </DataBinding>
                                    </GridCell>
                                    <GridCell Key="OJ_MaterialText" Caption="物料描述" CellType="TextEditor" Enable="false" MaxLength="100" Trim="true">
                                        <DataBinding ColumnKey="OJ_MaterialText" DefaultFormulaValue="GetDictValue('Material', OJ_MaterialID, 'Name')"/>
                                    </GridCell>
                                    <GridCell Key="OJ_EquipmentSOID" Caption="设备" CellType="Dict" Enable="!ReadOnly()&amp;&amp;(OJ_MaterialID&lt;=0&amp;&amp;OJ_EquipmentSOID&lt;=0&amp;&amp;OJ_FunctionalLocationSOID&lt;=0 &amp;&amp; OJ_NotificationSOID &lt;=0)" ItemKey="PM_Equipment__Dic" StateMask="Enable|Disable|Discard">
                                        <DataBinding ColumnKey="EquipmentSOID">
                                            <CheckRule>
                                                <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.checkMaintenanceItemList(OJ_SerialNumber,OJ_MaterialID,OJ_EquipmentSOID,OJ_FunctionalLocationSOID)]]>
                                            </CheckRule>
                                            <DefaultFormulaValue>
                                                <![CDATA[IIF(OJ_NotificationSOID > 0 , GetDictValue('PM_Notification__Dic', OJ_NotificationSOID, 'EquipmentSOID'), OJ_EquipmentSOID)]]>
                                            </DefaultFormulaValue>
                                        </DataBinding>
                                    </GridCell>
                                    <GridCell Key="OJ_EquipmentText" Caption="设备描述" CellType="TextEditor" Enable="false" MaxLength="100" Trim="true">
                                        <DataBinding ColumnKey="OJ_EquipmentText">
                                            <DefaultFormulaValue>
                                                <![CDATA[GetDictValue('PM_Equipment__Dic', OJ_EquipmentSOID, 'Name')]]>
                                            </DefaultFormulaValue>
                                        </DataBinding>
                                    </GridCell>
                                    <GridCell Key="OJ_FunctionalLocationSOID" Caption="功能位置" CellType="Dict" Enable="!ReadOnly()&amp;&amp;(OJ_MaterialID&lt;=0&amp;&amp;OJ_EquipmentSOID&lt;=0&amp;&amp;OJ_FunctionalLocationSOID&lt;=0 &amp;&amp; OJ_NotificationSOID &lt;=0)" ItemKey="PM_FunctionalLocation__Dic" StateMask="Enable|Disable|Discard">
                                        <DataBinding ColumnKey="FunctionalLocationSOID">
                                            <CheckRule>
                                                <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.checkMaintenanceItemList(OJ_SerialNumber,OJ_MaterialID,OJ_EquipmentSOID,OJ_FunctionalLocationSOID)]]>
                                            </CheckRule>
                                            <DefaultFormulaValue>
                                                <![CDATA[IIF(OJ_NotificationSOID > 0 , GetDictValue('PM_Notification__Dic', OJ_NotificationSOID, 'FunctionalLocationSOID'),  GetDictValue('PM_Equipment__Dic', OJ_EquipmentSOID, 'FunctionalLocationSOID'))]]>
                                            </DefaultFormulaValue>
                                        </DataBinding>
                                    </GridCell>
                                    <GridCell Key="OJ_FunctionalLocationText" Caption="功能位置描述" CellType="TextEditor" Enable="false" MaxLength="100" Trim="true">
                                        <DataBinding ColumnKey="OJ_FunctionalLocationText">
                                            <DefaultFormulaValue>
                                                <![CDATA[GetDictValue('PM_FunctionalLocation__Dic', OJ_FunctionalLocationSOID, 'Name')]]>
                                            </DefaultFormulaValue>
                                        </DataBinding>
                                    </GridCell>
                                    <GridCell Key="OJ_NotificationSOID" Caption="通知单" CellType="Dict" Enable="!ReadOnly()&amp;&amp;(OJ_MaterialID&lt;=0&amp;&amp;OJ_EquipmentSOID&lt;=0&amp;&amp;OJ_FunctionalLocationSOID&lt;=0) &amp;&amp; OJ_NotificationSOID &lt;=0" ItemKey="PM_Notification__Dic" StateMask="Enable|Disable|Discard">
                                        <DataBinding ColumnKey="NotificationSOID">
                                            <ValueChanged>
                                                <![CDATA[if(OJ_NotificationSOID > 0 && OJ_NotificationSOID != NotificationSOID){ com.bokesoft.erp.pm.function.NotificationInteractWithMaintOrder.checkNotificationIsAssignedToOrder(OJ_NotificationSOID)}]]>
                                            </ValueChanged>
                                        </DataBinding>
                                    </GridCell>
                                    <GridCell Key="OJ_OID" CellType="NumberEditor" Scale="0">
                                        <DataBinding ColumnKey="OID"/>
                                    </GridCell>
                                    <GridCell Key="OJ_SOID" CellType="NumberEditor" Scale="0">
                                        <DataBinding ColumnKey="SOID"/>
                                    </GridCell>
                                </GridRow>
                            </GridRowCollection>
                            <OnRowDelete>
                                <![CDATA[
                                if (OJ_NotificationSOID <= 0 || OJ_NotificationSOID != NotificationSOID) {
                                    DeleteRow();
                                }
                                ]]>
                            </OnRowDelete>
                        </Grid>
                        <GridLayoutPanel Key="AdditionalDataGridLayoutPanel" Caption="附加数据" Padding="8px" OverflowY="Auto" Visible="true">
                            <Label Key="Organization" Caption="组织结构" X="0" Y="0" Visible="true" Enable="false" Class="erp-group-title"/>
                            <Dict Key="OrgControllingAreaID" Caption="成本控制范围" X="0" Y="3" Visible="true" Enable="false" ItemKey="ControllingArea">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="OrgControllingAreaID">
                                    <DefaultFormulaValue>
                                        <![CDATA[com.bokesoft.erp.pm.function.EquipmentFormula.getControllingAreaByCompanyID(OrgCompanyCodeID)]]>
                                    </DefaultFormulaValue>
                                </DataBinding>
                            </Dict>
                            <Dict Key="ProfitCenterID" Caption="利润中心" LabelType="M" X="0" Y="5" Visible="true" ItemKey="ProfitCenter">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="ProfitCenterID">
                                    <DefaultFormulaValue>
                                        <![CDATA[GetDictValue('CostCenter', ResponsibleCostCenterID, 'ProfitCenterID')]]>
                                    </DefaultFormulaValue>
                                </DataBinding>
                            </Dict>
                            <Dict Key="FunctionalAreaID" Caption="功能范围" LabelType="M" X="0" Y="6" Visible="true" ItemKey="FunctionalArea">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="FunctionalAreaID">
                                    <DefaultFormulaValue>
                                        <![CDATA[GetDictValue('CostCenter', ResponsibleCostCenterID, 'FunctionalAreaID')]]>
                                    </DefaultFormulaValue>
                                </DataBinding>
                            </Dict>
                            <Dict Key="ResponsibleCostCenterID" Caption="负责的成本中心" LabelType="M" X="0" Y="4" Visible="true" ItemKey="CostCenter">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="ResponsibleCostCenterID">
                                    <DefaultFormulaValue>
                                        <![CDATA[IIF(ResponsibleCostCenterID>0, ResponsibleCostCenterID, com.bokesoft.erp.pm.function.MaintenanceOrderFormula.getResponsibleCostCenterID(EquipmentSOID, FunctionalLocationSOID, MainWorkCenterID));]]>
                                    </DefaultFormulaValue>
                                </DataBinding>
                                <ItemFilter>
                                    <Filter Key="Filter" Impl="com.bokesoft.yes.erp.condition.Filter" Type="Custom">
                                        <FilterValue Index="1" ParaValue="'ControllingAreaID = '&amp;SqlPara(OrgControllingAreaID)"/>
                                    </Filter>
                                </ItemFilter>
                            </Dict>
                            <Dict Key="OrgCompanyCodeID" Caption="公司代码" LabelType="M" X="0" Y="1" Visible="true" Enable="false" ItemKey="CompanyCode">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="OrgCompanyCodeID">
                                    <DefaultFormulaValue>
                                        <![CDATA[GetDictValue('Plant', PlanningPlantID, 'CompanyCodeID')]]>
                                    </DefaultFormulaValue>
                                </DataBinding>
                            </Dict>
                            <Dict Key="OrgSaleOrderDtlOID" Caption="销售订单-行号" LabelType="M" X="0" Y="8" Visible="true" ItemKey="SD_SaleOrderDtl__Dic">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="OrgSaleOrderDtlOID"/>
                            </Dict>
                            <Dict Key="OrgWBSElementID" Caption="WBS元素" LabelType="M" X="0" Y="7" Visible="true" ItemKey="PS_WBSElement">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="OrgWBSElementID" ValueChanged="Macro_OrgWBSElementID_ValueChanged()"/>
                            </Dict>
                            <Dict Key="OrgBusinessAreaID" Caption="业务范围" LabelType="M" X="0" Y="2" Visible="true" ItemKey="BusinessArea">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="OrgBusinessAreaID"/>
                            </Dict>
                            <RowDefCollection RowGap="24">
                                <RowDef Height="32px"/>
                                <RowDef Height="32px"/>
                                <RowDef Height="32px"/>
                                <RowDef Height="32px"/>
                                <RowDef Height="32px"/>
                                <RowDef Height="32px"/>
                                <RowDef Height="32px"/>
                                <RowDef Height="32px"/>
                                <RowDef Height="32px"/>
                            </RowDefCollection>
                            <ColumnDefCollection ColumnGap="16">
                                <ColumnDef Width="25%"/>
                                <ColumnDef Width="25%"/>
                                <ColumnDef Width="25%"/>
                                <ColumnDef Width="25%"/>
                            </ColumnDefCollection>
                        </GridLayoutPanel>
                        <GridLayoutPanel Key="PositionGridLayoutPanel" Caption="位置" Padding="8px" OverflowY="Auto" Visible="true">
                            <Dict Key="BusinessAreaID" Caption="业务范围" LabelType="M" X="1" Y="3" Visible="true" ItemKey="BusinessArea" XSpan="2">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="BusinessAreaID"/>
                            </Dict>
                            <Dict Key="WBSElementID" Caption="WBS元素" LabelType="M" X="1" Y="5" Visible="true" ItemKey="PS_WBSElement" XSpan="2">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="WBSElementID"/>
                            </Dict>
                            <Label Key="LocationDataLab" Caption="位置数据" X="0" Y="0" Visible="true" Enable="false" Class="erp-group-title"/>
                            <Dict Key="MaintPlantID" Caption="维护工厂" LabelType="M" X="0" Y="1" Visible="true" ItemKey="Plant">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="MaintPlantID">
                                    <CheckRule>
                                        <![CDATA[Macro_CheckControllingArea(PlanningPlantID,MaintPlantID,true)]]>
                                    </CheckRule>
                                </DataBinding>
                            </Dict>
                            <Dict Key="LocationID" Caption="位置" LabelType="M" X="0" Y="2" Visible="true" ItemKey="Location">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="LocationID"/>
                                <ItemFilter ItemKey="Location">
                                    <Filter Key="Filter" Impl="com.bokesoft.yes.erp.condition.Filter" Type="Custom">
                                        <FilterValue Index="1" ParaValue="'PlantID = '&amp;SqlPara(MaintPlantID)"/>
                                    </Filter>
                                </ItemFilter>
                            </Dict>
                            <TextEditor Key="Room" Caption="房间" LabelType="M" X="0" Y="3" Visible="true" Case="Upper" MaxLength="100" Trim="true">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="Room"/>
                            </TextEditor>
                            <Dict Key="PlantSectionID" Caption="工厂区域" LabelType="M" X="0" Y="4" Visible="true" ItemKey="PM_PlantSection">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="PlantSectionID"/>
                                <ItemFilter ItemKey="PM_PlantSection">
                                    <Filter Key="Filter" Impl="com.bokesoft.yes.erp.condition.Filter" Type="Custom">
                                        <FilterValue Index="1" ParaValue="'PlantID = '&amp;SqlPara(MaintPlantID)"/>
                                    </Filter>
                                </ItemFilter>
                            </Dict>
                            <Dict Key="WorkCenterID" Caption="工作中心" LabelType="M" X="0" Y="5" Visible="true" ItemKey="WorkCenter">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="WorkCenterID"/>
                                <ItemFilter ItemKey="WorkCenter">
                                    <Filter Key="Filter" Impl="com.bokesoft.yes.erp.condition.Filter" Type="Custom">
                                        <FilterValue Index="1" ParaValue="IIF(MaintPlantID&gt;0,' BK_WorkCenter.PlantID='&amp;SqlPara(MaintPlantID),'1=1')"/>
                                    </Filter>
                                </ItemFilter>
                            </Dict>
                            <Dict Key="ABCIndicatorID" Caption="ABC标识" LabelType="M" X="0" Y="6" Visible="true" ItemKey="PM_ABCIndicator">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="ABCIndicatorID"/>
                                <ItemFilter ItemKey="PM_ABCIndicator">
                                    <Filter Key="Filter" Impl="com.bokesoft.yes.erp.condition.Filter" Type="Custom">
                                        <FilterValue Index="1" ParaValue="' ABCIndicatorType = ' + SqlPara(2)"/>
                                    </Filter>
                                </ItemFilter>
                            </Dict>
                            <Label Key="AccountAssignmentLab" Caption="账户分配" X="1" Y="0" Visible="true" Enable="false" Class="erp-group-title" XSpan="2"/>
                            <Dict Key="AssetCardSOID" Caption="资产" LabelType="M" X="1" Y="2" Visible="true" ItemKey="AM_AssetCard__Dic" StateMask="Enable|Disable|Discard" XSpan="2">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="AssetCardSOID"/>
                            </Dict>
                            <Dict Key="CostCenterID" Caption="成本中心" LabelType="M" X="1" Y="4" Visible="true" ItemKey="CostCenter">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="CostCenterID"/>
                                <ItemFilter ItemKey="CostCenter">
                                    <Filter Key="Filter" Impl="com.bokesoft.yes.erp.condition.Filter" Type="Custom">
                                        <FilterValue Index="1" ParaValue="'ControllingAreaID = '&amp;SqlPara(ControllingAreaID)"/>
                                    </Filter>
                                </ItemFilter>
                            </Dict>
                            <Dict Key="ControllingAreaID" Caption="控制范围" LabelType="M" X="2" Y="4" Visible="true" Enable="false" ItemKey="ControllingArea">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="ControllingAreaID">
                                    <DefaultFormulaValue>
                                        <![CDATA[com.bokesoft.erp.pm.function.EquipmentFormula.getControllingAreaByCompanyID(CompanyCodeID)]]>
                                    </DefaultFormulaValue>
                                </DataBinding>
                            </Dict>
                            <Dict Key="CompanyCodeID" Caption="公司代码" LabelType="M" X="1" Y="1" Visible="true" ItemKey="CompanyCode" XSpan="2">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="CompanyCodeID">
                                    <DefaultFormulaValue>
                                        <![CDATA[GetDictValue('Plant', MaintPlantID, 'CompanyCodeID')]]>
                                    </DefaultFormulaValue>
                                </DataBinding>
                            </Dict>
                            <Dict Key="CustomerID" Caption="客户" LabelType="M" X="1" Y="6" ItemKey="Customer" XSpan="2">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="CustomerID"/>
                            </Dict>
                            <TextEditor Key="SortField" Caption="分类字段" LabelType="M" X="0" Y="7">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="SortField"/>
                            </TextEditor>
                            <RowDefCollection RowGap="24">
                                <RowDef Height="32px"/>
                                <RowDef Height="32px"/>
                                <RowDef Height="32px"/>
                                <RowDef Height="32px"/>
                                <RowDef Height="32px"/>
                                <RowDef Height="32px"/>
                                <RowDef Height="32px"/>
                                <RowDef Height="32px"/>
                            </RowDefCollection>
                            <ColumnDefCollection ColumnGap="16">
                                <ColumnDef Width="17%"/>
                                <ColumnDef Width="17%"/>
                                <ColumnDef Width="17%"/>
                                <ColumnDef Width="17%"/>
                                <ColumnDef Width="16%"/>
                                <ColumnDef Width="16%"/>
                            </ColumnDefCollection>
                        </GridLayoutPanel>
                        <SplitPanel Key="PlanSplitPanel" Caption="计划" Orientation="Vertical">
                            <GridLayoutPanel Key="PlanGridLayoutPanel" Caption="计划" Padding="8px" OverflowY="Auto" Visible="true">
                                <Label Key="PlanLab" Caption="生成维护计划" X="0" Y="0" Visible="true" Enable="false" Class="erp-group-title"/>
                                <Dict Key="MaintenancePlanSOID" Caption="维护计划" LabelType="M" X="0" Y="1" Visible="true" Enable="false" ItemKey="PM_MaintenancePlan__Dic" StateMask="Enable|Disable|Discard">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="MaintenancePlanSOID"/>
                                </Dict>
                                <Dict Key="MaintenanceItemSOID" Caption="维护项目" LabelType="M" X="0" Y="3" Visible="true" Enable="false" ItemKey="PM_MaintenanceItem__Dic" StateMask="Enable|Disable|Discard">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="MaintenanceItemSOID"/>
                                </Dict>
                                <NumberEditor Key="MaintenancePlanCallNo" Caption="维护计划调用号" LabelType="L" X="0" Y="2" Visible="true" Enable="false" IntegerValue="true" Precision="9" Scale="0" UseGroupingSeparator="false">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="MaintenancePlanCallNo"/>
                                </NumberEditor>
                                <UTCDatePicker Key="CompletionDate" Caption="完成日期" LabelType="S" X="0" Y="4" Visible="true" Enable="false" Format="yyyy-MM-dd">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="CompletionDate"/>
                                </UTCDatePicker>
                                <Label Key="PreCallLab" Caption="先前调用" X="1" Y="0" Visible="true" Enable="false" Class="erp-group-title"/>
                                <Dict Key="MaintenanceOrderSOID" Caption="上一订单" LabelType="M" X="1" Y="1" Visible="true" Enable="false" ItemKey="PM_MaintenanceOrder__Dic" StateMask="Enable|Disable|Discard">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="MaintenanceOrderSOID"/>
                                </Dict>
                                <DatePicker Key="CompletionTime" Caption="完成时间" LabelType="M" X="1" Y="4" Visible="false" Enable="true">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="CompletionTime"/>
                                </DatePicker>
                                <ComboBox Key="LastTaskListType" Caption="任务清单类型" LabelType="M" X="2" Y="1" Enable="false" SourceType="ParaGroup" GroupKey="RoutingListType" Cache="false">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="LastTaskListType"/>
                                </ComboBox>
                                <TextEditor Key="LastRoutingGroup" Caption="任务清单组" X="2" Y="3" Enable="false">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="LastRoutingGroup"/>
                                </TextEditor>
                                <NumberEditor Key="LastGroupCounter" Caption="组计数器" LabelType="M" X="2" Y="2" Enable="false" Precision="9" Scale="0" UseGroupingSeparator="false">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="LastGroupCounter"/>
                                    <Format HAlign="Right"/>
                                </NumberEditor>
                                <Dict Key="LastRoutingID" Caption="任务清单" LabelType="M" X="2" Y="4" Visible="false" Enable="false" ItemKey="PP_Routing">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="LastRoutingID"/>
                                </Dict>
                                <TextEditor Key="LastTaskListDescription" Caption="任务清单描述" LabelType="M" X="2" Y="4" Enable="false">
                                    <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="LastTaskListDescription" DefaultFormulaValue="GetDictValue('PP_Routing',LastRoutingID,'Name')"/>
                                </TextEditor>
                                <Label Key="TaskListLab" Caption="最后包含的任务清单" X="2" Y="0" Class="erp-group-title"/>
                                <RowDefCollection RowGap="24">
                                    <RowDef Height="32px"/>
                                    <RowDef Height="32px"/>
                                    <RowDef Height="32px"/>
                                    <RowDef Height="32px"/>
                                    <RowDef Height="32px"/>
                                </RowDefCollection>
                                <ColumnDefCollection ColumnGap="16">
                                    <ColumnDef Width="16%"/>
                                    <ColumnDef Width="16%"/>
                                    <ColumnDef Width="17%"/>
                                    <ColumnDef Width="17%"/>
                                    <ColumnDef Width="17%"/>
                                    <ColumnDef Width="17%"/>
                                </ColumnDefCollection>
                            </GridLayoutPanel>
                            <Grid Key="TaskListGrid" Caption="任务清单" NewEmptyRow="false" ShowRowHead="false" Enable="false" SerialSeq="true" DefaultFitWidth="true" DisabledOption="insert,shift,delete" Padding="8px">
                                <GridColumnCollection>
                                    <GridColumn Key="TL_IsSelect" Visible="false" Width="32px"/>
                                    <GridColumn Key="TL_RoutingID" Caption="任务清单ID" Visible="false" Width="100px"/>
                                    <GridColumn Key="TL_TaskListType" Caption="任务清单类型" LabelType="M" Width="120px"/>
                                    <GridColumn Key="TL_RoutingGroup" Caption="任务清单组" Width="100px"/>
                                    <GridColumn Key="TL_GroupCounter" Caption="组计数器" LabelType="M" Width="80px"/>
                                    <GridColumn Key="TL_TaskListDescription" Caption="任务清单描述" LabelType="H" Width="120px"/>
                                    <GridColumn Key="TL_FunctionalLocationSOID" Caption="功能位置" LabelType="H" Width="80px"/>
                                    <GridColumn Key="TL_EquipmentSOID" Caption="设备" LabelType="H" Width="80px"/>
                                </GridColumnCollection>
                                <GridRowCollection>
                                    <GridRow Key="TaskListGridRow" TableKey="EPM_IncludedTaskLists">
                                        <GridCell Key="TL_IsSelect" Caption="选择" CellType="CheckBox" IsSelect="true"/>
                                        <GridCell Key="TL_RoutingID" Caption="任务清单ID" CellType="Dict" ItemKey="PP_Routing">
                                            <DataBinding ColumnKey="RoutingID"/>
                                        </GridCell>
                                        <GridCell Key="TL_TaskListType" Caption="任务清单类型" CellType="ComboBox" GroupKey="RoutingListType" SourceType="ParaGroup">
                                            <DataBinding ColumnKey="TaskListType"/>
                                        </GridCell>
                                        <GridCell Key="TL_RoutingGroup" Caption="任务清单组" CellType="TextEditor">
                                            <DataBinding ColumnKey="RoutingGroup"/>
                                        </GridCell>
                                        <GridCell Key="TL_GroupCounter" Caption="组计数器" CellType="NumberEditor" Precision="9" Scale="0" UseGroupingSeparator="false">
                                            <DataBinding ColumnKey="GroupCounter"/>
                                            <CellFormat HAlign="Right"/>
                                        </GridCell>
                                        <GridCell Key="TL_TaskListDescription" Caption="任务清单描述" CellType="TextEditor">
                                            <DataBinding ColumnKey="TaskListDescription" DefaultFormulaValue="GetDictValue('PP_Routing',TL_RoutingID,'Name')"/>
                                        </GridCell>
                                        <GridCell Key="TL_FunctionalLocationSOID" Caption="功能位置" CellType="Dict" ItemKey="PM_FunctionalLocation__Dic" StateMask="Enable|Disable|Discard">
                                            <DataBinding ColumnKey="FunctionalLocationSOID">
                                                <CheckRule>
                                                    <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.checkAvailable(false, TL_FunctionalLocationSOID)]]>
                                                </CheckRule>
                                            </DataBinding>
                                        </GridCell>
                                        <GridCell Key="TL_EquipmentSOID" Caption="设备" CellType="Dict" ItemKey="PM_Equipment__Dic" StateMask="Enable|Disable|Discard">
                                            <DataBinding ColumnKey="EquipmentSOID">
                                                <CheckRule>
                                                    <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.checkAvailable(true, TL_EquipmentSOID)]]>
                                                </CheckRule>
                                            </DataBinding>
                                        </GridCell>
                                    </GridRow>
                                </GridRowCollection>
                                <RowDblClick>
                                    <![CDATA[Macro_OpenTaskList(TL_TaskListType,PlanningPlantID,EquipmentSOID,FunctionalLocationSOID,TL_RoutingID)]]>
                                </RowDblClick>
                            </Grid>
                            <SplitSize Size="270px"/>
                            <SplitSize Size="100%"/>
                        </SplitPanel>
                        <GridLayoutPanel Key="ControlGridLayoutPanel" Caption="控制" Padding="8px" OverflowY="Auto" Visible="true">
                            <Label Key="AdministrativeDataLab" Caption="管理数据" X="0" Y="0" Visible="true" Enable="false" Class="erp-group-title"/>
                            <Dict Key="EnteredByOperatorID" Caption="输入者" LabelType="M" X="0" Y="1" Visible="true" Enable="false" ItemKey="Operator">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="EnteredByOperatorID"/>
                            </Dict>
                            <UTCDatePicker Key="CreatedOnDate" Caption="创建日期" LabelType="M" X="0" Y="2" Visible="true" Enable="false" Format="yyyy-MM-dd">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="CreatedOnDate"/>
                            </UTCDatePicker>
                            <Dict Key="ChangedByOperatorID" Caption="修改者" LabelType="M" X="0" Y="3" Visible="true" Enable="false" ItemKey="Operator">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="ChangedByOperatorID"/>
                            </Dict>
                            <UTCDatePicker Key="ChangedOnDate" Caption="修改日期" LabelType="M" X="0" Y="4" Visible="true" Enable="false" Format="yyyy-MM-dd">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="ChangedOnDate"/>
                            </UTCDatePicker>
                            <Label Key="PlaningIndicatorLab" Caption="计划标识" X="2" Y="2" Visible="true" Enable="false" Class="erp-group-title"/>
                            <CheckBox Key="IsPlannedOrder" Caption="计划订单" LabelType="M" X="2" Y="4" Visible="true" Enable="!ReadOnly() &amp;&amp; IsPlannedOrder == 0">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="IsPlannedOrder">
                                    <ValueChanged>
                                        <![CDATA[IIF(IsPlannedOrder==1, SetValue('IsImmediateOrder', 0), true);    IIF(IsPlannedOrder==1, SetValue('IsUnplannedOrder', 0), true);]]>
                                    </ValueChanged>
                                    <DefaultFormulaValue>
                                        <![CDATA[GetDictValue('PM_OrderType', OrderTypeID, 'IsPlannedOrder')]]>
                                    </DefaultFormulaValue>
                                </DataBinding>
                            </CheckBox>
                            <CheckBox Key="IsImmediateOrder" Caption="即时订单" LabelType="M" X="2" Y="3" Visible="true" Enable="!ReadOnly() &amp;&amp; IsImmediateOrder == 0">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="IsImmediateOrder">
                                    <ValueChanged>
                                        <![CDATA[IIF(IsImmediateOrder==1, SetValue('IsPlannedOrder', 0), true);    IIF(IsImmediateOrder==1, SetValue('IsUnplannedOrder', 0), true);]]>
                                    </ValueChanged>
                                    <DefaultFormulaValue>
                                        <![CDATA[GetDictValue('PM_OrderType', OrderTypeID, 'IsImmediateOrder')]]>
                                    </DefaultFormulaValue>
                                </DataBinding>
                            </CheckBox>
                            <CheckBox Key="IsUnplannedOrder" Caption="未计划订单" LabelType="M" X="2" Y="5" Visible="true" Enable="!ReadOnly() &amp;&amp; IsUnplannedOrder == 0">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="IsUnplannedOrder">
                                    <ValueChanged>
                                        <![CDATA[IIF(IsUnplannedOrder==1, SetValue('IsPlannedOrder', 0), true);    IIF(IsUnplannedOrder==1, SetValue('IsImmediateOrder', 0), true);]]>
                                    </ValueChanged>
                                    <DefaultFormulaValue>
                                        <![CDATA[GetDictValue('PM_OrderType', OrderTypeID, 'IsUnplannedOrder')]]>
                                    </DefaultFormulaValue>
                                </DataBinding>
                            </CheckBox>
                            <Label Key="ParametersLab" Caption="参数" X="1" Y="0" Visible="true" Enable="false" Class="erp-group-title"/>
                            <Dict Key="CostingSheetID" Caption="成本核算表" LabelType="S" X="1" Y="1" Visible="true" ItemKey="CO_CostingSheet">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="CostingSheetID"/>
                            </Dict>
                            <Dict Key="PlanCostingVariantID" Caption="计划成本变式" LabelType="M" X="1" Y="2" Visible="true" Enable="false" ItemKey="CO_CostingVariant">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="PlanCostingVariantID" DefaultFormulaValue="Macro_GetCostingVariantIDByOrderTyp(1)"/>
                            </Dict>
                            <Dict Key="ActualCostingVariantID" Caption="实际成本变式" LabelType="M" X="1" Y="3" Visible="true" Enable="false" ItemKey="CO_CostingVariant">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="ActualCostingVariantID" DefaultFormulaValue="Macro_GetCostingVariantIDByOrderTyp(2)"/>
                            </Dict>
                            <TextEditor Key="SequenceIncrement" Caption="工序增量" LabelType="M" X="1" Y="4" Visible="true" InvalidChars="+-." MaxLength="4" Trim="true">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="SequenceIncrement" Required="true">
                                    <ValueChanged>
                                        <![CDATA[Macro_CheckAndFixProcessNo(SequenceIncrement, 'SequenceIncrement')]]>
                                    </ValueChanged>
                                    <DefaultFormulaValue>
                                        <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.getSequenceIncrement(PlanningPlantID, OrderTypeID)]]>
                                    </DefaultFormulaValue>
                                </DataBinding>
                            </TextEditor>
                            <CheckBox Key="IsCollectionRequest" Caption="汇总采购申请" LabelType="M" X="1" Y="5" Enable="false">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="IsCollectionRequest">
                                    <DefaultFormulaValue>
                                        <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.isCollectionRequest(PlanningPlantID, OrderTypeID)]]>
                                    </DefaultFormulaValue>
                                </DataBinding>
                            </CheckBox>
                            <Label Key="ResPurReqLab" Caption="预留/采购申请" X="2" Y="0" Visible="true" Enable="false" Class="erp-group-title"/>
                            <ComboBox Key="RequisitionCreationControl" Caption="预留/采购申请" LabelType="M" X="2" Y="1" Visible="true" Enable="false" SourceType="ParaGroup" IntegerValue="true" GroupKey="GenerateControl">
                                <DataBinding TableKey="EPM_MaintenanceOrderHead" ColumnKey="RequisitionCreationControl">
                                    <DefaultFormulaValue>
                                        <![CDATA[Macro_GetMultiBillPropValue('PM_OrderTypeConfig','PlantID:OrderTypeID',PlanningPlantID&':'&OrderTypeID,'GeneratorMethod');]]>
                                    </DefaultFormulaValue>
                                </DataBinding>
                            </ComboBox>
                            <RowDefCollection RowGap="24">
                                <RowDef Height="32px"/>
                                <RowDef Height="32px"/>
                                <RowDef Height="32px"/>
                                <RowDef Height="32px"/>
                                <RowDef Height="32px"/>
                                <RowDef Height="32px"/>
                            </RowDefCollection>
                            <ColumnDefCollection ColumnGap="16">
                                <ColumnDef Width="16%"/>
                                <ColumnDef Width="16%"/>
                                <ColumnDef Width="17%"/>
                                <ColumnDef Width="17%"/>
                                <ColumnDef Width="17%"/>
                                <ColumnDef Width="17%"/>
                            </ColumnDefCollection>
                        </GridLayoutPanel>
                        <FlexFlowLayoutPanel Key="MaintenanceOrderSystemStatusTab" Caption="状态管理" Visible="true" Padding="8px">
                            <Embed Key="HeadStatusManage" FormKey="HeadStatusManage" RootKey="HeadStatusManageRoot" Height="100%"/>
                        </FlexFlowLayoutPanel>
                        <ItemChanged>
                            <![CDATA[if (IsFocusTabByKey('RoutingSplitPanel')) {Macro_P2_Trigger();Macro_P2_Trigger2();} else {true}]]>
                        </ItemChanged>
                    </TabPanel>
                    <SplitSize Size="175px"/>
                    <SplitSize Size="100%"/>
                </SplitPanel>
            </FlexFlowLayoutPanel>
        </Block>
    </Body>
    <OnPostShow>
        <![CDATA[IIF(IsNew(),Macro_OnPost_Formula(),'');]]>
    </OnPostShow>
    <MacroCollection>
        <Macro Key="Macro_ActivityTypeFilter" Args="workCenterID,basicStartDate">
            <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.activityTypeFilter(workCenterID,basicStartDate)]]>
        </Macro>
        <Macro Key="Macro_OnPost_Formula">
            <![CDATA[com.bokesoft.erp.co.formula.PMOrderCostFormula.initPMOrderCostDtl();]]>
        </Macro>
        <Macro Key="Macro_GetPMOrderCostID">
            <![CDATA[com.bokesoft.erp.co.formula.PMOrderCostFormula.getPMOrderCostID(GetOID())]]>
        </Macro>
        <Macro Key="Macro_Cost">
            <![CDATA[com.bokesoft.erp.co.formula.PMOrderCostFormula.getValueTypeCostReportData(GetDictOID('Version','Code','0'),GetOID())]]>
        </Macro>
        <Macro Key="Macro_CostSql">
            <![CDATA['select Code,ValueTypeID,sum(ActualCost) as ActualCost ,sum(PlannedCost) as PlannedCost ,sum(EstimatedCost) as EstimatedCost from (select val.Code,ValueTypeID,(case when RecordType = 4 then (Direction*(Money01+Money02+Money03+Money04+Money05+Money06+Money07+Money08+Money09+Money10+Money11+Money12+Money13+Money14+Money15+Money16)) end) as ActualCost,(case when (RecordType = 1 and VersionID =  '&SqlPara(GetDictOID('Version','Code','0'))&') then (Direction*(Money01+Money02+Money03+Money04+Money05+Money06+Money07+Money08+Money09+Money10+Money11+Money12+Money13+Money14+Money15+Money16)) end) as PlannedCost,(case when (RecordType = 1 and VersionID = 0) then (Direction*(Money01+Money02+Money03+Money04+Money05+Money06+Money07+Money08+Money09+Money10+Money11+Money12+Money13+Money14+Money15+Money16))  end) as EstimatedCost from eco_pmco pmco left join ECO_ValueType val on pmco.ValueTypeID = val.OID where orderID = '&SqlPara(GetOID())&' union select Code,OID as ValueTypeID, 0 as ActualCost, 0 as PlannedCost, 0 as EstimatedCost from ECO_ValueType where OID not in(select ValueTypeID from eco_pmco where orderID = '&SqlPara(GetOID())&')) t group by ValueTypeID,Code ']]>
        </Macro>
        <Macro Key="Macro_CostOverviewSql">
            <![CDATA['select Code,ValueTypeID,ActualCost,PlannedCost,EstimatedCost from (select val.Code,ValueTypeID,sum(case when RecordType = 4 then (Direction*(Money01+Money02+Money03+Money04+Money05+Money06+Money07+Money08+Money09+Money10+Money11+Money12+Money13+Money14+Money15+Money16)) else 0 end) as ActualCost,sum(case when (RecordType = 1 and VersionID = '&GetDictOID('Version','Code','0')&') then (Direction*(Money01+Money02+Money03+Money04+Money05+Money06+Money07+Money08+Money09+Money10+Money11+Money12+Money13+Money14+Money15+Money16)) else 0 end) as PlannedCost,sum(case when (RecordType = 1 and VersionID = 0) then (Direction*(Money01+Money02+Money03+Money04+Money05+Money06+Money07+Money08+Money09+Money10+Money11+Money12+Money13+Money14+Money15+Money16)) else 0 end) as EstimatedCost from eco_pmco pmco left join ECO_ValueType val on pmco.ValueTypeID = val.OID where orderID = '&SqlPara(GetOID())&' group by ValueTypeID,Code) t where ActualCost != '&SqlPara(0)&' or PlannedCost != '&SqlPara(0)&' or EstimatedCost != '&SqlPara(0)]]>
        </Macro>
        <Macro Key="Macro_HasSystemStatus" Args="objectTypeCode,systemStatusCode">
            <![CDATA[com.bokesoft.erp.basis.status.StatusFormula.hasSystemStatus(objectTypeCode,systemStatusCode)]]>
        </Macro>
        <Macro Key="Macro_GetCostingVariantIDByOrderTyp" Args="Type">
            <![CDATA[IIFS(PlanningPlantID > 0 && OrderTypeID > 0, com.bokesoft.erp.co.formula.PMOrderCostFormula.getCostingVariantIDByOrderType(PlanningPlantID,OrderTypeID,Type))]]>
        </Macro>
        <Macro Key="Macro_PmOrderIssued">
            <![CDATA[Macro_RELCheckAndGenerateSettleMent();
            if (IsRefurbishment) {
				Macro_MidIssued(false);
			} else {
			    var IsAssignInsLot = Macro_AbleToGenerateInsLot();
				if (IsAssignInsLot || InspectionTypeID <= 0) {
                    Macro_MidIssued(IsAssignInsLot);
				} else {
					ConfirmMsg('PM_MAINTENANCEORDER019', '无检验批生成,仍要发布订单吗？', {}, 'YES_NO', {
                        NO: {
                            Macro_ReleaseRejected();
                        }, 
                        YES: {
                            Macro_MidIssued(false);
                        }
                    });
				}
			}]]>
        </Macro>
        <Macro Key="Macro_AbleToGenerateInsLot">
            <![CDATA[com.bokesoft.erp.qm.function.InspectionLotFormula.ableToGenerateInsLot4PMOrder()]]>
        </Macro>
        <Macro Key="Macro_MidIssued" Args="IsAssignInsLot">
            <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderOperation.pmOrderIssued(IsAssignInsLot);]]>
        </Macro>
        <Macro Key="Macro_ReleaseRejected">
            <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.setInspectionLotStatus('I0055');]]>
        </Macro>
        <Macro Key="Macro_AvailabilityCheck">
            <![CDATA[com.bokesoft.erp.mm.atp.formula.ATPFormula.availabilityCheck4PMOrder(IsNew(),false,false,false,true)]]>
        </Macro>
        <Macro Key="Macro_PM_MaintenanceOrder_GridTrigger">
            <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.updateComponentDtl(true);]]>
        </Macro>
        <Macro Key="Macro_QM_InspectionLot_ShowEvent" Args="PP_ProductionOrderID">
            <![CDATA[Macro_LoadObjectBySOID(PP_ProductionOrderID)]]>
        </Macro>
        <Macro Key="Macro_PM_MaintenanceOrderQuery_ShowEvent" Args="ArgSOID">
            <![CDATA[Macro_LoadObjectBySOID(ArgSOID)]]>
        </Macro>
        <Macro Key="Macro_IsREL">
            <![CDATA[IsReleased]]>
        </Macro>
        <Macro Key="Macro_IsCRTD">
            <![CDATA[MaintProcessingPhase==0]]>
        </Macro>
        <Macro Key="Macro_MidComplete" Args="IsExistCompletePara">
            <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderOperation.tecoAndClose(IsExistCompletePara)]]>
        </Macro>
        <Macro Key="Macro_DoNotExecute">
            <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderOperation.doNotExecute()]]>
        </Macro>
        <Macro Key="Macro_CompleteOrder">
            <![CDATA[Macro_MidComplete(true);com.bokesoft.erp.function.DocumentFunction.loadObject()]]>
        </Macro>
        <Macro Key="Macro_IsTECO">
            <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.isContainStatus('I0045')]]>
        </Macro>
        <Macro Key="Macro_IsPCNF">
            <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.isContainStatus('I0010')]]>
        </Macro>
        <Macro Key="Macro_IsCLSD">
            <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.isContainStatus('I0046')&&!Macro_IsDoNotExecute()]]>
        </Macro>
        <Macro Key="Macro_IsDoNotExecute">
            <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.isContainStatus('I0015')]]>
        </Macro>
        <Macro Key="Macro_IsDLFL">
            <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.isContainStatus('I0076')]]>
        </Macro>
        <Macro Key="Macro_PMOrderCancelTeco_Opt_RunAsExp">
            <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderOperation.pmOrder_CancelTeco();com.bokesoft.erp.function.DocumentFunction.loadObject()]]>
        </Macro>
        <Macro Key="Macro_CLSD_Opt_RunAsExp">
            <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderOperation.pmOrder_Close();com.bokesoft.erp.function.DocumentFunction.loadObject()]]>
        </Macro>
        <Macro Key="Macro_CLSD_Opt_RunAsExp2">
            <![CDATA[Macro_IsREL() || Macro_IsTECO()]]>
        </Macro>
        <Macro Key="Macro_PMOrderCancelClose_Opt_RunAsExp">
            <![CDATA[com.bokesoft.erp.function.DocumentFunction.loadObject();com.bokesoft.erp.pm.function.MaintenanceOrderOperation.pmOrder_CancelClose();com.bokesoft.erp.function.DocumentFunction.loadObject()]]>
        </Macro>
        <Macro Key="Macro_OrderResett_RunAsExp">
            <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderOperation.pmOrder_DeletedRecover();com.bokesoft.erp.function.DocumentFunction.loadObject()]]>
        </Macro>
        <Macro Key="Macro_OrderSet_RunAsExp">
            <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderOperation.pmOrder_Delete();com.bokesoft.erp.function.DocumentFunction.loadObject();Macro_MidSave();]]>
        </Macro>
        <Macro Key="Macro_Lock_Opt_RunAsExp">
            <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderOperation.pmOrder_Lock();com.bokesoft.erp.function.DocumentFunction.loadObject()]]>
        </Macro>
        <Macro Key="Macro_UnLock_Opt_RunAsExp">
            <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderOperation.pmOrder_UnLock();com.bokesoft.erp.function.DocumentFunction.loadObject()]]>
        </Macro>
        <Macro Key="Macro_SettlementRule_RunAsExp">
            <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.maintenanceOrder_SettlementRules()]]>
        </Macro>
        <Macro Key="Macro_RoutingID_Trigger" Args="Delete">
            <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.pmOrderRoutingData(Delete)]]>
        </Macro>
        <Macro Key="Macro_ATPStatus_Trigger">
            <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.pmStatusAfterATPCheck()]]>
        </Macro>
        <Macro Key="Macro_CreateInsLot">
            <![CDATA[com.bokesoft.erp.qm.function.InspectionLotFormula.createInspectionLot()]]>
        </Macro>
        <Macro Key="Macro_P2_Trigger">
            <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.updateComponentDtl(false)]]>
        </Macro>
        <Macro Key="Macro_P2_Trigger2">
            <![CDATA[selectRow('MaintenanceOrder_RoutingGrid',0)]]>
        </Macro>
        <Macro Key="Macro_DoAfterClick4ProductProcessSelect" Args="ProductionProcessNo">
            <![CDATA[SetValue('BO_RefProcessNo_Btn', ProductionProcessNo,true)]]>
        </Macro>
        <Macro Key="Macro_Complete_Opt_AfterModal">
            <![CDATA[Macro_CompleteOrder();if (Macro_IsNoDecision()) {ConfirmMsg('QA145', '还无使用决策可作', {}, 'OK', {
OK: {}
}); return 0;} else {true}]]>
        </Macro>
        <Macro Key="Macro_ReSetProcessNo" Args="FieldKey">
            <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.reSetProcessNo(FieldKey)]]>
        </Macro>
        <Macro Key="Macro_SDFilter">
            <![CDATA["SpecialIdentity='E'"]]>
        </Macro>
        <Macro Key="Macro_getPurchaseInfoRecordOrgPropAllowNull">
            <![CDATA['']]>
        </Macro>
        <Macro Key="Macro_MidSave_PreTriggers">
            <![CDATA[DistinctRow('BO_ProcessNo');
Macro_CheckRouting4Service(true);
            Macro_CheckComponents();
            if (IsNew()) {
                com.bokesoft.erp.pm.function.NotificationInteractWithMaintOrder.feedbackNotification();
                SetValue('EnteredByOperatorID', GetOperator());
                SetValue('CreatedOnDate', DateLong());
            }
            com.bokesoft.erp.pm.function.NotificationInteractWithMaintOrder.assignOrderToNotification();
            Macro_RefreshIsComponent();
            com.bokesoft.erp.pm.function.MaintenanceOrderFormula.checkOperationServicesDtl();
            com.bokesoft.erp.pm.function.MaintenanceOrderFormula.processGeneralData();
            if(MaintProcessingPhase<=2){
                com.bokesoft.erp.mm.atp.formula.ATPFormula.availabilityCheck4PMOrder(IsNew(),false,true,false);
            }
            com.bokesoft.erp.pm.function.MaintenanceOrderFormula.savePMOrderAndSettleRule();
            com.bokesoft.erp.documentNumber.DocumentNumber.genDocNumber();
            com.bokesoft.erp.pm.function.MaintenanceOrderOperation.saveInspectionLot();
            com.bokesoft.erp.pm.function.MaintenanceOrderFormula.maintenanceOrder_GenerateReservation();
            com.bokesoft.erp.pm.function.MaintenanceOrderFormula.generatePurReqToDelaySaveBill();
            com.bokesoft.erp.ps.budget.PS_BudgetAssignedValMidDataFormula.genTECOAndCLSDStatePMPlanCostAssigned();]]>
        </Macro>
        <Macro Key="Macro_MidSave_PostTriggers">
            <![CDATA[com.bokesoft.erp.pm.function.PMCommonFormula.doDelaySaveBill();
com.bokesoft.erp.co.formula.CalcPMOrderCost.genPMOrderCost();com.bokesoft.erp.pm.function.PMCommonFormula.syncModifyTime2ChangedOnDate();
com.bokesoft.erp.ps.budget.PS_BudgetAssignedValMidDataFormula.genAssignedValMidDataPMPlanCost();]]>
        </Macro>
        <Macro Key="Macro_IsNoDecision">
            <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderOperation.isNoDecision(InspectionLotSOID);]]>
        </Macro>
        <Macro Key="Macro_SetScaleByUnit" Args="Value,BaseUnitID,RoundingMode">
            <![CDATA[com.bokesoft.erp.basis.unit.UnitFormula.setScaleByUnit(Value,BaseUnitID,RoundingMode)]]>
        </Macro>
        <Macro Key="Macro_OpenStructuralDisplay">
            <![CDATA[ERPShowModal('PM_FuncStructuralDisplay','Macro_PM_MaintenanceOrder_ShowEvent()')]]>
        </Macro>
        <Macro Key="Macro_setWorkActiveTime" Args="O_WorkActiveTime, O_WorkActiveUnitID, O_NumberofCapacities, O_OperationDurationTime, O_OperationWorkUnitID, O_Percentage">
            <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderOperation.setWorkActiveTime(RO_ProcessWorkTime, RO_ProcessWorkTimeUnitID, RO_NumberofCapacity, RO_ProcessDuration, RO_ProcessDurationUnitID, RO_Percentage);]]>
        </Macro>
        <Macro Key="Macro_setOperationDurationTime" Args="O_OperationDurationTime, O_WorkActiveTime, O_WorkActiveUnitID, O_NumberofCapacities, O_OperationWorkUnitID, O_Percentage">
            <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderOperation.setOperationDurationTime(RO_ProcessDuration, RO_ProcessWorkTime, RO_ProcessWorkTimeUnitID, RO_NumberofCapacity, RO_ProcessDurationUnitID, RO_Percentage);]]>
        </Macro>
        <Macro Key="Macro_setNumberofCapacities" Args="O_NumberofCapacities,O_WorkActiveTime,O_WorkActiveUnitID,O_OperationDurationTime,O_OperationWorkUnitID,O_Percentage">
            <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderOperation.setNumberofCapacities(RO_NumberofCapacity, RO_ProcessWorkTime, RO_ProcessWorkTimeUnitID, RO_ProcessDuration, RO_ProcessDurationUnitID, RO_Percentage);]]>
        </Macro>
        <Macro Key="Macro_IsDefineDate4WBS" Args="OrgWBSElementID">
            <![CDATA[com.bokesoft.erp.pm.maintorder.MaintenanceOrderDate.isDefineDate4WBS(OrgWBSElementID)]]>
        </Macro>
        <Macro Key="Macro_SetBasicDateFromWBSElement">
            <![CDATA[com.bokesoft.erp.pm.maintorder.MaintenanceOrderDate.setBasicDateFromWBSElement()]]>
        </Macro>
        <Macro Key="Macro_GetDefaultRoutingData" Args="argColumnKey">
            <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.getExtPOValue(RO_PlantID, OrderTypeID, argColumnKey)]]>
        </Macro>
        <Macro Key="Macro_RevertResPurReq" Args="fieldName">
            <![CDATA[ConfirmMsg('IW295', '订单已经下达, 不允许设置为 2 下达后'); SetValue(fieldName, 3)]]>
        </Macro>
        <Macro Key="Macro_RefreshIsComponent">
            <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.refreshIsComponent()]]>
        </Macro>
        <Macro Key="Macro_IsATPCheck">
            <![CDATA[ATPPlantID>0&&ATPMaterialID>0&&ATPRequirementDate>0&&ATPRequirementQuantity>0]]>
        </Macro>
        <Macro Key="Macro_GetCheckRuleID" Args="arg_IsReleased">
            <![CDATA[com.bokesoft.erp.mm.atp.formula.ATPFormula.getATPCheckingRuleID(OrderTypeID, PlanningPlantID, arg_IsReleased)]]>
        </Macro>
        <Macro Key="Macro_GetSchedulePara" Args="argFieldValue,argGetFieldName">
            <![CDATA[IIF(argFieldValue <= 0 && PlanningPlantID > 0 && OrderTypeID > 0, com.bokesoft.erp.pp.crp.SchedulingParameters.getMaintSchedulePara(argGetFieldName, PlanningPlantID, OrderTypeID), argFieldValue)]]>
        </Macro>
        <Macro Key="Macro_GetScheduleTypeField" Args="argFieldName">
            <![CDATA[GetDictValue('PP_SchedulingType', SchedulingTypeID, argFieldName)]]>
        </Macro>
        <Macro Key="Macro_UpdateEstimateStatus">
            <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.onEstimatedCostChange(TotalEstimatedCost)]]>
        </Macro>
        <Macro Key="Macro_GetScheduleDate">
            <![CDATA[com.bokesoft.erp.pp.crp.SchedulingParameters.getScheduleDate()]]>
        </Macro>
        <Macro Key="Macro_CheckComponents">
            <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.checkComponents()]]>
        </Macro>
        <Macro Key="Macro_FillNotificationData">
            <![CDATA[com.bokesoft.erp.pm.function.NotificationInteractWithMaintOrder.fillNotificationData()]]>
        </Macro>
        <Macro Key="Macro_IsIntegrateNotification">
            <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.isIntegrateNotification(OrderTypeID)]]>
        </Macro>
        <Macro Key="Macro_RELCheckAndGenerateSettleMent">
            <![CDATA[com.bokesoft.erp.co.formula.PMOrderCostFormula.relCheckAndGenerateSettleMent()]]>
        </Macro>
        <Macro Key="Macro_GenDisplayTaskListCondBillJSON">
            <![CDATA[com.bokesoft.erp.pm.masterdata.ObjectInformation.genDisplayTaskListCondBillJSON()]]>
        </Macro>
        <Macro Key="Macro_DeleteRoutingDtl_ExtOpt">
            <![CDATA[IIF(IsNewOrEdit(),Macro_DeleteRoutingDtl(),ConfirmMsg('PM_MAINTENANCEORDER025','编辑状态下不允许删除'))]]>
        </Macro>
        <Macro Key="Macro_DeleteRoutingDtl">
            <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.deleteRoutingDtl()]]>
        </Macro>
        <Macro Key="Macro_ClearDocCache">
            <![CDATA[RemovePara('settleJson');RemovePara('DocCache_InspectionLot')]]>
        </Macro>
        <Macro Key="Macro_ReloadParentNotification">
            <![CDATA[Macro_MidSave();RemovePara('settleJson');IIF(HasParent()&&parent.GetFormKey()=='PM_Notification'&&parent.GetOID() == NotificationSOID,parent.Macro_LoadObject())]]>
        </Macro>
        <Macro Key="Macro_IsCompleted">
            <![CDATA[MaintProcessingPhase>2]]>
        </Macro>
        <Macro Key="Macro_IsExternalWithService">
            <![CDATA[Macro_IsExternal()&&Macro_IsService()]]>
        </Macro>
        <Macro Key="Macro_IsExternalWithoutService">
            <![CDATA[Macro_IsExternal()&&!Macro_IsService()]]>
        </Macro>
        <Macro Key="Macro_IsExternal">
            <![CDATA[GetDictValue('PP_ControlCode', RO_ControlCodeID, 'ExternalProcessing')=='+']]>
        </Macro>
        <Macro Key="Macro_IsService">
            <![CDATA[GetDictValue('PP_ControlCode', RO_ControlCodeID, 'IsService')==1]]>
        </Macro>
        <Macro Key="Macro_SetBasicDateTimeByRevisionID" Args="RevisionID">
            <![CDATA[com.bokesoft.erp.pm.maintorder.MaintenanceOrderDate.setBasicDateTimeByRevisionID(RevisionID);]]>
        </Macro>
        <Macro Key="Macro_CheckIfPipeMaterial">
            <![CDATA[com.bokesoft.erp.pp.masterdata.MaterialBOMFormula.checkPipeMaterialIsEnable(BO_MaterialID, BO_ItemCategoryID)]]>
        </Macro>
        <Macro Key="Macro_CheckCodeOrCodeGroup" Args="CatalogTypeIDKey,GroupField,CodeField,TextField">
            <![CDATA[com.bokesoft.erp.pm.function.CatalogFormula.checkCodeOrCodeGroup(GetDictValue('QM_NotificationType', NotificationTypeID, CatalogTypeIDKey), GroupField, CodeField, TextField)]]>
        </Macro>
        <Macro Key="Macro_CheckRequired" Args="argGroup,argCode">
            <![CDATA[IIF(Length(GetValue(argGroup)) > 0 && Length(GetValue(argCode)) == 0, MessageFacade('PM_NOTIFICATION004','请选择相关代码'), '')]]>
        </Macro>
        <Macro Key="Macro_CheckWBSSystemStatus">
            <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.checkWBSSystemStatus(OrgWBSElementID)]]>
        </Macro>
        <Macro Key="Macro_OrgWBSElementID_ValueChanged">
            <![CDATA[
            Macro_CheckWBSSystemStatus();
            if (Macro_IsDefineDate4WBS(OrgWBSElementID)) {
                ConfirmMsg('PM_MAINTENANCEORDER018', '已经维护项目定义或 WBS 要素。日期复制？', {

                }, 'YES_NO', {
                    NO: {
                        true;
                    },
                    YES: {
                        Macro_SetBasicDateFromWBSElement()
                    }
                });
            }]]>
        </Macro>
        <Macro Key="Macro_SaveData">
            <![CDATA[if(Length(Macro_CheckPBF())>0) {ConfirmMsg('COCOSTOBJECTUTIL006', '已存在业务数据或未清单据，请确认是否要修改？', {}, 'YES_NO', {NO: {true}, YES: {Macro_ReloadParentNotification();ResetEditBill()}})} else {Macro_ReloadParentNotification();ResetEditBill()}]]>
        </Macro>
        <Macro Key="Macro_IsStatusActive" Args="argSystemText">
            <![CDATA[com.bokesoft.erp.pm.function.MaintenanceOrderFormula.isStatusActive(argSystemText)]]>
        </Macro>
    </MacroCollection>
</Form>
